/**
 * 
 *   Version: 10.4.0
 * 
 *   Git Hash: 18a110e8a09523bcccd386391747f378b0b20912
 * 
 *   Created At: 2024/8/21 19:52:27
 * 
 *   Target: CHATROOM_BROWSER_SDK.js
 *   
 */

!function(t,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):(t="undefined"!=typeof globalThis?globalThis:t||self).Chatroom=a()}(this,(function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function createCommonjsModule(t){var a={exports:{}};return t(a,a.exports),a.exports}var a,c,_=getDefaultExportFromCjs(createCommonjsModule((function(t){t.exports=function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports}))),check=function(t){return t&&t.Math==Math&&t},h=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof t&&t)||function(){return this}()||Function("return this")(),fails=function(t){try{return!!t()}catch(t){return!0}},m=!fails((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),g=Function.prototype,E=g.apply,T=g.call,I="object"==typeof Reflect&&Reflect.apply||(m?T.bind(E):function(){return T.apply(E,arguments)}),N=Function.prototype,M=N.bind,S=N.call,O=m&&M.bind(S,S),A=m?function(t){return t&&O(t)}:function(t){return t&&function(){return S.apply(t,arguments)}},isCallable=function(t){return"function"==typeof t},b=!fails((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),R=Function.prototype.call,C=m?R.bind(R):function(){return R.apply(R,arguments)},P={}.propertyIsEnumerable,k=Object.getOwnPropertyDescriptor,w={f:k&&!P.call({1:2},1)?function propertyIsEnumerable(t){var a=k(this,t);return!!a&&a.enumerable}:P},createPropertyDescriptor=function(t,a){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:a}},x=A({}.toString),D=A("".slice),classofRaw=function(t){return D(x(t),8,-1)},L=Object,V=A("".split),U=fails((function(){return!L("z").propertyIsEnumerable(0)}))?function(t){return"String"==classofRaw(t)?V(t,""):L(t)}:L,isNullOrUndefined=function(t){return null==t},G=TypeError,requireObjectCoercible=function(t){if(isNullOrUndefined(t))throw G("Can't call method on "+t);return t},toIndexedObject=function(t){return U(requireObjectCoercible(t))},j="object"==typeof document&&document.all,B=void 0===j&&void 0!==j?function(t){return"object"==typeof t?null!==t:isCallable(t)||t===j}:function(t){return"object"==typeof t?null!==t:isCallable(t)},Y={},aFunction=function(t){return isCallable(t)?t:void 0},getBuiltIn=function(t,a){return arguments.length<2?aFunction(Y[t])||aFunction(h[t]):Y[t]&&Y[t][a]||h[t]&&h[t][a]},H=A({}.isPrototypeOf),K=getBuiltIn("navigator","userAgent")||"",W=h.process,q=h.Deno,z=W&&W.versions||q&&q.version,$=z&&z.v8;$&&(c=(a=$.split("."))[0]>0&&a[0]<4?1:+(a[0]+a[1])),!c&&K&&(!(a=K.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=K.match(/Chrome\/(\d+)/))&&(c=+a[1]);var J,Q=c,X=!!Object.getOwnPropertySymbols&&!fails((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Q&&Q<41})),Z=X&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ee=Object,te=Z?function(t){return"symbol"==typeof t}:function(t){var a=getBuiltIn("Symbol");return isCallable(a)&&H(a.prototype,ee(t))},re=String,tryToString=function(t){try{return re(t)}catch(t){return"Object"}},oe=TypeError,aCallable=function(t){if(isCallable(t))return t;throw oe(tryToString(t)+" is not a function")},getMethod=function(t,a){var c=t[a];return isNullOrUndefined(c)?void 0:aCallable(c)},ne=TypeError,ie=Object.defineProperty,ae="__core-js_shared__",se=h[ae]||function(t,a){try{ie(h,t,{value:a,configurable:!0,writable:!0})}catch(c){h[t]=a}return a}(ae,{}),ce=createCommonjsModule((function(t){(t.exports=function(t,a){return se[t]||(se[t]=void 0!==a?a:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})})),ue=Object,toObject=function(t){return ue(requireObjectCoercible(t))},le=A({}.hasOwnProperty),de=Object.hasOwn||function hasOwn(t,a){return le(toObject(t),a)},fe=0,pe=Math.random(),_e=A(1..toString),uid=function(t){return"Symbol("+(void 0===t?"":t)+")_"+_e(++fe+pe,36)},he=ce("wks"),me=h.Symbol,ge=me&&me.for,Ee=Z?me:me&&me.withoutSetter||uid,wellKnownSymbol=function(t){if(!de(he,t)||!X&&"string"!=typeof he[t]){var a="Symbol."+t;X&&de(me,t)?he[t]=me[t]:he[t]=Z&&ge?ge(a):Ee(a)}return he[t]},ve=TypeError,ye=wellKnownSymbol("toPrimitive"),toPrimitive=function(t,a){if(!B(t)||te(t))return t;var c,_=getMethod(t,ye);if(_){if(void 0===a&&(a="default"),c=C(_,t,a),!B(c)||te(c))return c;throw ve("Can't convert object to primitive value")}return void 0===a&&(a="number"),function(t,a){var c,_;if("string"===a&&isCallable(c=t.toString)&&!B(_=C(c,t)))return _;if(isCallable(c=t.valueOf)&&!B(_=C(c,t)))return _;if("string"!==a&&isCallable(c=t.toString)&&!B(_=C(c,t)))return _;throw ne("Can't convert object to primitive value")}(t,a)},toPropertyKey=function(t){var a=toPrimitive(t,"string");return te(a)?a:a+""},Te=h.document,Ie=B(Te)&&B(Te.createElement),documentCreateElement=function(t){return Ie?Te.createElement(t):{}},Ne=!b&&!fails((function(){return 7!=Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a})),Me=Object.getOwnPropertyDescriptor,Se={f:b?Me:function getOwnPropertyDescriptor(t,a){if(t=toIndexedObject(t),a=toPropertyKey(a),Ne)try{return Me(t,a)}catch(t){}if(de(t,a))return createPropertyDescriptor(!C(w.f,t,a),t[a])}},Oe=/#|\.prototype\./,isForced=function(t,a){var c=be[Ae(t)];return c==Ce||c!=Re&&(isCallable(a)?fails(a):!!a)},Ae=isForced.normalize=function(t){return String(t).replace(Oe,".").toLowerCase()},be=isForced.data={},Re=isForced.NATIVE="N",Ce=isForced.POLYFILL="P",Pe=isForced,ke=A(A.bind),functionBindContext=function(t,a){return aCallable(t),void 0===a?t:m?ke(t,a):function(){return t.apply(a,arguments)}},we=b&&fails((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),xe=String,De=TypeError,anObject=function(t){if(B(t))return t;throw De(xe(t)+" is not an object")},Le=TypeError,Ve=Object.defineProperty,Ue=Object.getOwnPropertyDescriptor,Fe="enumerable",Ge="configurable",je="writable",Be={f:b?we?function defineProperty(t,a,c){if(anObject(t),a=toPropertyKey(a),anObject(c),"function"==typeof t&&"prototype"===a&&"value"in c&&je in c&&!c.writable){var _=Ue(t,a);_&&_.writable&&(t[a]=c.value,c={configurable:Ge in c?c.configurable:_.configurable,enumerable:Fe in c?c.enumerable:_.enumerable,writable:!1})}return Ve(t,a,c)}:Ve:function defineProperty(t,a,c){if(anObject(t),a=toPropertyKey(a),anObject(c),Ne)try{return Ve(t,a,c)}catch(t){}if("get"in c||"set"in c)throw Le("Accessors not supported");return"value"in c&&(t[a]=c.value),t}},Ye=b?function(t,a,c){return Be.f(t,a,createPropertyDescriptor(1,c))}:function(t,a,c){return t[a]=c,t},He=Se.f,wrapConstructor=function(t){var Wrapper=function(a,c,_){if(this instanceof Wrapper){switch(arguments.length){case 0:return new t;case 1:return new t(a);case 2:return new t(a,c)}return new t(a,c,_)}return I(t,this,arguments)};return Wrapper.prototype=t.prototype,Wrapper},_export=function(t,a){var c,_,m,g,E,T,I,N,M=t.target,S=t.global,O=t.stat,b=t.proto,R=S?h:O?h[M]:(h[M]||{}).prototype,C=S?Y:Y[M]||Ye(Y,M,{})[M],P=C.prototype;for(m in a)c=!Pe(S?m:M+(O?".":"#")+m,t.forced)&&R&&de(R,m),E=C[m],c&&(T=t.dontCallGetSet?(N=He(R,m))&&N.value:R[m]),g=c&&T?T:a[m],c&&typeof E==typeof g||(I=t.bind&&c?functionBindContext(g,h):t.wrap&&c?wrapConstructor(g):b&&isCallable(g)?A(g):g,(t.sham||g&&g.sham||E&&E.sham)&&Ye(I,"sham",!0),Ye(C,m,I),b&&(de(Y,_=M+"Prototype")||Ye(Y,_,{}),Ye(Y[_],m,g),t.real&&P&&!P[m]&&Ye(P,m,g)))},Ke=Math.ceil,We=Math.floor,qe=Math.trunc||function trunc(t){var a=+t;return(a>0?We:Ke)(a)},toIntegerOrInfinity=function(t){var a=+t;return a!=a||0===a?0:qe(a)},ze=Math.max,$e=Math.min,toAbsoluteIndex=function(t,a){var c=toIntegerOrInfinity(t);return c<0?ze(c+a,0):$e(c,a)},Je=Math.min,toLength=function(t){return t>0?Je(toIntegerOrInfinity(t),9007199254740991):0},lengthOfArrayLike=function(t){return toLength(t.length)},createMethod$4=function(t){return function(a,c,_){var h,m=toIndexedObject(a),g=lengthOfArrayLike(m),E=toAbsoluteIndex(_,g);if(t&&c!=c){for(;g>E;)if((h=m[E++])!=h)return!0}else for(;g>E;E++)if((t||E in m)&&m[E]===c)return t||E||0;return!t&&-1}},Qe={includes:createMethod$4(!0),indexOf:createMethod$4(!1)},Xe={},Ze=Qe.indexOf,et=A([].push),objectKeysInternal=function(t,a){var c,_=toIndexedObject(t),h=0,m=[];for(c in _)!de(Xe,c)&&de(_,c)&&et(m,c);for(;a.length>h;)de(_,c=a[h++])&&(~Ze(m,c)||et(m,c));return m},tt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],rt=Object.keys||function keys(t){return objectKeysInternal(t,tt)},ot=b&&!we?Object.defineProperties:function defineProperties(t,a){anObject(t);for(var c,_=toIndexedObject(a),h=rt(a),m=h.length,g=0;m>g;)Be.f(t,c=h[g++],_[c]);return t},nt={f:ot},it=getBuiltIn("document","documentElement"),at=ce("keys"),sharedKey=function(t){return at[t]||(at[t]=uid(t))},st=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(t){return"<script>"+t+"</"+"script>"},NullProtoObjectViaActiveX=function(t){t.write(scriptTag("")),t.close();var a=t.parentWindow.Object;return t=null,a},NullProtoObject=function(){try{J=new ActiveXObject("htmlfile")}catch(t){}var t,a;NullProtoObject="undefined"!=typeof document?document.domain&&J?NullProtoObjectViaActiveX(J):((a=documentCreateElement("iframe")).style.display="none",it.appendChild(a),a.src=String("javascript:"),(t=a.contentWindow.document).open(),t.write(scriptTag("document.F=Object")),t.close(),t.F):NullProtoObjectViaActiveX(J);for(var c=tt.length;c--;)delete NullProtoObject.prototype[tt[c]];return NullProtoObject()};Xe[st]=!0;var ct=Object.create||function create(t,a){var c;return null!==t?(EmptyConstructor.prototype=anObject(t),c=new EmptyConstructor,EmptyConstructor.prototype=null,c[st]=t):c=NullProtoObject(),void 0===a?c:nt.f(c,a)};_export({target:"Object",stat:!0,sham:!b},{create:ct});var ut=Y.Object,lt=function create(t,a){return ut.create(t,a)},dt=String,ft=TypeError,pt=Object.setPrototypeOf||("__proto__"in{}?function(){var t,a=!1,c={};try{(t=A(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(c,[]),a=c instanceof Array}catch(t){}return function setPrototypeOf(c,_){return anObject(c),function(t){if("object"==typeof t||isCallable(t))return t;throw ft("Can't set "+dt(t)+" as a prototype")}(_),a?t(c,_):c.__proto__=_,c}}():void 0);_export({target:"Object",stat:!0},{setPrototypeOf:pt});var _t=Y.Object.setPrototypeOf,ht=A([].slice),mt=Function,gt=A([].concat),Et=A([].join),vt={},construct$8=function(t,a,c){if(!de(vt,a)){for(var _=[],h=0;h<a;h++)_[h]="a["+h+"]";vt[a]=mt("C,a","return new C("+Et(_,",")+")")}return vt[a](t,c)},yt=m?mt.bind:function bind(t){var a=aCallable(this),c=a.prototype,_=ht(arguments,1),h=function bound(){var c=gt(_,ht(arguments));return this instanceof h?construct$8(a,c.length,c):a.apply(t,c)};return B(c)&&(h.prototype=c),h};_export({target:"Function",proto:!0,forced:Function.bind!==yt},{bind:yt});var entryVirtual=function(t){return Y[t+"Prototype"]},Tt=entryVirtual("Function").bind,It=Function.prototype,bind$1=function(t){var a=t.bind;return t===It||H(It,t)&&a===It.bind?Tt:a},Nt=createCommonjsModule((function(t){function _setPrototypeOf(a,c){var _;return t.exports=_setPrototypeOf=_t?bind$1(_=_t).call(_):function _setPrototypeOf(t,a){return t.__proto__=a,t},t.exports.__esModule=!0,t.exports.default=t.exports,_setPrototypeOf(a,c)}t.exports=_setPrototypeOf,t.exports.__esModule=!0,t.exports.default=t.exports})),Mt=getDefaultExportFromCjs(createCommonjsModule((function(t){t.exports=function _inheritsLoose(t,a){t.prototype=lt(a.prototype),t.prototype.constructor=t,Nt(t,a)},t.exports.__esModule=!0,t.exports.default=t.exports})));_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var St={f:Object.getOwnPropertySymbols},Ot=Object.assign,At=Object.defineProperty,bt=A([].concat),Rt=!Ot||fails((function(){if(b&&1!==Ot({b:1},Ot(At({},"a",{enumerable:!0,get:function(){At(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},a={},c=Symbol(),_="abcdefghijklmnopqrst";return t[c]=7,_.split("").forEach((function(t){a[t]=t})),7!=Ot({},t)[c]||rt(Ot({},a)).join("")!=_}))?function assign(t,a){for(var c=toObject(t),_=arguments.length,h=1,m=St.f,g=w.f;_>h;)for(var E,T=U(arguments[h++]),I=m?bt(rt(T),m(T)):rt(T),N=I.length,M=0;N>M;)E=I[M++],b&&!C(g,T,E)||(c[E]=T[E]);return c}:Ot;_export({target:"Object",stat:!0,arity:2,forced:Object.assign!==Rt},{assign:Rt});var Ct=Y.Object.assign,Pt=!fails((function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype})),kt=sharedKey("IE_PROTO"),wt=Object,xt=wt.prototype,Dt=Pt?wt.getPrototypeOf:function(t){var a=toObject(t);if(de(a,kt))return a[kt];var c=a.constructor;return isCallable(c)&&a instanceof c?c.prototype:a instanceof wt?xt:null},Lt=tt.concat("length","prototype"),Vt={f:Object.getOwnPropertyNames||function getOwnPropertyNames(t){return objectKeysInternal(t,Lt)}},Ut=A([].concat),Ft=getBuiltIn("Reflect","ownKeys")||function ownKeys(t){var a=Vt.f(anObject(t)),c=St.f;return c?Ut(a,c(t)):a},Gt=Error,jt=A("".replace),Bt=String(Gt("zxcasd").stack),Yt=/\n\s*at [^:]*:[^\n]*/,Ht=Yt.test(Bt),errorStackClear=function(t,a){if(Ht&&"string"==typeof t&&!Gt.prepareStackTrace)for(;a--;)t=jt(t,Yt,"");return t},installErrorCause=function(t,a){B(a)&&"cause"in a&&Ye(t,"cause",a.cause)},Kt={},Wt=wellKnownSymbol("iterator"),qt=Array.prototype,isArrayIteratorMethod=function(t){return void 0!==t&&(Kt.Array===t||qt[Wt]===t)},zt={};zt[wellKnownSymbol("toStringTag")]="z";var $t="[object z]"===String(zt),Jt=wellKnownSymbol("toStringTag"),Qt=Object,Xt="Arguments"==classofRaw(function(){return arguments}()),Zt=$t?classofRaw:function(t){var a,c,_;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(c=function(t,a){try{return t[a]}catch(t){}}(a=Qt(t),Jt))?c:Xt?classofRaw(a):"Object"==(_=classofRaw(a))&&isCallable(a.callee)?"Arguments":_},er=wellKnownSymbol("iterator"),getIteratorMethod$5=function(t){if(!isNullOrUndefined(t))return getMethod(t,er)||getMethod(t,"@@iterator")||Kt[Zt(t)]},tr=TypeError,getIterator=function(t,a){var c=arguments.length<2?getIteratorMethod$5(t):a;if(aCallable(c))return anObject(C(c,t));throw tr(tryToString(t)+" is not iterable")},iteratorClose=function(t,a,c){var _,h;anObject(t);try{if(!(_=getMethod(t,"return"))){if("throw"===a)throw c;return c}_=C(_,t)}catch(t){h=!0,_=t}if("throw"===a)throw c;if(h)throw _;return anObject(_),c},rr=TypeError,Result=function(t,a){this.stopped=t,this.result=a},or=Result.prototype,iterate=function(t,a,c){var _,h,m,g,E,T,I,N=c&&c.that,M=!(!c||!c.AS_ENTRIES),S=!(!c||!c.IS_RECORD),O=!(!c||!c.IS_ITERATOR),A=!(!c||!c.INTERRUPTED),b=functionBindContext(a,N),stop=function(t){return _&&iteratorClose(_,"normal",t),new Result(!0,t)},callFn=function(t){return M?(anObject(t),A?b(t[0],t[1],stop):b(t[0],t[1])):A?b(t,stop):b(t)};if(S)_=t.iterator;else if(O)_=t;else{if(!(h=getIteratorMethod$5(t)))throw rr(tryToString(t)+" is not iterable");if(isArrayIteratorMethod(h)){for(m=0,g=lengthOfArrayLike(t);g>m;m++)if((E=callFn(t[m]))&&H(or,E))return E;return new Result(!1)}_=getIterator(t,h)}for(T=S?t.next:_.next;!(I=C(T,_)).done;){try{E=callFn(I.value)}catch(t){iteratorClose(_,"throw",t)}if("object"==typeof E&&E&&H(or,E))return E}return new Result(!1)},nr=String,toString$1=function(t){if("Symbol"===Zt(t))throw TypeError("Cannot convert a Symbol value to a string");return nr(t)},normalizeStringArgument=function(t,a){return void 0===t?arguments.length<2?"":a:toString$1(t)},ir=!fails((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",createPropertyDescriptor(1,7)),7!==t.stack)})),ar=wellKnownSymbol("toStringTag"),sr=Error,cr=[].push,ur=function AggregateError(t,a){var c,_=arguments.length>2?arguments[2]:void 0,h=H(lr,this);pt?c=pt(sr(),h?Dt(this):lr):(c=h?this:ct(lr),Ye(c,ar,"Error")),void 0!==a&&Ye(c,"message",normalizeStringArgument(a)),ir&&Ye(c,"stack",errorStackClear(c.stack,1)),installErrorCause(c,_);var m=[];return iterate(t,cr,{that:m}),Ye(c,"errors",m),c};pt?pt(ur,sr):function(t,a,c){for(var _=Ft(a),h=Be.f,m=Se.f,g=0;g<_.length;g++){var E=_[g];de(t,E)||c&&de(c,E)||h(t,E,m(a,E))}}(ur,sr,{name:!0});var lr=ur.prototype=ct(sr.prototype,{constructor:createPropertyDescriptor(1,ur),message:createPropertyDescriptor(1,""),name:createPropertyDescriptor(1,"AggregateError")});_export({global:!0,constructor:!0,arity:2},{AggregateError:ur});var dr,fr,pr,_r=h.WeakMap,hr=isCallable(_r)&&/native code/.test(String(_r)),mr="Object already initialized",gr=h.TypeError,Er=h.WeakMap;if(hr||se.state){var vr=se.state||(se.state=new Er),yr=A(vr.get),Tr=A(vr.has),Ir=A(vr.set);dr=function(t,a){if(Tr(vr,t))throw gr(mr);return a.facade=t,Ir(vr,t,a),a},fr=function(t){return yr(vr,t)||{}},pr=function(t){return Tr(vr,t)}}else{var Nr=sharedKey("state");Xe[Nr]=!0,dr=function(t,a){if(de(t,Nr))throw gr(mr);return a.facade=t,Ye(t,Nr,a),a},fr=function(t){return de(t,Nr)?t[Nr]:{}},pr=function(t){return de(t,Nr)}}var Mr,Sr,Or,Ar={set:dr,get:fr,has:pr,enforce:function(t){return pr(t)?fr(t):dr(t,{})},getterFor:function(t){return function(a){var c;if(!B(a)||(c=fr(a)).type!==t)throw gr("Incompatible receiver, "+t+" required");return c}}},br=Function.prototype,Rr=b&&Object.getOwnPropertyDescriptor,Cr=de(br,"name"),Pr={EXISTS:Cr,PROPER:Cr&&"something"===function something(){}.name,CONFIGURABLE:Cr&&(!b||b&&Rr(br,"name").configurable)},defineBuiltIn=function(t,a,c,_){return _&&_.enumerable?t[a]=c:Ye(t,a,c),t},kr=wellKnownSymbol("iterator"),wr=!1;[].keys&&("next"in(Or=[].keys())?(Sr=Dt(Dt(Or)))!==Object.prototype&&(Mr=Sr):wr=!0);var xr=!B(Mr)||fails((function(){var t={};return Mr[kr].call(t)!==t}));Mr=xr?{}:ct(Mr),isCallable(Mr[kr])||defineBuiltIn(Mr,kr,(function(){return this}));var Dr={IteratorPrototype:Mr,BUGGY_SAFARI_ITERATORS:wr},Lr=$t?{}.toString:function toString(){return"[object "+Zt(this)+"]"},Vr=Be.f,Ur=wellKnownSymbol("toStringTag"),setToStringTag=function(t,a,c,_){if(t){var h=c?t:t.prototype;de(h,Ur)||Vr(h,Ur,{configurable:!0,value:a}),_&&!$t&&Ye(h,"toString",Lr)}},Fr=Dr.IteratorPrototype,returnThis$1=function(){return this},Gr=Pr.PROPER,jr=Dr.BUGGY_SAFARI_ITERATORS,Br=wellKnownSymbol("iterator"),Yr="keys",Hr="values",Kr="entries",returnThis=function(){return this},iteratorDefine=function(t,a,c,_,h,m,g){!function(t,a,c,_){var h=a+" Iterator";t.prototype=ct(Fr,{next:createPropertyDescriptor(+!_,c)}),setToStringTag(t,h,!1,!0),Kt[h]=returnThis$1}(c,a,_);var E,T,I,getIterationMethod=function(t){if(t===h&&A)return A;if(!jr&&t in S)return S[t];switch(t){case Yr:return function keys(){return new c(this,t)};case Hr:return function values(){return new c(this,t)};case Kr:return function entries(){return new c(this,t)}}return function(){return new c(this)}},N=a+" Iterator",M=!1,S=t.prototype,O=S[Br]||S["@@iterator"]||h&&S[h],A=!jr&&O||getIterationMethod(h),b="Array"==a&&S.entries||O;if(b&&(E=Dt(b.call(new t)))!==Object.prototype&&E.next&&(setToStringTag(E,N,!0,!0),Kt[N]=returnThis),Gr&&h==Hr&&O&&O.name!==Hr&&(M=!0,A=function values(){return C(O,this)}),h)if(T={values:getIterationMethod(Hr),keys:m?A:getIterationMethod(Yr),entries:getIterationMethod(Kr)},g)for(I in T)(jr||M||!(I in S))&&defineBuiltIn(S,I,T[I]);else _export({target:a,proto:!0,forced:jr||M},T);return g&&S[Br]!==A&&defineBuiltIn(S,Br,A,{name:h}),Kt[a]=A,T};Be.f;var Wr="Array Iterator",qr=Ar.set,zr=Ar.getterFor(Wr);iteratorDefine(Array,"Array",(function(t,a){qr(this,{type:Wr,target:toIndexedObject(t),index:0,kind:a})}),(function(){var t=zr(this),a=t.target,c=t.kind,_=t.index++;return!a||_>=a.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==c?{value:_,done:!1}:"values"==c?{value:a[_],done:!1}:{value:[_,a[_]],done:!1}}),"values"),Kt.Arguments=Kt.Array;var $r="process"==classofRaw(h.process),Jr=wellKnownSymbol("species"),setSpecies=function(t){var a=getBuiltIn(t),c=Be.f;b&&a&&!a[Jr]&&c(a,Jr,{configurable:!0,get:function(){return this}})},Qr=TypeError,anInstance=function(t,a){if(H(a,t))return t;throw Qr("Incorrect invocation")},Xr=A(Function.toString);isCallable(se.inspectSource)||(se.inspectSource=function(t){return Xr(t)});var Zr=se.inspectSource,noop$1=function(){},eo=[],to=getBuiltIn("Reflect","construct"),ro=/^\s*(?:class|function)\b/,oo=A(ro.exec),no=!ro.exec(noop$1),io=function isConstructor(t){if(!isCallable(t))return!1;try{return to(noop$1,eo,t),!0}catch(t){return!1}},ao=function isConstructor(t){if(!isCallable(t))return!1;switch(Zt(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return no||!!oo(ro,Zr(t))}catch(t){return!0}};ao.sham=!0;var so,co,uo,lo,fo=!to||fails((function(){var t;return io(io.call)||!io(Object)||!io((function(){t=!0}))||t}))?ao:io,po=TypeError,aConstructor=function(t){if(fo(t))return t;throw po(tryToString(t)+" is not a constructor")},_o=wellKnownSymbol("species"),speciesConstructor=function(t,a){var c,_=anObject(t).constructor;return void 0===_||isNullOrUndefined(c=anObject(_)[_o])?a:aConstructor(c)},ho=TypeError,validateArgumentsLength=function(t,a){if(t<a)throw ho("Not enough arguments");return t},mo=/(?:ipad|iphone|ipod).*applewebkit/i.test(K),go=h.setImmediate,Eo=h.clearImmediate,vo=h.process,yo=h.Dispatch,To=h.Function,Io=h.MessageChannel,No=h.String,Mo=0,So={},Oo="onreadystatechange";try{so=h.location}catch(t){}var run=function(t){if(de(So,t)){var a=So[t];delete So[t],a()}},runner=function(t){return function(){run(t)}},listener=function(t){run(t.data)},post=function(t){h.postMessage(No(t),so.protocol+"//"+so.host)};go&&Eo||(go=function setImmediate(t){validateArgumentsLength(arguments.length,1);var a=isCallable(t)?t:To(t),c=ht(arguments,1);return So[++Mo]=function(){I(a,void 0,c)},co(Mo),Mo},Eo=function clearImmediate(t){delete So[t]},$r?co=function(t){vo.nextTick(runner(t))}:yo&&yo.now?co=function(t){yo.now(runner(t))}:Io&&!mo?(lo=(uo=new Io).port2,uo.port1.onmessage=listener,co=functionBindContext(lo.postMessage,lo)):h.addEventListener&&isCallable(h.postMessage)&&!h.importScripts&&so&&"file:"!==so.protocol&&!fails(post)?(co=post,h.addEventListener("message",listener,!1)):co=Oo in documentCreateElement("script")?function(t){it.appendChild(documentCreateElement("script")).onreadystatechange=function(){it.removeChild(this),run(t)}}:function(t){setTimeout(runner(t),0)});var Ao,bo,Ro,Co,Po,ko,wo,xo,Do={set:go,clear:Eo},Lo=/ipad|iphone|ipod/i.test(K)&&void 0!==h.Pebble,Vo=/web0s(?!.*chrome)/i.test(K),Uo=Se.f,Fo=Do.set,Go=h.MutationObserver||h.WebKitMutationObserver,jo=h.document,Bo=h.process,Yo=h.Promise,Ho=Uo(h,"queueMicrotask"),Ko=Ho&&Ho.value;Ko||(Ao=function(){var t,a;for($r&&(t=Bo.domain)&&t.exit();bo;){a=bo.fn,bo=bo.next;try{a()}catch(t){throw bo?Co():Ro=void 0,t}}Ro=void 0,t&&t.enter()},mo||$r||Vo||!Go||!jo?!Lo&&Yo&&Yo.resolve?((wo=Yo.resolve(void 0)).constructor=Yo,xo=functionBindContext(wo.then,wo),Co=function(){xo(Ao)}):$r?Co=function(){Bo.nextTick(Ao)}:(Fo=functionBindContext(Fo,h),Co=function(){Fo(Ao)}):(Po=!0,ko=jo.createTextNode(""),new Go(Ao).observe(ko,{characterData:!0}),Co=function(){ko.data=Po=!Po}));var Wo=Ko||function(t){var a={fn:t,next:void 0};Ro&&(Ro.next=a),bo||(bo=a,Co()),Ro=a},perform=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Queue=function(){this.head=null,this.tail=null};Queue.prototype={add:function(t){var a={item:t,next:null};this.head?this.tail.next=a:this.head=a,this.tail=a},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var qo,zo,$o=Queue,Jo=h.Promise,Qo="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Xo=!Qo&&!$r&&"object"==typeof window&&"object"==typeof document,Zo=Jo&&Jo.prototype,en=wellKnownSymbol("species"),tn=!1,rn=isCallable(h.PromiseRejectionEvent),nn=Pe("Promise",(function(){var t=Zr(Jo),a=t!==String(Jo);if(!a&&66===Q)return!0;if(!Zo.catch||!Zo.finally)return!0;if(!Q||Q<51||!/native code/.test(t)){var c=new Jo((function(t){t(1)})),FakePromise=function(t){t((function(){}),(function(){}))};if((c.constructor={})[en]=FakePromise,!(tn=c.then((function(){}))instanceof FakePromise))return!0}return!a&&(Xo||Qo)&&!rn})),an={CONSTRUCTOR:nn,REJECTION_EVENT:rn,SUBCLASSING:tn},sn=TypeError,PromiseCapability=function(t){var a,c;this.promise=new t((function(t,_){if(void 0!==a||void 0!==c)throw sn("Bad Promise constructor");a=t,c=_})),this.resolve=aCallable(a),this.reject=aCallable(c)},cn={f:function(t){return new PromiseCapability(t)}},un=Do.set,ln="Promise",dn=an.CONSTRUCTOR,fn=an.REJECTION_EVENT,pn=Ar.getterFor(ln),_n=Ar.set,hn=Jo&&Jo.prototype,mn=Jo,gn=hn,En=h.TypeError,vn=h.document,yn=h.process,Tn=cn.f,In=Tn,Nn=!!(vn&&vn.createEvent&&h.dispatchEvent),Mn="unhandledrejection",isThenable=function(t){var a;return!(!B(t)||!isCallable(a=t.then))&&a},callReaction=function(t,a){var c,_,h,m=a.value,g=1==a.state,E=g?t.ok:t.fail,T=t.resolve,I=t.reject,N=t.domain;try{E?(g||(2===a.rejection&&onHandleUnhandled(a),a.rejection=1),!0===E?c=m:(N&&N.enter(),c=E(m),N&&(N.exit(),h=!0)),c===t.promise?I(En("Promise-chain cycle")):(_=isThenable(c))?C(_,c,T,I):T(c)):I(m)}catch(t){N&&!h&&N.exit(),I(t)}},notify=function(t,a){t.notified||(t.notified=!0,Wo((function(){for(var c,_=t.reactions;c=_.get();)callReaction(c,t);t.notified=!1,a&&!t.rejection&&onUnhandled(t)})))},dispatchEvent=function(t,a,c){var _,m;Nn?((_=vn.createEvent("Event")).promise=a,_.reason=c,_.initEvent(t,!1,!0),h.dispatchEvent(_)):_={promise:a,reason:c},!fn&&(m=h["on"+t])?m(_):t===Mn&&function(t,a){var c=h.console;c&&c.error&&(1==arguments.length?c.error(t):c.error(t,a))}("Unhandled promise rejection",c)},onUnhandled=function(t){C(un,h,(function(){var a,c=t.facade,_=t.value;if(isUnhandled(t)&&(a=perform((function(){$r?yn.emit("unhandledRejection",_,c):dispatchEvent(Mn,c,_)})),t.rejection=$r||isUnhandled(t)?2:1,a.error))throw a.value}))},isUnhandled=function(t){return 1!==t.rejection&&!t.parent},onHandleUnhandled=function(t){C(un,h,(function(){var a=t.facade;$r?yn.emit("rejectionHandled",a):dispatchEvent("rejectionhandled",a,t.value)}))},bind=function(t,a,c){return function(_){t(a,_,c)}},internalReject=function(t,a,c){t.done||(t.done=!0,c&&(t=c),t.value=a,t.state=2,notify(t,!0))},internalResolve=function(t,a,c){if(!t.done){t.done=!0,c&&(t=c);try{if(t.facade===a)throw En("Promise can't be resolved itself");var _=isThenable(a);_?Wo((function(){var c={done:!1};try{C(_,a,bind(internalResolve,c,t),bind(internalReject,c,t))}catch(a){internalReject(c,a,t)}})):(t.value=a,t.state=1,notify(t,!1))}catch(a){internalReject({done:!1},a,t)}}};dn&&(gn=(mn=function Promise(t){anInstance(this,gn),aCallable(t),C(qo,this);var a=pn(this);try{t(bind(internalResolve,a),bind(internalReject,a))}catch(t){internalReject(a,t)}}).prototype,(qo=function Promise(t){_n(this,{type:ln,done:!1,notified:!1,parent:!1,reactions:new $o,rejection:!1,state:0,value:void 0})}).prototype=defineBuiltIn(gn,"then",(function then(t,a){var c=pn(this),_=Tn(speciesConstructor(this,mn));return c.parent=!0,_.ok=!isCallable(t)||t,_.fail=isCallable(a)&&a,_.domain=$r?yn.domain:void 0,0==c.state?c.reactions.add(_):Wo((function(){callReaction(_,c)})),_.promise})),zo=function(){var t=new qo,a=pn(t);this.promise=t,this.resolve=bind(internalResolve,a),this.reject=bind(internalReject,a)},cn.f=Tn=function(t){return t===mn||undefined===t?new zo(t):In(t)}),_export({global:!0,constructor:!0,wrap:!0,forced:dn},{Promise:mn}),setToStringTag(mn,ln,!1,!0),setSpecies(ln);var Sn=wellKnownSymbol("iterator"),On=!1;try{var An=0,bn={next:function(){return{done:!!An++}},return:function(){On=!0}};bn[Sn]=function(){return this},Array.from(bn,(function(){throw 2}))}catch(t){}var checkCorrectnessOfIteration=function(t,a){if(!a&&!On)return!1;var c=!1;try{var _={};_[Sn]=function(){return{next:function(){return{done:c=!0}}}},t(_)}catch(t){}return c},Rn=an.CONSTRUCTOR||!checkCorrectnessOfIteration((function(t){Jo.all(t).then(void 0,(function(){}))}));_export({target:"Promise",stat:!0,forced:Rn},{all:function all(t){var a=this,c=cn.f(a),_=c.resolve,h=c.reject,m=perform((function(){var c=aCallable(a.resolve),m=[],g=0,E=1;iterate(t,(function(t){var T=g++,I=!1;E++,C(c,a,t).then((function(t){I||(I=!0,m[T]=t,--E||_(m))}),h)})),--E||_(m)}));return m.error&&h(m.value),c.promise}});var Cn=an.CONSTRUCTOR;Jo&&Jo.prototype,_export({target:"Promise",proto:!0,forced:Cn,real:!0},{catch:function(t){return this.then(void 0,t)}}),_export({target:"Promise",stat:!0,forced:Rn},{race:function race(t){var a=this,c=cn.f(a),_=c.reject,h=perform((function(){var h=aCallable(a.resolve);iterate(t,(function(t){C(h,a,t).then(c.resolve,_)}))}));return h.error&&_(h.value),c.promise}}),_export({target:"Promise",stat:!0,forced:an.CONSTRUCTOR},{reject:function reject(t){var a=cn.f(this);return C(a.reject,void 0,t),a.promise}});var promiseResolve=function(t,a){if(anObject(t),B(a)&&a.constructor===t)return a;var c=cn.f(t);return(0,c.resolve)(a),c.promise},Pn=an.CONSTRUCTOR,kn=getBuiltIn("Promise"),wn=!Pn;_export({target:"Promise",stat:!0,forced:!0},{resolve:function resolve(t){return promiseResolve(wn&&this===kn?Jo:this,t)}}),_export({target:"Promise",stat:!0},{allSettled:function allSettled(t){var a=this,c=cn.f(a),_=c.resolve,h=c.reject,m=perform((function(){var c=aCallable(a.resolve),h=[],m=0,g=1;iterate(t,(function(t){var E=m++,T=!1;g++,C(c,a,t).then((function(t){T||(T=!0,h[E]={status:"fulfilled",value:t},--g||_(h))}),(function(t){T||(T=!0,h[E]={status:"rejected",reason:t},--g||_(h))}))})),--g||_(h)}));return m.error&&h(m.value),c.promise}});var xn="No one promise resolved";_export({target:"Promise",stat:!0},{any:function any(t){var a=this,c=getBuiltIn("AggregateError"),_=cn.f(a),h=_.resolve,m=_.reject,g=perform((function(){var _=aCallable(a.resolve),g=[],E=0,T=1,I=!1;iterate(t,(function(t){var N=E++,M=!1;T++,C(_,a,t).then((function(t){M||I||(I=!0,h(t))}),(function(t){M||I||(M=!0,g[N]=t,--T||m(new c(g,xn)))}))})),--T||m(new c(g,xn))}));return g.error&&m(g.value),_.promise}});var Dn=Jo&&Jo.prototype,Ln=!!Jo&&fails((function(){Dn.finally.call({then:function(){}},(function(){}))}));_export({target:"Promise",proto:!0,real:!0,forced:Ln},{finally:function(t){var a=speciesConstructor(this,getBuiltIn("Promise")),c=isCallable(t);return this.then(c?function(c){return promiseResolve(a,t()).then((function(){return c}))}:t,c?function(c){return promiseResolve(a,t()).then((function(){throw c}))}:t)}});var Vn=A("".charAt),Un=A("".charCodeAt),Fn=A("".slice),createMethod$3=function(t){return function(a,c){var _,h,m=toString$1(requireObjectCoercible(a)),g=toIntegerOrInfinity(c),E=m.length;return g<0||g>=E?t?"":void 0:(_=Un(m,g))<55296||_>56319||g+1===E||(h=Un(m,g+1))<56320||h>57343?t?Vn(m,g):_:t?Fn(m,g,g+2):h-56320+(_-55296<<10)+65536}},Gn={codeAt:createMethod$3(!1),charAt:createMethod$3(!0)}.charAt,jn="String Iterator",Bn=Ar.set,Yn=Ar.getterFor(jn);iteratorDefine(String,"String",(function(t){Bn(this,{type:jn,string:toString$1(t),index:0})}),(function next(){var t,a=Yn(this),c=a.string,_=a.index;return _>=c.length?{value:void 0,done:!0}:(t=Gn(c,_),a.index+=t.length,{value:t,done:!1})}));var Hn=Y.Promise,Kn=wellKnownSymbol("toStringTag");for(var Wn in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var qn=h[Wn],zn=qn&&qn.prototype;zn&&Zt(zn)!==Kn&&Ye(zn,Kn,Wn),Kt[Wn]=Kt.Array}var $n=Hn;_export({target:"Promise",stat:!0,forced:!0},{try:function(t){var a=cn.f(this),c=perform(t);return(c.error?a.reject:a.resolve)(c.value),a.promise}});var Jn=$n,Qn=Date,Xn=A(Qn.prototype.getTime);_export({target:"Date",stat:!0},{now:function now(){return Xn(new Qn)}});var Zn=Y.Date.now,ei=Array.isArray||function isArray(t){return"Array"==classofRaw(t)},ti=TypeError,doesNotExceedSafeInteger=function(t){if(t>9007199254740991)throw ti("Maximum allowed index exceeded");return t},createProperty=function(t,a,c){var _=toPropertyKey(a);_ in t?Be.f(t,_,createPropertyDescriptor(0,c)):t[_]=c},ri=wellKnownSymbol("species"),oi=Array,arraySpeciesCreate=function(t,a){return new(function(t){var a;return ei(t)&&(a=t.constructor,(fo(a)&&(a===oi||ei(a.prototype))||B(a)&&null===(a=a[ri]))&&(a=void 0)),void 0===a?oi:a}(t))(0===a?0:a)},ni=wellKnownSymbol("species"),arrayMethodHasSpeciesSupport=function(t){return Q>=51||!fails((function(){var a=[];return(a.constructor={})[ni]=function(){return{foo:1}},1!==a[t](Boolean).foo}))},ii=wellKnownSymbol("isConcatSpreadable"),ai=Q>=51||!fails((function(){var t=[];return t[ii]=!1,t.concat()[0]!==t})),si=arrayMethodHasSpeciesSupport("concat"),isConcatSpreadable=function(t){if(!B(t))return!1;var a=t[ii];return void 0!==a?!!a:ei(t)};_export({target:"Array",proto:!0,arity:1,forced:!ai||!si},{concat:function concat(t){var a,c,_,h,m,g=toObject(this),E=arraySpeciesCreate(g,0),T=0;for(a=-1,_=arguments.length;a<_;a++)if(isConcatSpreadable(m=-1===a?g:arguments[a]))for(h=lengthOfArrayLike(m),doesNotExceedSafeInteger(T+h),c=0;c<h;c++,T++)c in m&&createProperty(E,T,m[c]);else doesNotExceedSafeInteger(T+1),createProperty(E,T++,m);return E.length=T,E}});var ci=entryVirtual("Array").concat,ui=Array.prototype,concat=function(t){var a=t.concat;return t===ui||H(ui,t)&&a===ui.concat?ci:a},li=/MSIE .\./.test(K),di=h.Function,wrap$1=function(t){return li?function(a,c){var _=validateArgumentsLength(arguments.length,1)>2,h=isCallable(a)?a:di(a),m=_?ht(arguments,2):void 0;return t(_?function(){I(h,this,m)}:h,c)}:t},fi={setTimeout:wrap$1(h.setTimeout),setInterval:wrap$1(h.setInterval)},pi=fi.setInterval;_export({global:!0,bind:!0,forced:h.setInterval!==pi},{setInterval:pi});var _i=fi.setTimeout;_export({global:!0,bind:!0,forced:h.setTimeout!==_i},{setTimeout:_i});var hi=Y.setTimeout,mi=createCommonjsModule((function(t){var a=Object.prototype.hasOwnProperty,c="~";function Events(){}function EE(t,a,c){this.fn=t,this.context=a,this.once=c||!1}function addListener(t,a,_,h,m){if("function"!=typeof _)throw new TypeError("The listener must be a function");var g=new EE(_,h||t,m),E=c?c+a:a;return t._events[E]?t._events[E].fn?t._events[E]=[t._events[E],g]:t._events[E].push(g):(t._events[E]=g,t._eventsCount++),t}function clearEvent(t,a){0==--t._eventsCount?t._events=new Events:delete t._events[a]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(c=!1)),EventEmitter.prototype.eventNames=function eventNames(){var t,_,h=[];if(0===this._eventsCount)return h;for(_ in t=this._events)a.call(t,_)&&h.push(c?_.slice(1):_);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(t)):h},EventEmitter.prototype.listeners=function listeners(t){var a=c?c+t:t,_=this._events[a];if(!_)return[];if(_.fn)return[_.fn];for(var h=0,m=_.length,g=new Array(m);h<m;h++)g[h]=_[h].fn;return g},EventEmitter.prototype.listenerCount=function listenerCount(t){var a=c?c+t:t,_=this._events[a];return _?_.fn?1:_.length:0},EventEmitter.prototype.emit=function emit(t,a,_,h,m,g){var E=c?c+t:t;if(!this._events[E])return!1;var T,I,N=this._events[E],M=arguments.length;if(N.fn){switch(N.once&&this.removeListener(t,N.fn,void 0,!0),M){case 1:return N.fn.call(N.context),!0;case 2:return N.fn.call(N.context,a),!0;case 3:return N.fn.call(N.context,a,_),!0;case 4:return N.fn.call(N.context,a,_,h),!0;case 5:return N.fn.call(N.context,a,_,h,m),!0;case 6:return N.fn.call(N.context,a,_,h,m,g),!0}for(I=1,T=new Array(M-1);I<M;I++)T[I-1]=arguments[I];N.fn.apply(N.context,T)}else{var S,O=N.length;for(I=0;I<O;I++)switch(N[I].once&&this.removeListener(t,N[I].fn,void 0,!0),M){case 1:N[I].fn.call(N[I].context);break;case 2:N[I].fn.call(N[I].context,a);break;case 3:N[I].fn.call(N[I].context,a,_);break;case 4:N[I].fn.call(N[I].context,a,_,h);break;default:if(!T)for(S=1,T=new Array(M-1);S<M;S++)T[S-1]=arguments[S];N[I].fn.apply(N[I].context,T)}}return!0},EventEmitter.prototype.on=function on(t,a,c){return addListener(this,t,a,c,!1)},EventEmitter.prototype.once=function once(t,a,c){return addListener(this,t,a,c,!0)},EventEmitter.prototype.removeListener=function removeListener(t,a,_,h){var m=c?c+t:t;if(!this._events[m])return this;if(!a)return clearEvent(this,m),this;var g=this._events[m];if(g.fn)g.fn!==a||h&&!g.once||_&&g.context!==_||clearEvent(this,m);else{for(var E=0,T=[],I=g.length;E<I;E++)(g[E].fn!==a||h&&!g[E].once||_&&g[E].context!==_)&&T.push(g[E]);T.length?this._events[m]=1===T.length?T[0]:T:clearEvent(this,m)}return this},EventEmitter.prototype.removeAllListeners=function removeAllListeners(t){var a;return t?(a=c?c+t:t,this._events[a]&&clearEvent(this,a)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=c,EventEmitter.EventEmitter=EventEmitter,t.exports=EventEmitter}));_export({global:!0},{globalThis:h});var gi=Be.f;_export({target:"Object",stat:!0,forced:Object.defineProperty!==gi,sham:!b},{defineProperty:gi});var Ei=createCommonjsModule((function(t){var a=Y.Object,c=t.exports=function defineProperty(t,c,_){return a.defineProperty(t,c,_)};a.defineProperty.sham&&(c.sham=!0)})),vi=Ei,yi=A([].push),createMethod$2=function(t){var a=1==t,c=2==t,_=3==t,h=4==t,m=6==t,g=7==t,E=5==t||m;return function(T,I,N,M){for(var S,O,A=toObject(T),b=U(A),R=functionBindContext(I,N),C=lengthOfArrayLike(b),P=0,k=M||arraySpeciesCreate,w=a?k(T,C):c||g?k(T,0):void 0;C>P;P++)if((E||P in b)&&(O=R(S=b[P],P,A),t))if(a)w[P]=O;else if(O)switch(t){case 3:return!0;case 5:return S;case 6:return P;case 2:yi(w,S)}else switch(t){case 4:return!1;case 7:yi(w,S)}return m?-1:_||h?h:w}},Ti={forEach:createMethod$2(0),map:createMethod$2(1),filter:createMethod$2(2),some:createMethod$2(3),every:createMethod$2(4),find:createMethod$2(5),findIndex:createMethod$2(6),filterReject:createMethod$2(7)},arrayMethodIsStrict=function(t,a){var c=[][t];return!!c&&fails((function(){c.call(null,a||function(){return 1},1)}))},Ii=Ti.forEach,Ni=arrayMethodIsStrict("forEach")?[].forEach:function forEach(t){return Ii(this,t,arguments.length>1?arguments[1]:void 0)};_export({target:"Array",proto:!0,forced:[].forEach!=Ni},{forEach:Ni});var Mi=entryVirtual("Array").forEach,Si=Array.prototype,Oi={DOMTokenList:!0,NodeList:!0},forEach$1=function(t){var a=t.forEach;return t===Si||H(Si,t)&&a===Si.forEach||de(Oi,Zt(t))?Mi:a},Ai=Qe.includes,bi=fails((function(){return!Array(1).includes()}));_export({target:"Array",proto:!0,forced:bi},{includes:function includes(t){return Ai(this,t,arguments.length>1?arguments[1]:void 0)}});var Ri=entryVirtual("Array").includes,Ci=wellKnownSymbol("match"),Pi=TypeError,notARegexp=function(t){if(function(t){var a;return B(t)&&(void 0!==(a=t[Ci])?!!a:"RegExp"==classofRaw(t))}(t))throw Pi("The method doesn't accept regular expressions");return t},ki=wellKnownSymbol("match"),correctIsRegexpLogic=function(t){var a=/./;try{"/./"[t](a)}catch(c){try{return a[ki]=!1,"/./"[t](a)}catch(t){}}return!1},wi=A("".indexOf);_export({target:"String",proto:!0,forced:!correctIsRegexpLogic("includes")},{includes:function includes(t){return!!~wi(toString$1(requireObjectCoercible(this)),toString$1(notARegexp(t)),arguments.length>1?arguments[1]:void 0)}});var xi=entryVirtual("String").includes,Di=Array.prototype,Li=String.prototype,includes=function(t){var a=t.includes;return t===Di||H(Di,t)&&a===Di.includes?Ri:"string"==typeof t||t===Li||H(Li,t)&&a===Li.includes?xi:a},Vi=fails((function(){rt(1)}));_export({target:"Object",stat:!0,forced:Vi},{keys:function keys(t){return rt(toObject(t))}});var Ui=Y.Object.keys,Fi=Ti.filter,Gi=arrayMethodHasSpeciesSupport("filter");_export({target:"Array",proto:!0,forced:!Gi},{filter:function filter(t){return Fi(this,t,arguments.length>1?arguments[1]:void 0)}});var ji=entryVirtual("Array").filter,Bi=Array.prototype,filter=function(t){var a=t.filter;return t===Bi||H(Bi,t)&&a===Bi.filter?ji:a},Yi=arrayMethodHasSpeciesSupport("slice"),Hi=wellKnownSymbol("species"),Ki=Array,Wi=Math.max;_export({target:"Array",proto:!0,forced:!Yi},{slice:function slice(t,a){var c,_,h,m=toIndexedObject(this),g=lengthOfArrayLike(m),E=toAbsoluteIndex(t,g),T=toAbsoluteIndex(void 0===a?g:a,g);if(ei(m)&&(c=m.constructor,(fo(c)&&(c===Ki||ei(c.prototype))||B(c)&&null===(c=c[Hi]))&&(c=void 0),c===Ki||void 0===c))return ht(m,E,T);for(_=new(void 0===c?Ki:c)(Wi(T-E,0)),h=0;E<T;E++,h++)E in m&&createProperty(_,h,m[E]);return _.length=h,_}});var qi=entryVirtual("Array").slice,zi=Array.prototype,slice$1=function(t){var a=t.slice;return t===zi||H(zi,t)&&a===zi.slice?qi:a},$i=createCommonjsModule((function(t,a){t.exports=function(){function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,a){for(var c=0;c<a.length;c++){var _=a[c];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),vi(t,_.key,_)}}function _createClass(t,a,c){return a&&_defineProperties(t.prototype,a),c&&_defineProperties(t,c),vi(t,"prototype",{writable:!1}),t}var t={isDataReportEnable:!0,maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0,loginFailIgnoreInterval:6e5},a=function emptyFn(){},c=function(){function Reporter(a){_classCallCheck(this,Reporter),this.isUploadEnable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=t,this.traceMsgCache={},this.highPriorityMsgList=[],this.msgList=[],this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=Zn(),this.timer=null,this.endedAsyncMsgByModule={},this.lastFailLogin={},this.setConfig(a),this.reportConfig.isDataReportEnable&&this.reportConfig.autoStart&&this.initUploadConfig()}return _createClass(Reporter,[{key:"setConfig",value:function setConfig(t){var a=Ct({},this.reportConfig.common,t.common);this.reportConfig=Ct({},this.reportConfig,t),this.reportConfig.common=a,this.reportConfig.common.sdk_type||(this.reportConfig.common.sdk_type="im")}},{key:"reportImmediately",value:function reportImmediately(t,a){var c=this;this.reportConfig.isDataReportEnable&&this.reportConfig.request(t,Ct({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},a)).catch((function(t){var a,_;null===(_=null===(a=c.reportConfig)||void 0===a?void 0:a.logger)||void 0===_||_.warn("Reporter immediately upload failed",t)}))}},{key:"report",value:function report(a,c){var _=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(_.priority||(_.priority=this.getEventPriority(a,c)),this.reportConfig.isDataReportEnable&&a){if("login"===a&&!1===c.succeed&&c.process_id){var h=this.lastFailLogin[c.process_id]||0;if(c.start_time-h<t.loginFailIgnoreInterval)return;this.lastFailLogin[c.process_id]=c.start_time}var m=Zn();"HIGH"===_.priority?this.highPriorityMsgList.push({module:a,msg:c,createTime:m}):"NORMAL"===_.priority?this.msgList.push({module:a,msg:c,createTime:m}):"LOW"===_.priority&&this.lowPriorityMsgList.push({module:a,msg:c,createTime:m}),this.highPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.highPriorityMsgList.shift(),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function reportTraceStart(t,a){if(this.reportConfig.isDataReportEnable&&t&&!this.traceMsgCache[t]){var c=Ct(Ct({start_time:Zn()},a),{extension:[]});this.traceMsgCache[t]=c}}},{key:"reportTraceUpdate",value:function reportTraceUpdate(t){}},{key:"reportTraceUpdateV2",value:function reportTraceUpdateV2(t,a,c){var _,h=this;if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[t]){var m=this.traceMsgCache[t].extension,g=m.length,E=(new Date).getTime();0===g?a.duration=E-this.traceMsgCache[t].start_time:m[g-1].end_time?a.duration=E-m[g-1].end_time:a.duration=E-this.traceMsgCache[t].start_time,m.push(Ct({end_time:E},a));var T=m.length-1;(null==c?void 0:c.asyncParams)&&((_=this.traceMsgCache[t]).asyncPromiseArray||(_.asyncPromiseArray=[]),this.traceMsgCache[t].asyncPromiseArray.push(c.asyncParams.then((function(a){h.traceMsgCache[t]&&h.traceMsgCache[t].extension[T]&&Ct(h.traceMsgCache[t].extension[T],a)}))))}}},{key:"reportTraceEnd",value:function reportTraceEnd(t){var a,c,_=this,h=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[t])if("nos"!==t||!1===h){"boolean"==typeof h?this.traceMsgCache[t].succeed=!!h:this.traceMsgCache[t].state=h,this.traceMsgCache[t].duration=Zn()-this.traceMsgCache[t].start_time,forEach$1(a=this.traceMsgCache[t].extension).call(a,(function(t){delete t.end_time}));var m=this.traceMsgCache[t];if(this.traceMsgCache[t]=null,m.asyncPromiseArray){(c=this.endedAsyncMsgByModule)[t]||(c[t]=[]),this.endedAsyncMsgByModule[t].push(m);var g=function asyncCallback(){var a;_.endedAsyncMsgByModule[t]&&includes(a=_.endedAsyncMsgByModule[t]).call(a,m)&&(delete m.asyncPromiseArray,_.report(t,m,{priority:_.getEventPriority(t,m)}))};Jn.all(m.asyncPromiseArray).then(g).catch(g)}else this.report(t,m,{priority:this.getEventPriority(t,m)})}else this.traceMsgCache[t]=null}},{key:"getEventPriority",value:function getEventPriority(t,a){if("exceptions"===t){if(0===a.action)return"HIGH";if(2===a.action)return"HIGH";if(1===a.action&&0!==a.exception_service)return"HIGH"}else{if("msgReceive"===t)return"LOW";if("nim_api_trace"===t)return"LOW"}return"NORMAL"}},{key:"reportTraceCancel",value:function reportTraceCancel(t){this.reportConfig.isDataReportEnable&&(this.endedAsyncMsgByModule[t]=[],this.traceMsgCache[t]=null)}},{key:"pause",value:function pause(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!1)}},{key:"restore",value:function restore(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!0,this.initConfigLoaded||this.initUploadConfig())}},{key:"destroy",value:function destroy(){var t,c=this;this.reportConfig.isDataReportEnable&&(forEach$1(t=Ui(this.traceMsgCache)).call(t,(function(t){c.reportTraceEnd(t,1)})),null!==this.timer&&clearTimeout(this.timer),this.setConfig=a,this.report=a,this.reportTraceStart=a,this.reportTraceUpdate=a,this.reportTraceEnd=a,this.pause=a,this.restore=a,this.destroy=a,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.highPriorityMsgList=[],this.reportConfig={},this.isDestroyed=!0)}},{key:"initUploadConfig",value:function initUploadConfig(){var t,a,c=this;if(!this.loading){this.loading=!0;var _=this.reportConfig.common||{};try{this.reportConfig.request(this.reportConfig.reportConfigUrl,{method:"GET",dataType:"json",params:{deviceId:_.dev_id,sdkVer:_.sdk_ver,platform:_.platform,appkey:_.app_key},timeout:this.reportConfig.timeout}).then((function(t){var a,_;if(!c.isDestroyed){if(200===t.status&&t.data&&200===t.data.code){var h=t.data.data||{};c.reportConfig.maxSize=h.maxSize>1e3?1e3:h.maxSize,c.reportConfig.maxInterval=h.maxInterval>1e4?1e4:h.maxInterval,c.reportConfig.maxInterval=h.maxInterval<10?10:h.maxInterval,c.reportConfig.minInterval=h.minInterval<2?2:h.minInterval,c.reportConfig.maxDelay=h.maxDelay||300,c.reportConfig.maxInterval=1e3*c.reportConfig.maxInterval,c.reportConfig.minInterval=1e3*c.reportConfig.minInterval,c.reportConfig.maxDelay=1e3*c.reportConfig.maxDelay,c.isUploadEnable=!0,c.initConfigLoaded=!0,c.loading=!1,c.reportHeartBeat()}null===(_=null===(a=c.reportConfig)||void 0===a?void 0:a.logger)||void 0===_||_.log("Get reporter upload config success")}})).catch((function(t){var a,_;c.loading=!1,null===(_=null===(a=c.reportConfig)||void 0===a?void 0:a.logger)||void 0===_||_.error("Get reporter upload config failed",t)}))}catch(c){this.loading=!1,null===(a=null===(t=this.reportConfig)||void 0===t?void 0:t.logger)||void 0===a||a.error("Exec reporter request failed",c)}}}},{key:"reportHeartBeat",value:function reportHeartBeat(){var t=this;this.isDestroyed||(this.timer=hi((function(){t.reportHeartBeat()}),this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function doReport(){if(!this.isDestroyed){var t=this.highPriorityMsgList.length+this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;Zn()-this.lastReportTime>=t&&this.upload()}}},{key:"getUploadMsg",value:function getUploadMsg(){var t,a,c,_,h,m,g=this,E={},T=Zn();this.highPriorityMsgList=filter(t=this.highPriorityMsgList).call(t,(function(t){return T-t.createTime<g.reportConfig.maxDelay})),this.msgList=filter(a=this.msgList).call(a,(function(t){return T-t.createTime<g.reportConfig.maxDelay})),this.lowPriorityMsgList=filter(c=this.lowPriorityMsgList).call(c,(function(t){return T-t.createTime<g.reportConfig.maxDelay})),this.cacheMsgList=filter(_=this.cacheMsgList).call(_,(function(t){return T-t.createTime<g.reportConfig.maxDelay}));var I=slice$1(h=this.highPriorityMsgList).call(h,0,this.reportConfig.maxSize);if(this.highPriorityMsgList=slice$1(m=this.highPriorityMsgList).call(m,I.length),I.length<this.reportConfig.maxSize){var N,M,S=this.reportConfig.maxSize-I.length;I=concat(I).call(I,slice$1(N=this.msgList).call(N,0,S)),this.msgList=slice$1(M=this.msgList).call(M,S)}if(I.length<this.reportConfig.maxSize){var O,A,b=this.reportConfig.maxSize-I.length;I=concat(I).call(I,slice$1(O=this.lowPriorityMsgList).call(O,0,b)),this.lowPriorityMsgList=slice$1(A=this.lowPriorityMsgList).call(A,b)}if(I.length<this.reportConfig.maxSize){var R,C,P=this.reportConfig.maxSize-I.length;I=concat(I).call(I,slice$1(R=this.cacheMsgList).call(R,0,P)),this.cacheMsgList=slice$1(C=this.cacheMsgList).call(C,P)}return forEach$1(I).call(I,(function(t){E[t.module]?E[t.module].push(t.msg):E[t.module]=[t.msg]})),{uploadMsgArr:I,uploadMsg:E}}},{key:"upload",value:function upload(){var t,a,c=this;if(this.isUploadEnable&&!(this.lastReportTime&&Zn()-this.lastReportTime<this.reportConfig.minInterval)){var _=this.getUploadMsg(),h=_.uploadMsgArr,m=_.uploadMsg;if(h.length){this.lastReportTime=Zn();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:m},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch((function(t){var a,_,m,g;c.cacheMsgList=slice$1(a=concat(_=c.cacheMsgList).call(_,h)).call(a,0,c.reportConfig.cacheMaxSize),null===(g=null===(m=c.reportConfig)||void 0===m?void 0:m.logger)||void 0===g||g.warn("Reporter upload failed",t)}))}catch(c){null===(a=null===(t=this.reportConfig)||void 0===t?void 0:t.logger)||void 0===a||a.warn("Exec reporter request failed",c)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),Reporter}();return c}()})),Ji=Ti.map,Qi=arrayMethodHasSpeciesSupport("map");_export({target:"Array",proto:!0,forced:!Qi},{map:function map(t){return Ji(this,t,arguments.length>1?arguments[1]:void 0)}});var Xi=entryVirtual("Array").map,Zi=Array.prototype,map$6=function(t){var a=t.map;return t===Zi||H(Zi,t)&&a===Zi.map?Xi:a},ea="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",ta=A("".replace),ra="["+ea+"]",oa=RegExp("^"+ra+ra+"*"),na=RegExp(ra+ra+"*$"),createMethod$1=function(t){return function(a){var c=toString$1(requireObjectCoercible(a));return 1&t&&(c=ta(c,oa,"")),2&t&&(c=ta(c,na,"")),c}},ia={start:createMethod$1(1),end:createMethod$1(2),trim:createMethod$1(3)},aa=ia.trim,sa=h.parseInt,ca=h.Symbol,ua=ca&&ca.iterator,la=/^[+-]?0x/i,da=A(la.exec),fa=8!==sa(ea+"08")||22!==sa(ea+"0x16")||ua&&!fails((function(){sa(Object(ua))}))?function parseInt(t,a){var c=aa(toString$1(t));return sa(c,a>>>0||(da(la,c)?16:10))}:sa;_export({global:!0,forced:parseInt!=fa},{parseInt:fa});var pa=Y.parseInt,_a=Qe.indexOf,ha=A([].indexOf),ma=!!ha&&1/ha([1],1,-0)<0,ga=arrayMethodIsStrict("indexOf");_export({target:"Array",proto:!0,forced:ma||!ga},{indexOf:function indexOf(t){var a=arguments.length>1?arguments[1]:void 0;return ma?ha(this,t,a)||0:_a(this,t,a)}});var Ea=entryVirtual("Array").indexOf,va=Array.prototype,indexOf=function(t){var a=t.indexOf;return t===va||H(va,t)&&a===va.indexOf?Ea:a},ya=Math.min,Ta=[].lastIndexOf,Ia=!!Ta&&1/[1].lastIndexOf(1,-0)<0,Na=arrayMethodIsStrict("lastIndexOf"),Ma=Ia||!Na?function lastIndexOf(t){if(Ia)return I(Ta,this,arguments)||0;var a=toIndexedObject(this),c=lengthOfArrayLike(a),_=c-1;for(arguments.length>1&&(_=ya(_,toIntegerOrInfinity(arguments[1]))),_<0&&(_=c+_);_>=0;_--)if(_ in a&&a[_]===t)return _||0;return-1}:Ta;_export({target:"Array",proto:!0,forced:Ma!==[].lastIndexOf},{lastIndexOf:Ma});var Sa=entryVirtual("Array").lastIndexOf,Oa=Array.prototype,lastIndexOf=function(t){var a=t.lastIndexOf;return t===Oa||H(Oa,t)&&a===Oa.lastIndexOf?Sa:a},Aa=Ti.findIndex,ba="findIndex",Ra=!0;ba in[]&&Array(1).findIndex((function(){Ra=!1})),_export({target:"Array",proto:!0,forced:Ra},{findIndex:function findIndex(t){return Aa(this,t,arguments.length>1?arguments[1]:void 0)}});var Ca=entryVirtual("Array").findIndex,Pa=Array.prototype,findIndex=function(t){var a=t.findIndex;return t===Pa||H(Pa,t)&&a===Pa.findIndex?Ca:a},ka=Array,wa=Math.max,arraySliceSimple=function(t,a,c){for(var _=lengthOfArrayLike(t),h=toAbsoluteIndex(a,_),m=toAbsoluteIndex(void 0===c?_:c,_),g=ka(wa(m-h,0)),E=0;h<m;h++,E++)createProperty(g,E,t[h]);return g.length=E,g},xa=Vt.f,Da="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],La={f:function getOwnPropertyNames(t){return Da&&"Window"==classofRaw(t)?function(t){try{return xa(t)}catch(t){return arraySliceSimple(Da)}}(t):xa(toIndexedObject(t))}},Va=fails((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Ua=Object.isExtensible,Fa=fails((function(){Ua(1)}))||Va?function isExtensible(t){return!!B(t)&&((!Va||"ArrayBuffer"!=classofRaw(t))&&(!Ua||Ua(t)))}:Ua,Ga=!fails((function(){return Object.isExtensible(Object.preventExtensions({}))})),ja=createCommonjsModule((function(t){var a=Be.f,c=!1,_=uid("meta"),h=0,setMetadata=function(t){a(t,_,{value:{objectID:"O"+h++,weakData:{}}})},m=t.exports={enable:function(){m.enable=function(){},c=!0;var t=Vt.f,a=A([].splice),h={};h[_]=1,t(h).length&&(Vt.f=function(c){for(var h=t(c),m=0,g=h.length;m<g;m++)if(h[m]===_){a(h,m,1);break}return h},_export({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:La.f}))},fastKey:function(t,a){if(!B(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!de(t,_)){if(!Fa(t))return"F";if(!a)return"E";setMetadata(t)}return t[_].objectID},getWeakData:function(t,a){if(!de(t,_)){if(!Fa(t))return!0;if(!a)return!1;setMetadata(t)}return t[_].weakData},onFreeze:function(t){return Ga&&c&&Fa(t)&&!de(t,_)&&setMetadata(t),t}};Xe[_]=!0})),Ba=Be.f,Ya=Ti.forEach,Ha=Ar.set,Ka=Ar.getterFor,defineBuiltIns=function(t,a,c){for(var _ in a)c&&c.unsafe&&t[_]?t[_]=a[_]:defineBuiltIn(t,_,a[_],c);return t},Wa=Be.f,qa=ja.fastKey,za=Ar.set,$a=Ar.getterFor,Ja={getConstructor:function(t,a,c,_){var h=t((function(t,h){anInstance(t,m),za(t,{type:a,index:ct(null),first:void 0,last:void 0,size:0}),b||(t.size=0),isNullOrUndefined(h)||iterate(h,t[_],{that:t,AS_ENTRIES:c})})),m=h.prototype,g=$a(a),define=function(t,a,c){var _,h,m=g(t),E=getEntry(t,a);return E?E.value=c:(m.last=E={index:h=qa(a,!0),key:a,value:c,previous:_=m.last,next:void 0,removed:!1},m.first||(m.first=E),_&&(_.next=E),b?m.size++:t.size++,"F"!==h&&(m.index[h]=E)),t},getEntry=function(t,a){var c,_=g(t),h=qa(a);if("F"!==h)return _.index[h];for(c=_.first;c;c=c.next)if(c.key==a)return c};return defineBuiltIns(m,{clear:function clear(){for(var t=g(this),a=t.index,c=t.first;c;)c.removed=!0,c.previous&&(c.previous=c.previous.next=void 0),delete a[c.index],c=c.next;t.first=t.last=void 0,b?t.size=0:this.size=0},delete:function(t){var a=this,c=g(a),_=getEntry(a,t);if(_){var h=_.next,m=_.previous;delete c.index[_.index],_.removed=!0,m&&(m.next=h),h&&(h.previous=m),c.first==_&&(c.first=h),c.last==_&&(c.last=m),b?c.size--:a.size--}return!!_},forEach:function forEach(t){for(var a,c=g(this),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0);a=a?a.next:c.first;)for(_(a.value,a.key,this);a&&a.removed;)a=a.previous},has:function has(t){return!!getEntry(this,t)}}),defineBuiltIns(m,c?{get:function get(t){var a=getEntry(this,t);return a&&a.value},set:function set(t,a){return define(this,0===t?0:t,a)}}:{add:function add(t){return define(this,t=0===t?0:t,t)}}),b&&Wa(m,"size",{get:function(){return g(this).size}}),h},setStrong:function(t,a,c){var _=a+" Iterator",h=$a(a),m=$a(_);iteratorDefine(t,a,(function(t,a){za(this,{type:_,target:t,state:h(t),kind:a,last:void 0})}),(function(){for(var t=m(this),a=t.kind,c=t.last;c&&c.removed;)c=c.previous;return t.target&&(t.last=c=c?c.next:t.state.first)?"keys"==a?{value:c.key,done:!1}:"values"==a?{value:c.value,done:!1}:{value:[c.key,c.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),c?"entries":"values",!c,!0),setSpecies(a)}};!function(t,a,c){var _,m=-1!==t.indexOf("Map"),g=-1!==t.indexOf("Weak"),E=m?"set":"add",T=h[t],I=T&&T.prototype,N={};if(b&&isCallable(T)&&(g||I.forEach&&!fails((function(){(new T).entries().next()})))){var M=(_=a((function(a,c){Ha(anInstance(a,M),{type:t,collection:new T}),null!=c&&iterate(c,a[E],{that:a,AS_ENTRIES:m})}))).prototype,S=Ka(t);Ya(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(t){var a="add"==t||"set"==t;!(t in I)||g&&"clear"==t||Ye(M,t,(function(c,_){var h=S(this).collection;if(!a&&g&&!B(c))return"get"==t&&void 0;var m=h[t](0===c?0:c,_);return a?this:m}))})),g||Ba(M,"size",{configurable:!0,get:function(){return S(this).collection.size}})}else _=c.getConstructor(a,t,m,E),ja.enable();setToStringTag(_,t,!1,!0),N[t]=_,_export({global:!0,forced:!0},N),g||c.setStrong(_,t,m)}("Map",(function(t){return function Map(){return t(this,arguments.length?arguments[0]:void 0)}}),Ja);var Qa=Y.Map,Xa=[].push;_export({target:"Map",stat:!0,forced:!0},{from:function from(t){var a,c,_,h,m=arguments.length,g=m>1?arguments[1]:void 0;return aConstructor(this),(a=void 0!==g)&&aCallable(g),isNullOrUndefined(t)?new this:(c=[],a?(_=0,h=functionBindContext(g,m>2?arguments[2]:void 0),iterate(t,(function(t){C(Xa,c,h(t,_++))}))):iterate(t,Xa,{that:c}),new this(c))}});_export({target:"Map",stat:!0,forced:!0},{of:function of(){return new this(ht(arguments))}});_export({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function deleteAll(){for(var t,a=anObject(this),c=aCallable(a.delete),_=!0,h=0,m=arguments.length;h<m;h++)t=C(c,a,arguments[h]),_=_&&t;return!!_}});_export({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function emplace(t,a){var c,_,h=anObject(this),m=aCallable(h.get),g=aCallable(h.has),E=aCallable(h.set);return C(g,h,t)?(c=C(m,h,t),"update"in a&&(c=a.update(c,t,h),C(E,h,t,c)),c):(_=a.insert(t,h),C(E,h,t,_),_)}});var Za=getIterator;_export({target:"Map",proto:!0,real:!0,forced:!0},{every:function every(t){var a=anObject(this),c=Za(a),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0);return!iterate(c,(function(t,c,h){if(!_(c,t,a))return h()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_export({target:"Map",proto:!0,real:!0,forced:!0},{filter:function filter(t){var a=anObject(this),c=Za(a),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0),h=new(speciesConstructor(a,getBuiltIn("Map"))),m=aCallable(h.set);return iterate(c,(function(t,c){_(c,t,a)&&C(m,h,t,c)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),h}}),_export({target:"Map",proto:!0,real:!0,forced:!0},{find:function find(t){var a=anObject(this),c=Za(a),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0);return iterate(c,(function(t,c,h){if(_(c,t,a))return h(c)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_export({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function findKey(t){var a=anObject(this),c=Za(a),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0);return iterate(c,(function(t,c,h){if(_(c,t,a))return h(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var es=A([].push);_export({target:"Map",stat:!0,forced:!0},{groupBy:function groupBy(t,a){aCallable(a);var c=getIterator(t),_=new this,h=aCallable(_.has),m=aCallable(_.get),g=aCallable(_.set);return iterate(c,(function(t){var c=a(t);C(h,_,c)?es(C(m,_,c),t):C(g,_,c,[t])}),{IS_ITERATOR:!0}),_}});_export({target:"Map",proto:!0,real:!0,forced:!0},{includes:function includes(t){return iterate(Za(anObject(this)),(function(a,c,_){if((h=c)===(m=t)||h!=h&&m!=m)return _();var h,m}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_export({target:"Map",stat:!0,forced:!0},{keyBy:function keyBy(t,a){var c=new this;aCallable(a);var _=aCallable(c.set);return iterate(t,(function(t){C(_,c,a(t),t)})),c}}),_export({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function keyOf(t){return iterate(Za(anObject(this)),(function(a,c,_){if(c===t)return _(a)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_export({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function mapKeys(t){var a=anObject(this),c=Za(a),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0),h=new(speciesConstructor(a,getBuiltIn("Map"))),m=aCallable(h.set);return iterate(c,(function(t,c){C(m,h,_(c,t,a),c)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),h}}),_export({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function mapValues(t){var a=anObject(this),c=Za(a),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0),h=new(speciesConstructor(a,getBuiltIn("Map"))),m=aCallable(h.set);return iterate(c,(function(t,c){C(m,h,t,_(c,t,a))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),h}}),_export({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function merge(t){for(var a=anObject(this),c=aCallable(a.set),_=arguments.length,h=0;h<_;)iterate(arguments[h++],c,{that:a,AS_ENTRIES:!0});return a}});var ts=TypeError;_export({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function reduce(t){var a=anObject(this),c=Za(a),_=arguments.length<2,h=_?void 0:arguments[1];if(aCallable(t),iterate(c,(function(c,m){_?(_=!1,h=m):h=t(h,m,c,a)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),_)throw ts("Reduce of empty map with no initial value");return h}}),_export({target:"Map",proto:!0,real:!0,forced:!0},{some:function some(t){var a=anObject(this),c=Za(a),_=functionBindContext(t,arguments.length>1?arguments[1]:void 0);return iterate(c,(function(t,c,h){if(_(c,t,a))return h()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var rs=TypeError;_export({target:"Map",proto:!0,real:!0,forced:!0},{update:function update(t,a){var c=anObject(this),_=aCallable(c.get),h=aCallable(c.has),m=aCallable(c.set),g=arguments.length;aCallable(a);var E=C(h,c,t);if(!E&&g<3)throw rs("Updating absent value");var T=E?C(_,c,t):aCallable(g>2?arguments[2]:void 0)(t,c);return C(m,c,t,a(T,t,c)),c}});var os=TypeError,ns=function upsert(t,a){var c,_=anObject(this),h=aCallable(_.get),m=aCallable(_.has),g=aCallable(_.set),E=arguments.length>2?arguments[2]:void 0;if(!isCallable(a)&&!isCallable(E))throw os("At least one callback required");return C(m,_,t)?(c=C(h,_,t),isCallable(a)&&(c=a(c),C(g,_,t,c))):isCallable(E)&&(c=E(),C(g,_,t,c)),c};_export({target:"Map",proto:!0,real:!0,forced:!0},{upsert:ns}),_export({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:ns});var is=Qa,as=fails((function(){Dt(1)}));_export({target:"Object",stat:!0,forced:as,sham:!Pt},{getPrototypeOf:function getPrototypeOf(t){return Dt(toObject(t))}});var ss=Y.Object.getPrototypeOf,cs=createCommonjsModule((function(t){function _getPrototypeOf(a){var c;return t.exports=_getPrototypeOf=_t?bind$1(c=ss).call(c):function _getPrototypeOf(t){return t.__proto__||ss(t)},t.exports.__esModule=!0,t.exports.default=t.exports,_getPrototypeOf(a)}t.exports=_getPrototypeOf,t.exports.__esModule=!0,t.exports.default=t.exports})),us=createCommonjsModule((function(t){t.exports=function _isNativeFunction(t){var a;return-1!==indexOf(a=Function.toString.call(t)).call(a,"[native code]")},t.exports.__esModule=!0,t.exports.default=t.exports})),ls=getBuiltIn("Reflect","construct"),ds=Object.prototype,fs=[].push,ps=fails((function(){function F(){}return!(ls((function(){}),[],F)instanceof F)})),_s=!fails((function(){ls((function(){}))})),hs=ps||_s;_export({target:"Reflect",stat:!0,forced:hs,sham:hs},{construct:function construct(t,a){aConstructor(t),anObject(a);var c=arguments.length<3?t:aConstructor(arguments[2]);if(_s&&!ps)return ls(t,a,c);if(t==c){switch(a.length){case 0:return new t;case 1:return new t(a[0]);case 2:return new t(a[0],a[1]);case 3:return new t(a[0],a[1],a[2]);case 4:return new t(a[0],a[1],a[2],a[3])}var _=[null];return I(fs,_,a),new(I(yt,t,_))}var h=c.prototype,m=ct(B(h)?h:ds),g=I(t,m,a);return B(g)?g:m}});var ms=Y.Reflect.construct,gs=createCommonjsModule((function(t){t.exports=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!ms)return!1;if(ms.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(ms(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports})),Es=createCommonjsModule((function(t){function _construct(a,c,_){var h;gs()?(t.exports=_construct=bind$1(h=ms).call(h),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=_construct=function _construct(t,a,c){var _=[null];_.push.apply(_,a);var h=new(bind$1(Function).apply(t,_));return c&&Nt(h,c.prototype),h},t.exports.__esModule=!0,t.exports.default=t.exports);return _construct.apply(null,arguments)}t.exports=_construct,t.exports.__esModule=!0,t.exports.default=t.exports})),vs=createCommonjsModule((function(t){function _wrapNativeSuper(a){var c="function"==typeof is?new is:void 0;return t.exports=_wrapNativeSuper=function _wrapNativeSuper(t){if(null===t||!us(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==c){if(c.has(t))return c.get(t);c.set(t,Wrapper)}function Wrapper(){return Es(t,arguments,cs(this).constructor)}return Wrapper.prototype=lt(t.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),Nt(Wrapper,t)},t.exports.__esModule=!0,t.exports.default=t.exports,_wrapNativeSuper(a)}t.exports=_wrapNativeSuper,t.exports.__esModule=!0,t.exports.default=t.exports})),ys=getDefaultExportFromCjs(vs),Ts=getBuiltIn("JSON","stringify"),Is=A(/./.exec),Ns=A("".charAt),Ms=A("".charCodeAt),Ss=A("".replace),Os=A(1..toString),As=/[\uD800-\uDFFF]/g,bs=/^[\uD800-\uDBFF]$/,Rs=/^[\uDC00-\uDFFF]$/,Cs=!X||fails((function(){var t=getBuiltIn("Symbol")();return"[null]"!=Ts([t])||"{}"!=Ts({a:t})||"{}"!=Ts(Object(t))})),Ps=fails((function(){return'"\\udf06\\ud834"'!==Ts("\udf06\ud834")||'"\\udead"'!==Ts("\udead")})),stringifyWithSymbolsFix=function(t,a){var c=ht(arguments),_=a;if((B(a)||void 0!==t)&&!te(t))return ei(a)||(a=function(t,a){if(isCallable(_)&&(a=C(_,this,t,a)),!te(a))return a}),c[1]=a,I(Ts,null,c)},fixIllFormed=function(t,a,c){var _=Ns(c,a-1),h=Ns(c,a+1);return Is(bs,t)&&!Is(Rs,h)||Is(Rs,t)&&!Is(bs,_)?"\\u"+Os(Ms(t,0),16):t};Ts&&_export({target:"JSON",stat:!0,arity:3,forced:Cs||Ps},{stringify:function stringify(t,a,c){var _=ht(arguments),h=I(Cs?stringifyWithSymbolsFix:Ts,null,_);return Ps&&"string"==typeof h?Ss(h,As,fixIllFormed):h}}),Y.JSON||(Y.JSON={stringify:JSON.stringify});var ks=function stringify(t,a,c){return I(Y.JSON.stringify,null,arguments)},ws=ks,xs=TypeError,createMethod=function(t){return function(a,c,_,h){aCallable(c);var m=toObject(a),g=U(m),E=lengthOfArrayLike(m),T=t?E-1:0,I=t?-1:1;if(_<2)for(;;){if(T in g){h=g[T],T+=I;break}if(T+=I,t?T<0:E<=T)throw xs("Reduce of empty array with no initial value")}for(;t?T>=0:E>T;T+=I)T in g&&(h=c(h,g[T],T,m));return h}},Ds={left:createMethod(!1),right:createMethod(!0)}.left,Ls=arrayMethodIsStrict("reduce");_export({target:"Array",proto:!0,forced:!Ls||!$r&&Q>79&&Q<83},{reduce:function reduce(t){var a=arguments.length;return Ds(this,t,a,a>1?arguments[1]:void 0)}});var Vs,Us,Fs,Gs,js,Bs,Ys,Hs,Ks,Ws,qs,zs,$s,Js,Qs,Xs,Zs,ec,tc,rc,oc,nc,ic,ac,sc,cc,uc,lc,dc,fc,pc,_c,hc,mc,gc,Ec,vc,yc,Tc,Ic,Nc,Mc,Sc,Oc,Ac,bc,Rc,Cc,Pc=entryVirtual("Array").reduce,kc=Array.prototype,reduce=function(t){var a=t.reduce;return t===kc||H(kc,t)&&a===kc.reduce?Pc:a};!function(t){t[t.V2NIM_DATA_SYNC_TYPE_LEVEL_FULL=0]="V2NIM_DATA_SYNC_TYPE_LEVEL_FULL",t[t.V2NIM_DATA_SYNC_TYPE_LEVEL_BASIC=1]="V2NIM_DATA_SYNC_TYPE_LEVEL_BASIC"}(Vs||(Vs={})),function(t){t[t.V2NIM_DATA_SYNC_TYPE_MAIN=1]="V2NIM_DATA_SYNC_TYPE_MAIN",t[t.V2NIM_DATA_SYNC_TYPE_TEAM_MEMBER=2]="V2NIM_DATA_SYNC_TYPE_TEAM_MEMBER",t[t.V2NIM_DATA_SYNC_TYPE_SUPER_TEAM_MEMBER=3]="V2NIM_DATA_SYNC_TYPE_SUPER_TEAM_MEMBER"}(Us||(Us={})),function(t){t[t.V2NIM_DATA_SYNC_STATE_WAITING=1]="V2NIM_DATA_SYNC_STATE_WAITING",t[t.V2NIM_DATA_SYNC_STATE_SYNCING=2]="V2NIM_DATA_SYNC_STATE_SYNCING",t[t.V2NIM_DATA_SYNC_STATE_COMPLETED=3]="V2NIM_DATA_SYNC_STATE_COMPLETED"}(Fs||(Fs={})),function(t){t[t.V2NIM_CONVERSATION_TYPE_UNKNOWN=0]="V2NIM_CONVERSATION_TYPE_UNKNOWN",t[t.V2NIM_CONVERSATION_TYPE_P2P=1]="V2NIM_CONVERSATION_TYPE_P2P",t[t.V2NIM_CONVERSATION_TYPE_TEAM=2]="V2NIM_CONVERSATION_TYPE_TEAM",t[t.V2NIM_CONVERSATION_TYPE_SUPER_TEAM=3]="V2NIM_CONVERSATION_TYPE_SUPER_TEAM"}(Gs||(Gs={})),function(t){t[t.V2NIM_MESSAGE_STATUS_DEFAULT=0]="V2NIM_MESSAGE_STATUS_DEFAULT",t[t.V2NIM_MESSAGE_STATUS_REVOKE=1]="V2NIM_MESSAGE_STATUS_REVOKE",t[t.V2NIM_MESSAGE_STATUS_BACKFILL=2]="V2NIM_MESSAGE_STATUS_BACKFILL"}(js||(js={})),function(t){t[t.V2NIM_FRIEND_MODE_TYPE_ADD=1]="V2NIM_FRIEND_MODE_TYPE_ADD",t[t.V2NIM_FRIEND_MODE_TYPE_APPLY=2]="V2NIM_FRIEND_MODE_TYPE_APPLY"}(Bs||(Bs={})),function(t){t[t.V2NIM_FRIEND_ADD_APPLICATION_TYPE_RECEIVED=1]="V2NIM_FRIEND_ADD_APPLICATION_TYPE_RECEIVED",t[t.V2NIM_FRIEND_ADD_APPLICATION_TYPE_REJECTED=2]="V2NIM_FRIEND_ADD_APPLICATION_TYPE_REJECTED"}(Ys||(Ys={})),function(t){t[t.V2NIM_FRIEND_ADD_APPLICATION_STATUS_INIT=0]="V2NIM_FRIEND_ADD_APPLICATION_STATUS_INIT",t[t.V2NIM_FRIEND_ADD_APPLICATION_STATUS_AGREED=1]="V2NIM_FRIEND_ADD_APPLICATION_STATUS_AGREED",t[t.V2NIM_FRIEND_ADD_APPLICATION_STATUS_REJECTED=2]="V2NIM_FRIEND_ADD_APPLICATION_STATUS_REJECTED",t[t.V2NIM_FRIEND_ADD_APPLICATION_STATUS_EXPIRED=3]="V2NIM_FRIEND_ADD_APPLICATION_STATUS_EXPIRED",t[t.V2NIM_FRIEND_ADD_APPLICATION_STATUS_DIRECT_ADD=4]="V2NIM_FRIEND_ADD_APPLICATION_STATUS_DIRECT_ADD"}(Hs||(Hs={})),function(t){t[t.V2NIM_FRIEND_DELETION_TYPE_BY_SELF=1]="V2NIM_FRIEND_DELETION_TYPE_BY_SELF",t[t.V2NIM_FRIEND_DELETION_TYPE_BY_PEER=2]="V2NIM_FRIEND_DELETION_TYPE_BY_PEER"}(Ks||(Ks={})),function(t){t[t.V2NIM_FRIEND_VERIFY_TYPE_ADD=1]="V2NIM_FRIEND_VERIFY_TYPE_ADD",t[t.V2NIM_FRIEND_VERIFY_TYPE_APPLY=2]="V2NIM_FRIEND_VERIFY_TYPE_APPLY",t[t.V2NIM_FRIEND_VERIFY_TYPE_ACCEPT=3]="V2NIM_FRIEND_VERIFY_TYPE_ACCEPT",t[t.V2NIM_FRIEND_VERIFY_TYPE_REJECT=4]="V2NIM_FRIEND_VERIFY_TYPE_REJECT"}(Ws||(Ws={})),function(t){t[t.V2NIM_LOGIN_AUTH_TYPE_DEFAULT=0]="V2NIM_LOGIN_AUTH_TYPE_DEFAULT",t[t.V2NIM_LOGIN_AUTH_TYPE_DYNAMIC_TOKEN=1]="V2NIM_LOGIN_AUTH_TYPE_DYNAMIC_TOKEN",t[t.V2NIM_LOGIN_AUTH_TYPE_THIRD_PARTY=2]="V2NIM_LOGIN_AUTH_TYPE_THIRD_PARTY"}(qs||(qs={})),function(t){t[t.V2NIM_LOGIN_STATUS_LOGOUT=0]="V2NIM_LOGIN_STATUS_LOGOUT",t[t.V2NIM_LOGIN_STATUS_LOGINED=1]="V2NIM_LOGIN_STATUS_LOGINED",t[t.V2NIM_LOGIN_STATUS_LOGINING=2]="V2NIM_LOGIN_STATUS_LOGINING",t[t.V2NIM_LOGIN_STATUS_UNLOGIN=3]="V2NIM_LOGIN_STATUS_UNLOGIN"}(zs||(zs={})),function(t){t[t.V2NIM_LOGIN_CLIENT_TYPE_UNKNOWN=0]="V2NIM_LOGIN_CLIENT_TYPE_UNKNOWN",t[t.V2NIM_LOGIN_CLIENT_TYPE_ANDROID=1]="V2NIM_LOGIN_CLIENT_TYPE_ANDROID",t[t.V2NIM_LOGIN_CLIENT_TYPE_IOS=2]="V2NIM_LOGIN_CLIENT_TYPE_IOS",t[t.V2NIM_LOGIN_CLIENT_TYPE_PC=4]="V2NIM_LOGIN_CLIENT_TYPE_PC",t[t.V2NIM_LOGIN_CLIENT_TYPE_WP=8]="V2NIM_LOGIN_CLIENT_TYPE_WP",t[t.V2NIM_LOGIN_CLIENT_TYPE_WEB=16]="V2NIM_LOGIN_CLIENT_TYPE_WEB",t[t.V2NIM_LOGIN_CLIENT_TYPE_RESTFUL=32]="V2NIM_LOGIN_CLIENT_TYPE_RESTFUL",t[t.V2NIM_LOGIN_CLIENT_TYPE_MAC_OS=64]="V2NIM_LOGIN_CLIENT_TYPE_MAC_OS",t[t.V2NIM_LOGIN_CLIENT_TYPE_HARMONY_OS=65]="V2NIM_LOGIN_CLIENT_TYPE_HARMONY_OS"}($s||($s={})),function(t){t[t.V2NIM_KICKED_OFFLINE_REASON_CLIENT_EXCLUSIVE=1]="V2NIM_KICKED_OFFLINE_REASON_CLIENT_EXCLUSIVE",t[t.V2NIM_KICKED_OFFLINE_REASON_SERVER=2]="V2NIM_KICKED_OFFLINE_REASON_SERVER",t[t.V2NIM_KICKED_OFFLINE_REASON_CLIENT=3]="V2NIM_KICKED_OFFLINE_REASON_CLIENT",t[t.V2NIM_KICKED_OFFLINE_REASON_CLIENT_QUIETLY=4]="V2NIM_KICKED_OFFLINE_REASON_CLIENT_QUIETLY"}(Js||(Js={})),function(t){t[t.V2NIM_LOGIN_CLIENT_CHANGE_LIST=1]="V2NIM_LOGIN_CLIENT_CHANGE_LIST",t[t.V2NIM_LOGIN_CLIENT_CHANGE_LOGIN=2]="V2NIM_LOGIN_CLIENT_CHANGE_LOGIN",t[t.V2NIM_LOGIN_CLIENT_CHANGE_LOGOUT=3]="V2NIM_LOGIN_CLIENT_CHANGE_LOGOUT"}(Qs||(Qs={})),function(t){t[t.V2NIM_CONNECT_STATUS_DISCONNECTED=0]="V2NIM_CONNECT_STATUS_DISCONNECTED",t[t.V2NIM_CONNECT_STATUS_CONNECTED=1]="V2NIM_CONNECT_STATUS_CONNECTED",t[t.V2NIM_CONNECT_STATUS_CONNECTING=2]="V2NIM_CONNECT_STATUS_CONNECTING",t[t.V2NIM_CONNECT_STATUS_WAITING=3]="V2NIM_CONNECT_STATUS_WAITING"}(Xs||(Xs={})),function(t){t[t.V2NIM_MESSAGE_AI_STATUS_UNKNOW=0]="V2NIM_MESSAGE_AI_STATUS_UNKNOW",t[t.V2NIM_MESSAGE_AI_STATUS_AT=1]="V2NIM_MESSAGE_AI_STATUS_AT",t[t.V2NIM_MESSAGE_AI_STATUS_RESPONSE=2]="V2NIM_MESSAGE_AI_STATUS_RESPONSE"}(Zs||(Zs={})),function(t){t[t.V2NIM_MESSAGE_TYPE_INVALID=-1]="V2NIM_MESSAGE_TYPE_INVALID",t[t.V2NIM_MESSAGE_TYPE_TEXT=0]="V2NIM_MESSAGE_TYPE_TEXT",t[t.V2NIM_MESSAGE_TYPE_IMAGE=1]="V2NIM_MESSAGE_TYPE_IMAGE",t[t.V2NIM_MESSAGE_TYPE_AUDIO=2]="V2NIM_MESSAGE_TYPE_AUDIO",t[t.V2NIM_MESSAGE_TYPE_VIDEO=3]="V2NIM_MESSAGE_TYPE_VIDEO",t[t.V2NIM_MESSAGE_TYPE_LOCATION=4]="V2NIM_MESSAGE_TYPE_LOCATION",t[t.V2NIM_MESSAGE_TYPE_NOTIFICATION=5]="V2NIM_MESSAGE_TYPE_NOTIFICATION",t[t.V2NIM_MESSAGE_TYPE_FILE=6]="V2NIM_MESSAGE_TYPE_FILE",t[t.V2NIM_MESSAGE_TYPE_AVCHAT=7]="V2NIM_MESSAGE_TYPE_AVCHAT",t[t.V2NIM_MESSAGE_TYPE_TIPS=10]="V2NIM_MESSAGE_TYPE_TIPS",t[t.V2NIM_MESSAGE_TYPE_ROBOT=11]="V2NIM_MESSAGE_TYPE_ROBOT",t[t.V2NIM_MESSAGE_TYPE_CALL=12]="V2NIM_MESSAGE_TYPE_CALL",t[t.V2NIM_MESSAGE_TYPE_CUSTOM=100]="V2NIM_MESSAGE_TYPE_CUSTOM"}(ec||(ec={})),function(t){t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_UNDEFINED=-1]="V2NIM_MESSAGE_NOTIFICATION_TYPE_UNDEFINED",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_INVITE=0]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_INVITE",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_KICK=1]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_KICK",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_LEAVE=2]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_LEAVE",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_UPDATE_TINFO=3]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_UPDATE_TINFO",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_DISMISS=4]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_DISMISS",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_APPLY_PASS=5]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_APPLY_PASS",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_OWNER_TRANSFER=6]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_OWNER_TRANSFER",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_ADD_MANAGER=7]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_ADD_MANAGER",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_REMOVE_MANAGER=8]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_REMOVE_MANAGER",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_INVITE_ACCEPT=9]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_INVITE_ACCEPT",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_BANNED_TEAM_MEMBER=10]="V2NIM_MESSAGE_NOTIFICATION_TYPE_TEAM_BANNED_TEAM_MEMBER",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_INVITE=401]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_INVITE",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_KICK=402]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_KICK",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_LEAVE=403]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_LEAVE",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_UPDATE_TINFO=404]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_UPDATE_TINFO",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_DISMISS=405]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_DISMISS",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_APPLY_PASS=410]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_APPLY_PASS",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_OWNER_TRANSFER=406]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_OWNER_TRANSFER",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_ADD_MANAGER=407]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_ADD_MANAGER",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_REMOVE_MANAGER=408]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_REMOVE_MANAGER",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_INVITE_ACCEPT=411]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_INVITE_ACCEPT",t[t.V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_BANNED_TEAM_MEMBER=409]="V2NIM_MESSAGE_NOTIFICATION_TYPE_SUPER_TEAM_BANNED_TEAM_MEMBER"}(tc||(tc={})),function(t){t[t.V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_UNKNOWN=0]="V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_UNKNOWN",t[t.V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_SUCCESS=1]="V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_SUCCESS",t[t.V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_FAILED=2]="V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_FAILED",t[t.V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_UPLOADING=3]="V2NIM_MESSAGE_ATTACHMENT_UPLOAD_STATE_UPLOADING"}(rc||(rc={})),function(t){t[t.V2NIM_MESSAGE_SENDING_STATE_UNKNOWN=0]="V2NIM_MESSAGE_SENDING_STATE_UNKNOWN",t[t.V2NIM_MESSAGE_SENDING_STATE_SUCCEEDED=1]="V2NIM_MESSAGE_SENDING_STATE_SUCCEEDED",t[t.V2NIM_MESSAGE_SENDING_STATE_FAILED=2]="V2NIM_MESSAGE_SENDING_STATE_FAILED",t[t.V2NIM_MESSAGE_SENDING_STATE_SENDING=3]="V2NIM_MESSAGE_SENDING_STATE_SENDING"}(oc||(oc={})),function(t){t[t.V2NIM_QUERY_DIRECTION_DESC=0]="V2NIM_QUERY_DIRECTION_DESC",t[t.V2NIM_QUERY_DIRECTION_ASC=1]="V2NIM_QUERY_DIRECTION_ASC"}(nc||(nc={})),function(t){t[t.V2NIM_MESSAGE_REVOKE_TYPE_UNDEFINED=0]="V2NIM_MESSAGE_REVOKE_TYPE_UNDEFINED",t[t.V2NIM_MESSAGE_REVOKE_TYPE_P2P_BOTHWAY=1]="V2NIM_MESSAGE_REVOKE_TYPE_P2P_BOTHWAY",t[t.V2NIM_MESSAGE_REVOKE_TYPE_TEAM_BOTHWAY=2]="V2NIM_MESSAGE_REVOKE_TYPE_TEAM_BOTHWAY",t[t.V2NIM_MESSAGE_REVOKE_TYPE_SUPERTEAM_BOTHWAY=3]="V2NIM_MESSAGE_REVOKE_TYPE_SUPERTEAM_BOTHWAY",t[t.V2NIM_MESSAGE_REVOKE_TYPE_P2P_ONEWAY=4]="V2NIM_MESSAGE_REVOKE_TYPE_P2P_ONEWAY",t[t.V2NIM_MESSAGE_REVOKE_TYPE_TEAM_ONEWAY=5]="V2NIM_MESSAGE_REVOKE_TYPE_TEAM_ONEWAY"}(ic||(ic={})),function(t){t[t.V2NIM_MESSAGE_PIN_STATE_NOT_PINNED=0]="V2NIM_MESSAGE_PIN_STATE_NOT_PINNED",t[t.V2NIM_MESSAGE_PIN_STATE_PINNED=1]="V2NIM_MESSAGE_PIN_STATE_PINNED",t[t.V2NIM_MESSAGE_PIN_STATE_UPDATED=2]="V2NIM_MESSAGE_PIN_STATE_UPDATED"}(ac||(ac={})),function(t){t[t.V2NIM_QUICK_COMMENT_STATE_ADD=1]="V2NIM_QUICK_COMMENT_STATE_ADD",t[t.V2NIM_QUICK_COMMENT_STATE_REMOVE=2]="V2NIM_QUICK_COMMENT_STATE_REMOVE"}(sc||(sc={})),function(t){t[t.V2NIM_CLIENT_ANTISPAM_OPERATE_NONE=0]="V2NIM_CLIENT_ANTISPAM_OPERATE_NONE",t[t.V2NIM_CLIENT_ANTISPAM_OPERATE_REPLACE=1]="V2NIM_CLIENT_ANTISPAM_OPERATE_REPLACE",t[t.V2NIM_CLIENT_ANTISPAM_OPERATE_CLIENT_SHIELD=2]="V2NIM_CLIENT_ANTISPAM_OPERATE_CLIENT_SHIELD",t[t.V2NIM_CLIENT_ANTISPAM_OPERATE_SERVER_SHIELD=3]="V2NIM_CLIENT_ANTISPAM_OPERATE_SERVER_SHIELD"}(cc||(cc={})),function(t){t[t.V2NIM_SORT_ORDER_DESC=0]="V2NIM_SORT_ORDER_DESC",t[t.V2NIM_SORT_ORDER_ASC=1]="V2NIM_SORT_ORDER_ASC"}(uc||(uc={})),function(t){t[t.P2P_DELETE_MSG=7]="P2P_DELETE_MSG",t[t.TEAM_DELETE_MSG=8]="TEAM_DELETE_MSG",t[t.SUPERTEAM_DELETE_MSG=12]="SUPERTEAM_DELETE_MSG",t[t.P2P_ONE_WAY_DELETE_MSG=13]="P2P_ONE_WAY_DELETE_MSG",t[t.TEAM_ONE_WAY_DELETE_MSG=14]="TEAM_ONE_WAY_DELETE_MSG",t[t.CUSTOM_P2P_MSG=100]="CUSTOM_P2P_MSG",t[t.CUSTOM_TEAM_MSG=101]="CUSTOM_TEAM_MSG",t[t.CUSTOM_SUPERTEAM_MSG=103]="CUSTOM_SUPERTEAM_MSG"}(lc||(lc={})),function(t){t[t.V2NIM_TEAM_MESSAGE_MUTE_MODE_OFF=0]="V2NIM_TEAM_MESSAGE_MUTE_MODE_OFF",t[t.V2NIM_TEAM_MESSAGE_MUTE_MODE_ON=1]="V2NIM_TEAM_MESSAGE_MUTE_MODE_ON",t[t.V2NIM_TEAM_MESSAGE_MUTE_MODE_NORMAL_ON=2]="V2NIM_TEAM_MESSAGE_MUTE_MODE_NORMAL_ON"}(dc||(dc={})),function(t){t[t.V2NIM_P2P_MESSAGE_MUTE_MODE_OFF=0]="V2NIM_P2P_MESSAGE_MUTE_MODE_OFF",t[t.V2NIM_P2P_MESSAGE_MUTE_MODE_ON=1]="V2NIM_P2P_MESSAGE_MUTE_MODE_ON"}(fc||(fc={})),function(t){t[t.V2NIM_TEAM_MEMBER_ROLE_QUERY_TYPE_ALL=0]="V2NIM_TEAM_MEMBER_ROLE_QUERY_TYPE_ALL",t[t.V2NIM_TEAM_MEMBER_ROLE_QUERY_TYPE_NORMAL=1]="V2NIM_TEAM_MEMBER_ROLE_QUERY_TYPE_NORMAL",t[t.V2NIM_TEAM_MEMBER_ROLE_QUERY_TYPE_MANAGER=2]="V2NIM_TEAM_MEMBER_ROLE_QUERY_TYPE_MANAGER"}(pc||(pc={})),function(t){t[t.V2NIM_TEAM_TYPE_INVALID=0]="V2NIM_TEAM_TYPE_INVALID",t[t.V2NIM_TEAM_TYPE_ADVANCED=1]="V2NIM_TEAM_TYPE_ADVANCED",t[t.V2NIM_TEAM_TYPE_SUPER=2]="V2NIM_TEAM_TYPE_SUPER"}(_c||(_c={})),function(t){t[t.V2NIM_TEAM_JOIN_MODE_FREE=0]="V2NIM_TEAM_JOIN_MODE_FREE",t[t.V2NIM_TEAM_JOIN_MODE_APPLY=1]="V2NIM_TEAM_JOIN_MODE_APPLY",t[t.V2NIM_TEAM_JOIN_MODE_INVITE=2]="V2NIM_TEAM_JOIN_MODE_INVITE"}(hc||(hc={})),function(t){t[t.V2NIM_TEAM_AGREE_MODE_AUTH=0]="V2NIM_TEAM_AGREE_MODE_AUTH",t[t.V2NIM_TEAM_AGREE_MODE_NO_AUTH=1]="V2NIM_TEAM_AGREE_MODE_NO_AUTH"}(mc||(mc={})),function(t){t[t.V2NIM_TEAM_INVITE_MODE_MANAGER=0]="V2NIM_TEAM_INVITE_MODE_MANAGER",t[t.V2NIM_TEAM_INVITE_MODE_ALL=1]="V2NIM_TEAM_INVITE_MODE_ALL"}(gc||(gc={})),function(t){t[t.V2NIM_TEAM_UPDATE_INFO_MODE_MANAGER=0]="V2NIM_TEAM_UPDATE_INFO_MODE_MANAGER",t[t.V2NIM_TEAM_UPDATE_INFO_MODE_ALL=1]="V2NIM_TEAM_UPDATE_INFO_MODE_ALL"}(Ec||(Ec={})),function(t){t[t.V2NIM_TEAM_CHAT_BANNED_MODE_UNBAN=0]="V2NIM_TEAM_CHAT_BANNED_MODE_UNBAN",t[t.V2NIM_TEAM_CHAT_BANNED_MODE_BANNED_NORMAL=1]="V2NIM_TEAM_CHAT_BANNED_MODE_BANNED_NORMAL",t[t.V2NIM_TEAM_CHAT_BANNED_MODE_BANNED_ALL=2]="V2NIM_TEAM_CHAT_BANNED_MODE_BANNED_ALL"}(vc||(vc={})),function(t){t[t.V2NIM_TEAM_UPDATE_EXTENSION_MODE_MANAGER=0]="V2NIM_TEAM_UPDATE_EXTENSION_MODE_MANAGER",t[t.V2NIM_TEAM_UPDATE_EXTENSION_MODE_ALL=1]="V2NIM_TEAM_UPDATE_EXTENSION_MODE_ALL"}(yc||(yc={})),function(t){t[t.V2NIM_TEAM_MESSAGE_NOTIFY_MODE_ALL=0]="V2NIM_TEAM_MESSAGE_NOTIFY_MODE_ALL",t[t.V2NIM_TEAM_MESSAGE_NOTIFY_MODE_MANAGER=1]="V2NIM_TEAM_MESSAGE_NOTIFY_MODE_MANAGER",t[t.V2NIM_TEAM_MESSAGE_NOTIFY_MODE_CLOSE=2]="V2NIM_TEAM_MESSAGE_NOTIFY_MODE_CLOSE"}(Tc||(Tc={})),function(t){t[t.V2NIM_TEAM_MEMBER_ROLE_NORMAL=0]="V2NIM_TEAM_MEMBER_ROLE_NORMAL",t[t.V2NIM_TEAM_MEMBER_ROLE_OWNER=1]="V2NIM_TEAM_MEMBER_ROLE_OWNER",t[t.V2NIM_TEAM_MEMBER_ROLE_MANAGER=2]="V2NIM_TEAM_MEMBER_ROLE_MANAGER"}(Ic||(Ic={})),function(t){t[t.V2NIM_TEAM_JOIN_ACTION_TYPE_APPLICATION=0]="V2NIM_TEAM_JOIN_ACTION_TYPE_APPLICATION",t[t.V2NIM_TEAM_JOIN_ACTION_TYPE_REJECT_APPLICATION=1]="V2NIM_TEAM_JOIN_ACTION_TYPE_REJECT_APPLICATION",t[t.V2NIM_TEAM_JOIN_ACTION_TYPE_INVITATION=2]="V2NIM_TEAM_JOIN_ACTION_TYPE_INVITATION",t[t.V2NIM_TEAM_JOIN_ACTION_TYPE_REJECT_INVITATION=3]="V2NIM_TEAM_JOIN_ACTION_TYPE_REJECT_INVITATION"}(Nc||(Nc={})),function(t){t[t.V2NIM_TEAM_JOIN_ACTION_STATUS_INIT=0]="V2NIM_TEAM_JOIN_ACTION_STATUS_INIT",t[t.V2NIM_TEAM_JOIN_ACTION_STATUS_AGREED=1]="V2NIM_TEAM_JOIN_ACTION_STATUS_AGREED",t[t.V2NIM_TEAM_JOIN_ACTION_STATUS_REJECTED=2]="V2NIM_TEAM_JOIN_ACTION_STATUS_REJECTED",t[t.V2NIM_TEAM_JOIN_ACTION_STATUS_EXPIRED=3]="V2NIM_TEAM_JOIN_ACTION_STATUS_EXPIRED"}(Mc||(Mc={})),function(t){t[t.teamApply=0]="teamApply",t[t.teamApplyReject=1]="teamApplyReject",t[t.teamInvite=2]="teamInvite",t[t.teamInviteReject=3]="teamInviteReject",t[t.tlistUpdate=4]="tlistUpdate",t[t.superTeamApply=15]="superTeamApply",t[t.superTeamApplyReject=16]="superTeamApplyReject",t[t.superTeamInvite=17]="superTeamInvite",t[t.superTeamInviteReject=18]="superTeamInviteReject"}(Sc||(Sc={})),function(t){t[t.V2NIM_AI_MODEL_TYPE_UNKNOW=0]="V2NIM_AI_MODEL_TYPE_UNKNOW",t[t.V2NIM_AI_MODEL_TYPE_QWEN=1]="V2NIM_AI_MODEL_TYPE_QWEN",t[t.V2NIM_AI_MODEL_TYPE_AZURE=2]="V2NIM_AI_MODEL_TYPE_AZURE",t[t.V2NIM_AI_MODEL_TYPE_PRIVATE=3]="V2NIM_AI_MODEL_TYPE_PRIVATE"}(Oc||(Oc={})),function(t){t.V2NIM_AI_MODEL_ROLE_TYPE_SYSTEM="system",t.V2NIM_AI_MODEL_ROLE_TYPE_USER="user",t.V2NIM_AI_MODEL_ROLE_TYPE_ASSISTANT="assistant"}(Ac||(Ac={})),function(t){t[t.V2NIM_SIGNALLING_EVENT_TYPE_UNKNOWN=0]="V2NIM_SIGNALLING_EVENT_TYPE_UNKNOWN",t[t.V2NIM_SIGNALLING_EVENT_TYPE_CLOSE=1]="V2NIM_SIGNALLING_EVENT_TYPE_CLOSE",t[t.V2NIM_SIGNALLING_EVENT_TYPE_JOIN=2]="V2NIM_SIGNALLING_EVENT_TYPE_JOIN",t[t.V2NIM_SIGNALLING_EVENT_TYPE_INVITE=3]="V2NIM_SIGNALLING_EVENT_TYPE_INVITE",t[t.V2NIM_SIGNALLING_EVENT_TYPE_CANCEL_INVITE=4]="V2NIM_SIGNALLING_EVENT_TYPE_CANCEL_INVITE",t[t.V2NIM_SIGNALLING_EVENT_TYPE_REJECT=5]="V2NIM_SIGNALLING_EVENT_TYPE_REJECT",t[t.V2NIM_SIGNALLING_EVENT_TYPE_ACCEPT=6]="V2NIM_SIGNALLING_EVENT_TYPE_ACCEPT",t[t.V2NIM_SIGNALLING_EVENT_TYPE_LEAVE=7]="V2NIM_SIGNALLING_EVENT_TYPE_LEAVE",t[t.V2NIM_SIGNALLING_EVENT_TYPE_CONTROL=8]="V2NIM_SIGNALLING_EVENT_TYPE_CONTROL"}(bc||(bc={})),function(t){t[t.V2NIM_SIGNALLING_CHANNEL_TYPE_AUDIO=1]="V2NIM_SIGNALLING_CHANNEL_TYPE_AUDIO",t[t.V2NIM_SIGNALLING_CHANNEL_TYPE_VIDEO=2]="V2NIM_SIGNALLING_CHANNEL_TYPE_VIDEO",t[t.V2NIM_SIGNALLING_CHANNEL_TYPE_CUSTOM=3]="V2NIM_SIGNALLING_CHANNEL_TYPE_CUSTOM"}(Rc||(Rc={})),function(t){t[t.V2NIM_USER_STATUS_TYPE_UNKNOWN=0]="V2NIM_USER_STATUS_TYPE_UNKNOWN",t[t.V2NIM_USER_STATUS_TYPE_LOGIN=1]="V2NIM_USER_STATUS_TYPE_LOGIN",t[t.V2NIM_USER_STATUS_TYPE_LOGOUT=2]="V2NIM_USER_STATUS_TYPE_LOGOUT",t[t.V2NIM_USER_STATUS_TYPE_DISCONNECT=3]="V2NIM_USER_STATUS_TYPE_DISCONNECT"}(Cc||(Cc={}));var wc={V2NIM_ERROR_CODE_UNKNOWN:{code:0,message:"unknown error"},V2NIM_ERROR_CODE_SUCCESS:{code:200,message:"success"},V2NIM_ERROR_CODE_HANDSHAKE:{code:201,message:"handshake error"},V2NIM_ERROR_CODE_REQUEST_TEMPERARY_FORBIDDEN:{code:398,message:"request temprary forbidden"},V2NIM_ERROR_CODE_SERVER_UNIT_ERROR:{code:399,message:"server unit error"},V2NIM_ERROR_CODE_FORBIDDEN:{code:403,message:"forbidden"},V2NIM_ERROR_CODE_NOT_FOUND:{code:404,message:"not found"},V2NIM_ERROR_CODE_PARAMETER_ERROR:{code:414,message:"parameter error"},V2NIM_ERROR_CODE_RATE_LIMIT_REACHED:{code:416,message:"rate limit reached"},V2NIM_ERROR_CODE_MULTI_LOGIN_FORBIDDEN:{code:417,message:"multi login forbidden"},V2NIM_ERROR_CODE_SERVER_INTERNAL_ERROR:{code:500,message:"server internal error"},V2NIM_ERROR_CODE_SERVER_BUSY:{code:503,message:"server busy"},V2NIM_ERROR_CODE_APP_UNREACHABLE:{code:511,message:"app server unreachable"},V2NIM_ERROR_CODE_SERVICE_UNAVAILABLE:{code:514,message:"service unavailable"},V2NIM_ERROR_CODE_PROTOCOL_BLACKHOLE_FILTERED:{code:599,message:"protocol filtered by blackhole rule"},V2NIM_ERROR_CODE_NO_PERMISSION:{code:997,message:"appid has no permission to call the protocol"},V2NIM_ERROR_CODE_UNPACK_ERROR:{code:998,message:"unpack error"},V2NIM_ERROR_CODE_PACK_ERROR:{code:999,message:"pack error"},V2NIM_ERROR_CODE_IM_DISABLED:{code:101301,message:"IM disabled"},V2NIM_ERROR_CODE_SERVICE_ADDRESS_INVALID:{code:101302,message:"service address invalid"},V2NIM_ERROR_CODE_APPKEY_NOT_EXIST:{code:101303,message:"appkey not exist"},V2NIM_ERROR_CODE_BUNDLEID_CHECK_FAILED:{code:101304,message:"bundleid check failed"},V2NIM_ERROR_CODE_APPKEY_BLOCKED:{code:101403,message:"appkey blocked"},V2NIM_ERROR_CODE_INVALID_TOKEN:{code:102302,message:"invalid token"},V2NIM_ERROR_CODE_ROBOT_NOT_ALLOWED:{code:102303,message:"robot not allowed"},V2NIM_ERROR_CODE_ACCOUNT_NOT_EXIST:{code:102404,message:"account not exist"},V2NIM_ERROR_CODE_ACCOUNT_CHAT_BANNED:{code:102421,message:"account chat banned"},V2NIM_ERROR_CODE_ACCOUNT_BANNED:{code:102422,message:"account banned"},V2NIM_ERROR_CODE_ACCOUNT_IN_BLOCK_LIST:{code:102426,message:"account in block list"},V2NIM_ERROR_CODE_USER_PROFILE_NOT_EXIST:{code:103404,message:"user profile not exist"},V2NIM_ERROR_CODE_USER_PROFILE_HIT_ANTISPAM:{code:103451,message:"user profile hit antispam"},V2NIM_ERROR_CODE_PEER_FRIEND_LIMIT:{code:104301,message:"peer friend limit"},V2NIM_ERROR_CODE_FRIEND_APPLICATION_NOT_EXIST:{code:104302,message:"friend application not exist"},V2NIM_ERROR_CODE_FRIEND_NOT_EXIST:{code:104404,message:"friend not exist"},V2NIM_ERROR_CODE_FRIEND_ALREADY_EXIST:{code:104405,message:"friend already exist"},V2NIM_ERROR_CODE_SELF_FRIEND_OPERATION_NOT_ALLOWED:{code:104429,message:"self friend operation not allowed"},V2NIM_ERROR_CODE_FRIEND_LIMIT:{code:104435,message:"friend limit"},V2NIM_ERROR_CODE_FRIEND_OPERATION_RATE_LIMIT:{code:104449,message:"friend operation rate limit"},V2NIM_ERROR_CODE_FRIEND_HIT_ANTISPAM:{code:104451,message:"friend hit antispam"},V2NIM_ERROR_CODE_SELF_MUTE_OPERATION_NOT_ALLOWED:{code:105429,message:"self mute operation not allowed"},V2NIM_ERROR_CODE_MUTE_LIST_LIMIT:{code:105435,message:"mute list limit"},V2NIM_ERROR_CODE_SELF_BLOCK_LIST_OPERATION_NOT_ALLOWED:{code:106429,message:"self block list operation not allowed"},V2NIM_ERROR_CODE_BLOCK_LIST_LIMIT:{code:106435,message:"block list limit"},V2NIM_ERROR_CODE_REVOKE_THIRD_PARTY_MESSAGE_NOT_ALLOWED:{code:107301,message:"revoke third party message not allowed"},V2NIM_ERROR_CODE_SHORT_TO_LONG_URL_FAILED:{code:107307,message:"short to long URL failed"},V2NIM_ERROR_CODE_URL_INVALID:{code:107308,message:"URL invalid"},V2NIM_ERROR_CODE_DURATION_OUT_OF_RANGE:{code:107309,message:"duration out of range"},V2NIM_ERROR_CODE_GET_FILE_META_INFO_FAILED:{code:107310,message:"get file meta info failed"},V2NIM_ERROR_CODE_AUDIO_FILE_SIZE_LIMIT:{code:107311,message:"audio file size limit"},V2NIM_ERROR_CODE_VOICE_TO_TEXT_TIMEOUT:{code:107312,message:"voice to text timeout"},V2NIM_ERROR_CODE_VOICE_TO_TEXT_FAILED:{code:107313,message:"voice to text failed"},V2NIM_ERROR_CODE_REVOKE_EXCEED_TIME_LIMIT:{code:107314,message:"revoke message exceed time limit"},V2NIM_ERROR_CODE_REVOKE_MESSAGE_NOT_ALLOWED:{code:107315,message:"revoke specific message not allowed"},V2NIM_ERROR_CODE_FORCE_PUSH_LIST_LIMIT:{code:107316,message:"force push list limit"},V2NIM_ERROR_CODE_TEAM_MESSAGE_RECEIPT_RATE_LIMIT:{code:107317,message:"team message receipt rate limit"},V2NIM_ERROR_CODE_SNAPSHOT_NOT_EXIST:{code:107318,message:"snapshot not exist"},V2NIM_ERROR_CODE_PIN_LIMIT:{code:107319,message:"pin limit"},V2NIM_ERROR_CODE_PIN_NOT_EXIST:{code:107320,message:"pin not exist"},V2NIM_ERROR_CODE_QUICK_COMMENT_LIMIT:{code:107321,message:"quick comment limit"},V2NIM_ERROR_CODE_PIN_ALREADY_EXIST:{code:107322,message:"pin already exist"},V2NIM_ERROR_CODE_VOICE_TO_TEXT_FUNCTION_DISABLED:{code:107333,message:"voice to text function disabled"},V2NIM_ERROR_CODE_CLOUD_SEARCH_FUNCTION_DISABLED:{code:107334,message:"cloud search function disabled"},V2NIM_ERROR_CODE_ONE_WAY_DELETE_FUNCTION_DISABLED:{code:107335,message:"one-way delete function disabled"},V2NIM_ERRPR_CODE_ONEWAY_DELETION_NOT_ALLOW_FOR_TARGET_MESSAGES:{code:107338,message:"one-way deletion is not allowed for target messages"},V2NIM_ERRPR_CODE_SENDER_CANNOT_INCLUDED_IN_TARGET_LIST:{code:107339,message:"The message sender cannot be included in the target list"},V2NIM_ERROR_CODE_ROBOT_CANNOT_SEND_TARGET_MESSAGE:{code:107340,message:"Robot can not send target message"},V2NIM_ERROR_CODE_PIN_TARGET_MESSAGE_NOT_ALLOWED:{code:107345,message:"Pin target message is not allowed"},V2NIM_ERROR_CODE_TARGET_MESSAGE_NOT_ALLOWED_REPLY:{code:107346,message:"Target message not allowed reply"},V2NIM_ERROR_CODE_TARGET_MESSAGE_NOT_ALLOWED_QUICK_COMMENT:{code:107347,message:"Target message not allowed quick comment"},V2NIM_ERROR_CODE_REVOKE_MESSAGE_TO_SELF_NOT_ALLOWED:{code:107429,message:"revoke message to self not allowed"},V2NIM_ERROR_CODE_APP_CHAT_BANNED:{code:107410,message:"app chat banned"},V2NIM_ERROR_CODE_QUICK_COMMENT_FUNCTION_DISABLED:{code:107326,message:"quick comment function disabled"},V2NIM_ERROR_CODE_PIN_FUNCTION_DISABLED:{code:107327,message:"PIN function disabled"},V2NIM_ERROR_CODE_TEAM_READ_RECEIPT_FUNCTION_DISABLED:{code:107324,message:"read receipt for team messages function disabled"},V2NIM_ERROR_CODE_P2P_READ_RECEIPT_FUNCTION_DISABLED:{code:107325,message:"read receipt for p2p messages function disabled"},V2NIM_ERROR_CODE_RATE_LIMIT_FOR_MESSAGING_REACHED:{code:107323,message:"rate limit for messaging reached"},V2NIM_ERROR_CODE_MESSAGE_HIT_ANTISPAM:{code:107451,message:"message hit antispam"},V2NIM_ERROR_CODE_MESSAGE_NOT_EXIST:{code:107404,message:"message not exist"},V2NIM_ERROR_CODE_UNSENDING_MESSAGE_EXPIRED:{code:107406,message:"unsending message expired"},V2NIM_ERROR_CODE_TEAM_MARK_READ_FAILED:{code:107302,message:"sending message failed for marking message read failed for too many team members"},V2NIM_ERROR_CODE_SENDER_OR_MANAGER_PERMISSION_ONLY_REVOKE:{code:107303,message:"only sender or manager can revoke message"},V2NIM_ERROR_CODE_DELETE_SELF_MESSAGE_NOT_ALLOWED:{code:107328,message:"delete self message not allowed"},V2NIM_ERROR_CODE_NOT_CHATBOT_ACCOUNT:{code:107329,message:"is not chatbot account"},V2NIM_ERROR_CODE_MESSAGE_SENSE_REQUIRED:{code:107330,message:"sender or receiver must sense message"},V2NIM_ERROR_CODE_HIGH_PRIORITY_MESSAGE_RATE_LIMIT:{code:107304,message:"rate limit of high-priority messages exceeded"},ACK_MESSAGE_BE_HIGH_PRIORITY:{code:107305,message:"ack message should be high-priority"},V2NIM_ERROR_CODE_DUPLICATE_CLIENT_MESSAGE_ID:{code:107306,message:"duplicate client message ID"},V2NIM_ERROR_CODE_INVALID_TIME_RANGE:{code:107439,message:"invalid time range"},V2NIM_ERROR_CODE_NOT_ADVANCED_TEAM:{code:108302,message:"not advanced team"},V2NIM_ERROR_CODE_TEAM_MANAGER_LIMIT:{code:108303,message:"team manager limit"},V2NIM_ERROR_CODE_JOINED_TEAM_LIMIT:{code:108305,message:"joined team limit"},V2NIM_ERROR_CODE_TEAM_NORMAL_MEMBER_CHAT_BANNED:{code:108306,message:"team normal member chat banned"},V2NIM_ERROR_CODE_INVITED_ACCOUNT_NOT_FRIEND:{code:108307,message:"invited account not friend"},V2NIM_ERROR_CODE_REJECT_ALL_TEAM_APPLICATIONS:{code:108308,message:"reject all team applications"},V2NIM_ERROR_CODE_TARGETING_MESSAGE_FOR_TEAM_DISABLED:{code:108318,message:"Targeting messages for group chat is disabled"},V2NIM_ERROR_CODE_INCLUSIVE_AS_FALSE_NOT_ALLOWED_FOR_SUPER_TEAM:{code:108319,message:'Setting "inclusive" to false for super teams is not allowed'},V2NIM_ERROR_CODE_CANNOT_MAKE_SUPER_TEAM_MESSAGE_VISIBLE_TO_NEW_MEMBERS:{code:108320,message:"Cannot make super team targeted messages visible to new members"},V2NIM_ERROR_CODE_CANNOT_ALLOW_TARGETED_MESSAGES_INCLUSIVE_TO_NEW_MEMBERS:{code:108321,message:"Cannot allow targeted messages inclusive to new members"},V2NIM_ERROR_CODE_TEAM_NOT_EXIST:{code:108404,message:"team not exist"},V2NIM_ERROR_CODE_TEAM_ALREADY_CHAT_BANNED:{code:108420,message:"team already chat banned"},V2NIM_ERROR_CODE_ALL_TEAM_MEMBER_CHAT_BANNED:{code:108423,message:"all team member chat banned"},V2NIM_ERROR_CODE_EXTENDED_SUPER_TEAM_LIMIT:{code:108434,message:"extended super team limit"},V2NIM_ERROR_CODE_CREATED_TEAM_LIMIT:{code:108435,message:"created team limit"},V2NIM_ERROR_CODE_TEAM_INVITATION_LIMIT:{code:108437,message:"team invitation limit"},V2NIM_ERROR_CODE_TEAM_HIT_ANTISPAM:{code:108451,message:"team hit antispam"},V2NIM_ERROR_CODE_EXTENDED_SUPER_TEAM_LIMIT_NOT_CONFIGURED:{code:108304,message:"extended super team limit not configured"},V2NIM_ERROR_CODE_SUPER_TEAM_SERVICE_DISABLED:{code:108311,message:"super team service disabled"},V2NIM_ERROR_CODE_TEAM_READ_RECEIPT_RECORD_NOT_FOUND:{code:108301,message:"read receipt record for the team message not found"},V2NIM_ERROR_CODE_NOT_MANAGER:{code:108430,message:"unable to assign owner manager"},V2NIM_ERROR_CODE_ONLINE_MEMBER_COUNT_DISABLED:{code:108406,message:"number of online users service disabled"},V2NIM_ERROR_CODE_TRANSFER_DISABLED:{code:108310,message:"unable to transfer the ownership to owner"},V2NIM_ERROR_CODE_CREATE_TEAM_DISABLED:{code:108309,message:"unable to create team with more than %s people"},V2NIM_ERROR_CODE_EXTENDED_SUPER_TEAM_CREATE_FAILED:{code:108313,message:"/ extended super team creation failedï¼use open api to create the team"},V2NIM_ERROR_CODE_TEAM_MESSAGE_READ_RECEIPT_DISABLED:{code:108312,message:"read receipt for team messages function disabled"},V2NIM_ERROR_CODE_RETRY:{code:108449,message:"an error occurred, try again"},V2NIM_ERROR_CODE_CHAT_BAN_LIST_CONTAIN_NOT_TEAM_MEMBER:{code:109301,message:"list of chat banned users contains non team members"},V2NIM_ERROR_CODE_CHAT_BAN_LIST_CONTAIN_OPERATOR:{code:109303,message:"list of chat banned users contains the operator"},V2NIM_ERROR_CODE_CHAT_BAN_LIST_CONTAIN_TEAM_OWNER:{code:109304,message:"list of chat banned users contains the team owner"},V2NIM_ERROR_CODE_OPERATION_ON_TEAM_MANAGER_NOT_ALLOWED:{code:109305,message:"operation on team manager not allowed"},V2NIM_ERROR_CODE_NO_TEAM_INVITE_PERMISSION:{code:109306,message:"no team invite permission"},V2NIM_ERROR_CODE_TEAM_OWNER_QUIT_NOT_ALLOWED:{code:109307,message:"team owner quit not allowed"},V2NIM_ERROR_CODE_TEAM_OWNER_IN_KICK_LIST:{code:109308,message:"list of kicked user contains the team owner"},V2NIM_ERROR_CODE_INVITE_ROBOT_ACCOUNT_NOT_ALLOWED:{code:109309,message:"invite robot account not allowed"},V2NIM_ERROR_CODE_KICK_OPERATOR_NOT_ALLOWED:{code:109310,message:"kick operator not allowed"},V2NIM_ERROR_CODE_TEAM_MEMBER_ALREADY_EXIST:{code:109311,message:"team member already exist"},V2NIM_ERROR_CODE_TEAM_INVITATION_OR_APPLICATION_NOT_EXIST:{code:109313,message:"team invitation or application not exist"},V2NIM_ERROR_CODE_OPERATION_ON_TEAM_OWNER_NOT_ALLOWED:{code:109314,message:"operation on team owner not allowed"},V2NIM_ERROR_CODE_FORCED_PUSH_LIST_INCLUDES_NON_TARGETED_ACCOUNTS:{code:109318,message:"The forced push list includes non-targeted accounts"},V2NIM_ERROR_CODE_TEAM_MEMBER_NOT_EXIST:{code:109404,message:"team member not exist"},V2NIM_ERROR_CODE_TEAM_MEMBER_CHAT_BANNED:{code:109424,message:"team member chat banned"},V2NIM_ERROR_CODE_TEAM_OWNER_OPERATION_PERMISSION_REQUIRED:{code:109427,message:"team owner operation permission required"},V2NIM_ERROR_CODE_TEAM_OWNER_OR_MANAGER_OPERATION_PERMISSION_REQUIRED:{code:109432,message:"team owner or manager operation permission required"},V2NIM_ERROR_CODE_TEAM_MEMBER_CONCURRENT_OPERATION_FAILED:{code:109449,message:"team member concurrent operation failed"},V2NIM_ERROR_CODE_TEAM_MEMBER_HIT_ANTISPAM:{code:109451,message:"team member hit antispam"},V2NIM_ERROR_CODE_CONVERSATION_AND_ACCOUNT_MISMATCH:{code:110302,message:"conversation and account mismatch"},V2NIM_ERROR_CODE_CONVERSATION_STICK_TOP_LIMIT:{code:110303,message:"conversation stick top limit"},V2NIM_ERROR_CODE_CONVERSATION_BELONGED_GROUP_LIMIT:{code:110304,message:"conversation belonged group limit"},V2NIM_ERROR_CODE_CONVERSATION_NOT_EXIST:{code:110404,message:"conversation not exist"},V2NIM_ERROR_CODE_CHATROOM_LINK_UNAVAILABLE:{code:113304,message:"chatroom link unavailable"},V2NIM_ERROR_CODE_IM_CONNECTION_ABNORMAL:{code:113305,message:"IM connection abnormal"},V2NIM_ERROR_CODE_CHATROOM_NOT_EXIST:{code:113404,message:"chatroom not exist"},V2NIM_ERROR_CODE_CHATROOM_CLOSED:{code:113406,message:"chatroom closed"},V2NIM_ERROR_CODE_CHATROOM_REPEATED_OPERATION:{code:113409,message:"chatroom repeated operation"},V2NIM_ERROR_CODE_CHATROOM_DISABLED:{code:113410,message:"chatroom disabled"},V2NIM_ERROR_CODE_ALL_CHATROOM_MEMBER_CHAT_BANNED:{code:113423,message:"all chatroom member chat banned"},V2NIM_ERROR_CODE_CHATROOM_HIT_ANTISPAM:{code:113451,message:"chatroom hit antispam"},V2NIM_ERROR_CODE_ANONYMOUS_MEMBER_FORBIDDEN:{code:114303,message:"anonymous member forbidden"},V2NIM_ERROR_CODE_CHATROOM_MEMBER_NOT_EXIST:{code:114404,message:"chatroom member not exist"},V2NIM_ERROR_CODE_CHATROOM_MEMBER_REPEATED_OPERATION:{code:114405,message:"chatroom member repeated operation"},V2NIM_ERROR_CODE_CHATROOM_MEMBER_CHAT_BANNED:{code:114421,message:"chatroom member chat banned"},V2NIM_ERROR_CODE_ACCOUNT_IN_CHATROOM_BLOCK_LIST:{code:114426,message:"account in chatroom block list"},V2NIM_ERROR_CODE_CHATROOM_OWNER_OPERATION_PERMISSION_REQUIRED:{code:114427,message:"chatroom owner operation permission required"},V2NIM_ERROR_CODE_SELF_IN_CHATROOM_MEMBER_OPERATION_LIST:{code:114429,message:"self in chatroom member operation list"},V2NIM_ERROR_CODE_CHATROOM_OWNER_OR_MANAGER_OPERATION_PERMISSION_REQUIRED:{code:114432,message:"chatroom owner or manager operation permission required"},V2NIM_ERROR_CODE_CHATROOM_MEMBER_LIMIT:{code:114437,message:"chatroom member limit"},V2NIM_ERROR_CODE_CHATROOM_MEMBER_CONCURRENT_OPERATION_FAILED:{code:114449,message:"chatroom member concurrent operation failed"},V2NIM_ERROR_CODE_CHATROOM_MEMBER_HIT_ANTISPAM:{code:114451,message:"chatroom member hit antispam"},V2NIM_ERROR_CODE_CONVERSATION_GROUP_NOT_EXIST:{code:116404,message:"conversation group not exist"},V2NIM_ERROR_CODE_CONVERSATION_GROUP_LIMIT:{code:116435,message:"conversation group limit"},V2NIM_ERROR_CODE_CONVERSATIONS_IN_GROUP_LIMIT:{code:116437,message:"conversations in group limit"},V2NIM_ERROR_CODE_COLLECTION_LIMIT:{code:189301,message:"collection limit"},V2NIM_ERROR_CODE_COLLECTION_NOT_EXIST:{code:189302,message:"collection not exist"},V2NIM_ERROR_CODE_COLLECTION_CONCURRENT_OPERATION_FAILED:{code:189449,message:"collection concurrent operation failed"},V2NIM_ERROR_CODE_INTERNAL:{code:190001,message:"internal error"},V2NIM_ERROR_CODE_ILLEGAL_STATE:{code:190002,message:"illegal state"},V2NIM_ERROR_CODE_MISUSE:{code:191001,message:"misuse"},V2NIM_ERROR_CODE_CANCELLED:{code:191002,message:"operation cancelled"},V2NIM_ERROR_CODE_CALLBACK_FAILED:{code:191003,message:"callback failed"},V2NIM_ERROR_CODE_INVALID_PARAMETER:{code:191004,message:"invalid parameter"},V2NIM_ERROR_CODE_TIMEOUT:{code:191005,message:"timeout"},V2NIM_ERROR_CODE_RESOURCE_NOT_EXIST:{code:191006,message:"resource not exist"},V2NIM_ERROR_CODE_RESOURCE_ALREADY_EXIST:{code:191007,message:"resource already exist"},V2NIM_ERROR_CODE_CONNECT_FAILED:{code:192001,message:"connect failed"},V2NIM_ERROR_CODE_CONNECT_TIMEOUT:{code:192002,message:"connect timeout"},V2NIM_ERROR_CODE_DISCONNECT:{code:192003,message:"disconnect"},V2NIM_ERROR_CODE_PROTOCOL_TIMEOUT:{code:192004,message:"protocol timeout"},V2NIM_ERROR_CODE_PROTOCOL_SEND_FAILED:{code:192005,message:"protocol send failed"},V2NIM_ERROR_CODE_REQUEST_FAILED:{code:192006,message:"request failed"},V2NIM_ERROR_CODE_FILE_NOT_FOUND:{code:194001,message:"file not found"},V2NIM_ERROR_CODE_FILE_CREATE_FAILED:{code:194002,message:"file create failed"},V2NIM_ERROR_CODE_FILE_OPEN_FAILED:{code:194003,message:"file open failed"},V2NIM_ERROR_CODE_FILE_WRITE_FAILED:{code:194004,message:"file write failed"},V2NIM_ERROR_CODE_FILE_READ_FAILED:{code:194005,message:"file read failed"},V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:{code:194006,message:"file upload failed"},V2NIM_ERROR_CODE_FILE_DOWNLOAD_FAILED:{code:194007,message:"file download failed"},V2NIM_ERROR_CODE_CLIENT_ANTISPAM:{code:195001,message:"client anti-spam"},V2NIM_ERROR_CODE_SERVER_ANTISPAM:{code:195002,message:"server anti-spam"}},xc=Ui(wc),Dc=reduce(xc).call(xc,(function(t,a){var c=wc[a];return t[a]=c.code,t}),{}),Lc=reduce(xc).call(xc,(function(t,a){var c=wc[a];return t[c.code]=c.message,t}),{}),Vc=function(t){function V2NIMErrorImpl(a){var c;return(c=t.call(this,a.desc)||this).name="V2NIMError",c.code=a.code||0,c.desc=a.desc||Lc[c.code]||jc[c.code]||"",c.message=c.desc,c.detail=a.detail||{},c}return Mt(V2NIMErrorImpl,t),V2NIMErrorImpl.prototype.toString=function toString(){var t,a=this.name+"\n code: "+this.code+'\n message: "'+this.message+'"\n detail: '+(this.detail?ws(this.detail):"");return(null===(t=null==this?void 0:this.detail)||void 0===t?void 0:t.rawError)&&(a+="\n rawError: "+this.detail.rawError.message),a},V2NIMErrorImpl}(ys(Error));var Uc=function(t){function ValidateError(a,c,_){var h;return void 0===c&&(c={}),(h=t.call(this,{code:Dc.V2NIM_ERROR_CODE_PARAMETER_ERROR,detail:{reason:a,rules:_,data:c}})||this).name="validateError",h.message=h.message+"\n"+ws(h.detail,null,2),h.data=c,h.rules=_,h}return Mt(ValidateError,t),ValidateError}(Vc),Fc=function(t){function ValidateErrorV2(a){var c,_,h,m;return(c=t.call(this,{code:Dc.V2NIM_ERROR_CODE_INVALID_PARAMETER,detail:{reason:null===(_=a.detail)||void 0===_?void 0:_.reason,rules:null===(h=a.detail)||void 0===h?void 0:h.rules,data:null===(m=a.detail)||void 0===m?void 0:m.data}})||this).name="ValidateErrorV2",c}return Mt(ValidateErrorV2,t),ValidateErrorV2}(Vc),Gc=function(t){function UploadError(a){var c;return(c=t.call(this,Ct({code:400},a))||this).desc=c.desc||"upload file error",c.message=c.desc,c.name="uploadError",c}return Mt(UploadError,t),UploadError}(Vc),jc={200:null,406:null,808:null,810:null,302:"The user name or password is incorrect.",405:"Parameter length too long",408:"Client request timed out",415:"Client network unavailable",422:"Account disabled",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},Bc="object"==typeof t&&t&&t.Object===Object&&t,Yc="object"==typeof self&&self&&self.Object===Object&&self,Hc=Bc||Yc||Function("return this")(),Kc=Hc.Symbol,Wc=Object.prototype,qc=Wc.hasOwnProperty,zc=Wc.toString,$c=Kc?Kc.toStringTag:void 0;var Jc=function getRawTag(t){var a=qc.call(t,$c),c=t[$c];try{t[$c]=void 0;var _=!0}catch(t){}var h=zc.call(t);return _&&(a?t[$c]=c:delete t[$c]),h},Qc=Object.prototype.toString;var Xc=function objectToString(t){return Qc.call(t)},Zc=Kc?Kc.toStringTag:void 0;var eu=function baseGetTag(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Zc&&Zc in Object(t)?Jc(t):Xc(t)};var tu=function isObject(t){var a=typeof t;return null!=t&&("object"==a||"function"==a)};var ru=function isFunction(t){if(!tu(t))return!1;var a=eu(t);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a},ou=Hc["__core-js_shared__"],nu=function(){var t=/[^.]+$/.exec(ou&&ou.keys&&ou.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();var iu=function isMasked(t){return!!nu&&nu in t},au=Function.prototype.toString;var su=function toSource(t){if(null!=t){try{return au.call(t)}catch(t){}try{return t+""}catch(t){}}return""},cu=/^\[object .+?Constructor\]$/,uu=Function.prototype,lu=Object.prototype,du=uu.toString,fu=lu.hasOwnProperty,pu=RegExp("^"+du.call(fu).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var _u=function baseIsNative(t){return!(!tu(t)||iu(t))&&(ru(t)?pu:cu).test(su(t))};var hu=function getValue(t,a){return null==t?void 0:t[a]};var mu=function getNative(t,a){var c=hu(t,a);return _u(c)?c:void 0},gu=function(){try{var t=mu(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Eu=function baseAssignValue(t,a,c){"__proto__"==a&&gu?gu(t,a,{configurable:!0,enumerable:!0,value:c,writable:!0}):t[a]=c};var vu=function eq(t,a){return t===a||t!=t&&a!=a},yu=Object.prototype.hasOwnProperty;var Tu=function assignValue(t,a,c){var _=t[a];yu.call(t,a)&&vu(_,c)&&(void 0!==c||a in t)||Eu(t,a,c)};var Iu=function copyObject(t,a,c,_){var h=!c;c||(c={});for(var m=-1,g=a.length;++m<g;){var E=a[m],T=_?_(c[E],t[E],E,c,t):void 0;void 0===T&&(T=t[E]),h?Eu(c,E,T):Tu(c,E,T)}return c};var Nu=function identity(t){return t};var Mu=function apply(t,a,c){switch(c.length){case 0:return t.call(a);case 1:return t.call(a,c[0]);case 2:return t.call(a,c[0],c[1]);case 3:return t.call(a,c[0],c[1],c[2])}return t.apply(a,c)},Su=Math.max;var Ou=function overRest(t,a,c){return a=Su(void 0===a?t.length-1:a,0),function(){for(var _=arguments,h=-1,m=Su(_.length-a,0),g=Array(m);++h<m;)g[h]=_[a+h];h=-1;for(var E=Array(a+1);++h<a;)E[h]=_[h];return E[a]=c(g),Mu(t,this,E)}};var Au=function constant(t){return function(){return t}},bu=gu?function(t,a){return gu(t,"toString",{configurable:!0,enumerable:!1,value:Au(a),writable:!0})}:Nu,Ru=Date.now;var Cu=function shortOut(t){var a=0,c=0;return function(){var _=Ru(),h=16-(_-c);if(c=_,h>0){if(++a>=800)return arguments[0]}else a=0;return t.apply(void 0,arguments)}},Pu=Cu(bu);var ku=function baseRest(t,a){return Pu(Ou(t,a,Nu),t+"")};var wu=function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var xu=function isArrayLike(t){return null!=t&&wu(t.length)&&!ru(t)},Du=/^(?:0|[1-9]\d*)$/;var Lu=function isIndex(t,a){var c=typeof t;return!!(a=null==a?9007199254740991:a)&&("number"==c||"symbol"!=c&&Du.test(t))&&t>-1&&t%1==0&&t<a};var Vu=function isIterateeCall(t,a,c){if(!tu(c))return!1;var _=typeof a;return!!("number"==_?xu(c)&&Lu(a,c.length):"string"==_&&a in c)&&vu(c[a],t)};var Uu=function createAssigner(t){return ku((function(a,c){var _=-1,h=c.length,m=h>1?c[h-1]:void 0,g=h>2?c[2]:void 0;for(m=t.length>3&&"function"==typeof m?(h--,m):void 0,g&&Vu(c[0],c[1],g)&&(m=h<3?void 0:m,h=1),a=Object(a);++_<h;){var E=c[_];E&&t(a,E,_,m)}return a}))};var Fu=function baseTimes(t,a){for(var c=-1,_=Array(t);++c<t;)_[c]=a(c);return _};var Gu=function isObjectLike(t){return null!=t&&"object"==typeof t};var ju=function baseIsArguments(t){return Gu(t)&&"[object Arguments]"==eu(t)},Bu=Object.prototype,Yu=Bu.hasOwnProperty,Hu=Bu.propertyIsEnumerable,Ku=ju(function(){return arguments}())?ju:function(t){return Gu(t)&&Yu.call(t,"callee")&&!Hu.call(t,"callee")},Wu=Ku,qu=Array.isArray;var zu=function stubFalse(){return!1},$u=createCommonjsModule((function(t,a){var c=a&&!a.nodeType&&a,_=c&&t&&!t.nodeType&&t,h=_&&_.exports===c?Hc.Buffer:void 0,m=(h?h.isBuffer:void 0)||zu;t.exports=m})),Ju={};Ju["[object Float32Array]"]=Ju["[object Float64Array]"]=Ju["[object Int8Array]"]=Ju["[object Int16Array]"]=Ju["[object Int32Array]"]=Ju["[object Uint8Array]"]=Ju["[object Uint8ClampedArray]"]=Ju["[object Uint16Array]"]=Ju["[object Uint32Array]"]=!0,Ju["[object Arguments]"]=Ju["[object Array]"]=Ju["[object ArrayBuffer]"]=Ju["[object Boolean]"]=Ju["[object DataView]"]=Ju["[object Date]"]=Ju["[object Error]"]=Ju["[object Function]"]=Ju["[object Map]"]=Ju["[object Number]"]=Ju["[object Object]"]=Ju["[object RegExp]"]=Ju["[object Set]"]=Ju["[object String]"]=Ju["[object WeakMap]"]=!1;var Qu=function baseIsTypedArray(t){return Gu(t)&&wu(t.length)&&!!Ju[eu(t)]};var Xu=function baseUnary(t){return function(a){return t(a)}},Zu=createCommonjsModule((function(t,a){var c=a&&!a.nodeType&&a,_=c&&t&&!t.nodeType&&t,h=_&&_.exports===c&&Bc.process,m=function(){try{var t=_&&_.require&&_.require("util").types;return t||h&&h.binding&&h.binding("util")}catch(t){}}();t.exports=m})),el=Zu&&Zu.isTypedArray,tl=el?Xu(el):Qu,rl=Object.prototype.hasOwnProperty;var ol=function arrayLikeKeys(t,a){var c=qu(t),_=!c&&Wu(t),h=!c&&!_&&$u(t),m=!c&&!_&&!h&&tl(t),g=c||_||h||m,E=g?Fu(t.length,String):[],T=E.length;for(var I in t)!a&&!rl.call(t,I)||g&&("length"==I||h&&("offset"==I||"parent"==I)||m&&("buffer"==I||"byteLength"==I||"byteOffset"==I)||Lu(I,T))||E.push(I);return E},nl=Object.prototype;var il=function isPrototype(t){var a=t&&t.constructor;return t===("function"==typeof a&&a.prototype||nl)};var al=function overArg(t,a){return function(c){return t(a(c))}},sl=al(Object.keys,Object),cl=Object.prototype.hasOwnProperty;var ul=function baseKeys(t){if(!il(t))return sl(t);var a=[];for(var c in Object(t))cl.call(t,c)&&"constructor"!=c&&a.push(c);return a};var ll=function keys(t){return xu(t)?ol(t):ul(t)},dl=Uu((function(t,a,c,_){Iu(a,ll(a),t,_)}));var fl,pl=function isUndefined(t){return void 0===t},_l=(fl=function _s4(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return fl()+fl()+fl()+fl()+fl()+fl()+fl()+fl()});function getEnumKeys(t){var a;return filter(a=Ui(t)).call(a,(function(t){return!(+t>=0)}))}function getEnumKeyByEnumValue(t,a){var c,_=filter(c=Ui(t)).call(c,(function(c){return t[c]==a}));return _.length>0?_[0]:void 0}function assignOptions(t,a){return dl({},t,a,(function(t,a){return pl(a)?t:a}))}function emptyFuncWithPromise(){return Jn.resolve()}_export({target:"Array",stat:!0},{isArray:ei});var hl=Y.Array.isArray,callWithSafeIterationClosing=function(t,a,c,_){try{return _?a(anObject(c)[0],c[1]):a(c)}catch(a){iteratorClose(t,"throw",a)}},ml=Array,gl=!checkCorrectnessOfIteration((function(t){Array.from(t)}));_export({target:"Array",stat:!0,forced:gl},{from:function from(t){var a=toObject(t),c=fo(this),_=arguments.length,h=_>1?arguments[1]:void 0,m=void 0!==h;m&&(h=functionBindContext(h,_>2?arguments[2]:void 0));var g,E,T,I,N,M,S=getIteratorMethod$5(a),O=0;if(!S||this===ml&&isArrayIteratorMethod(S))for(g=lengthOfArrayLike(a),E=c?new this(g):ml(g);g>O;O++)M=m?h(a[O],O):a[O],createProperty(E,O,M);else for(N=(I=getIterator(a,S)).next,E=c?new this:[];!(T=C(N,I)).done;O++)M=m?callWithSafeIterationClosing(I,h,[T.value,O],!0):T.value,createProperty(E,O,M);return E.length=O,E}});var El=Y.Array.from,vl={f:wellKnownSymbol},yl=Be.f,wellKnownSymbolDefine=function(t){var a=Y.Symbol||(Y.Symbol={});de(a,t)||yl(a,t,{value:vl.f(t)})},symbolDefineToPrimitive=function(){var t=getBuiltIn("Symbol"),a=t&&t.prototype,c=a&&a.valueOf,_=wellKnownSymbol("toPrimitive");a&&!a[_]&&defineBuiltIn(a,_,(function(t){return C(c,this)}),{arity:1})},Tl=Ti.forEach,Il=sharedKey("hidden"),Nl="Symbol",Ml=Ar.set,Sl=Ar.getterFor(Nl),Ol=Object.prototype,Al=h.Symbol,bl=Al&&Al.prototype,Rl=h.TypeError,Cl=h.QObject,Pl=Se.f,kl=Be.f,wl=La.f,xl=w.f,Dl=A([].push),Ll=ce("symbols"),Vl=ce("op-symbols"),Ul=ce("wks"),Fl=!Cl||!Cl.prototype||!Cl.prototype.findChild,Gl=b&&fails((function(){return 7!=ct(kl({},"a",{get:function(){return kl(this,"a",{value:7}).a}})).a}))?function(t,a,c){var _=Pl(Ol,a);_&&delete Ol[a],kl(t,a,c),_&&t!==Ol&&kl(Ol,a,_)}:kl,wrap=function(t,a){var c=Ll[t]=ct(bl);return Ml(c,{type:Nl,tag:t,description:a}),b||(c.description=a),c},jl=function defineProperty(t,a,c){t===Ol&&jl(Vl,a,c),anObject(t);var _=toPropertyKey(a);return anObject(c),de(Ll,_)?(c.enumerable?(de(t,Il)&&t[Il][_]&&(t[Il][_]=!1),c=ct(c,{enumerable:createPropertyDescriptor(0,!1)})):(de(t,Il)||kl(t,Il,createPropertyDescriptor(1,{})),t[Il][_]=!0),Gl(t,_,c)):kl(t,_,c)},Bl=function defineProperties(t,a){anObject(t);var c=toIndexedObject(a),_=rt(c).concat($getOwnPropertySymbols(c));return Tl(_,(function(a){b&&!C(Yl,c,a)||jl(t,a,c[a])})),t},Yl=function propertyIsEnumerable(t){var a=toPropertyKey(t),c=C(xl,this,a);return!(this===Ol&&de(Ll,a)&&!de(Vl,a))&&(!(c||!de(this,a)||!de(Ll,a)||de(this,Il)&&this[Il][a])||c)},Hl=function getOwnPropertyDescriptor(t,a){var c=toIndexedObject(t),_=toPropertyKey(a);if(c!==Ol||!de(Ll,_)||de(Vl,_)){var h=Pl(c,_);return!h||!de(Ll,_)||de(c,Il)&&c[Il][_]||(h.enumerable=!0),h}},Kl=function getOwnPropertyNames(t){var a=wl(toIndexedObject(t)),c=[];return Tl(a,(function(t){de(Ll,t)||de(Xe,t)||Dl(c,t)})),c},$getOwnPropertySymbols=function(t){var a=t===Ol,c=wl(a?Vl:toIndexedObject(t)),_=[];return Tl(c,(function(t){!de(Ll,t)||a&&!de(Ol,t)||Dl(_,Ll[t])})),_};X||(Al=function Symbol(){if(H(bl,this))throw Rl("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?toString$1(arguments[0]):void 0,a=uid(t),setter=function(t){this===Ol&&C(setter,Vl,t),de(this,Il)&&de(this[Il],a)&&(this[Il][a]=!1),Gl(this,a,createPropertyDescriptor(1,t))};return b&&Fl&&Gl(Ol,a,{configurable:!0,set:setter}),wrap(a,t)},bl=Al.prototype,defineBuiltIn(bl,"toString",(function toString(){return Sl(this).tag})),defineBuiltIn(Al,"withoutSetter",(function(t){return wrap(uid(t),t)})),w.f=Yl,Be.f=jl,nt.f=Bl,Se.f=Hl,Vt.f=La.f=Kl,St.f=$getOwnPropertySymbols,vl.f=function(t){return wrap(wellKnownSymbol(t),t)},b&&kl(bl,"description",{configurable:!0,get:function description(){return Sl(this).description}})),_export({global:!0,constructor:!0,wrap:!0,forced:!X,sham:!X},{Symbol:Al}),Tl(rt(Ul),(function(t){wellKnownSymbolDefine(t)})),_export({target:Nl,stat:!0,forced:!X},{useSetter:function(){Fl=!0},useSimple:function(){Fl=!1}}),_export({target:"Object",stat:!0,forced:!X,sham:!b},{create:function create(t,a){return void 0===a?ct(t):Bl(ct(t),a)},defineProperty:jl,defineProperties:Bl,getOwnPropertyDescriptor:Hl}),_export({target:"Object",stat:!0,forced:!X},{getOwnPropertyNames:Kl}),symbolDefineToPrimitive(),setToStringTag(Al,Nl),Xe[Il]=!0;var Wl=X&&!!Symbol.for&&!!Symbol.keyFor,ql=ce("string-to-symbol-registry"),zl=ce("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Wl},{for:function(t){var a=toString$1(t);if(de(ql,a))return ql[a];var c=getBuiltIn("Symbol")(a);return ql[a]=c,zl[c]=a,c}});var $l=ce("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Wl},{keyFor:function keyFor(t){if(!te(t))throw TypeError(tryToString(t)+" is not a symbol");if(de($l,t))return $l[t]}});var Jl=!X||fails((function(){St.f(1)}));_export({target:"Object",stat:!0,forced:Jl},{getOwnPropertySymbols:function getOwnPropertySymbols(t){var a=St.f;return a?a(toObject(t)):[]}}),wellKnownSymbolDefine("asyncIterator"),wellKnownSymbolDefine("hasInstance"),wellKnownSymbolDefine("isConcatSpreadable"),wellKnownSymbolDefine("iterator"),wellKnownSymbolDefine("match"),wellKnownSymbolDefine("matchAll"),wellKnownSymbolDefine("replace"),wellKnownSymbolDefine("search"),wellKnownSymbolDefine("species"),wellKnownSymbolDefine("split"),wellKnownSymbolDefine("toPrimitive"),symbolDefineToPrimitive(),wellKnownSymbolDefine("toStringTag"),setToStringTag(getBuiltIn("Symbol"),"Symbol"),wellKnownSymbolDefine("unscopables"),setToStringTag(h.JSON,"JSON",!0);var Ql=Y.Symbol;wellKnownSymbolDefine("asyncDispose"),wellKnownSymbolDefine("dispose"),wellKnownSymbolDefine("matcher"),wellKnownSymbolDefine("metadataKey"),wellKnownSymbolDefine("observable"),wellKnownSymbolDefine("metadata"),wellKnownSymbolDefine("patternMatch"),wellKnownSymbolDefine("replaceAll");var Xl=Ql,Zl=getIteratorMethod$5;var ed=vl.f("iterator"),td=createCommonjsModule((function(t){function _typeof(a){return t.exports=_typeof="function"==typeof Xl&&"symbol"==typeof ed?function(t){return typeof t}:function(t){return t&&"function"==typeof Xl&&t.constructor===Xl&&t!==Xl.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,_typeof(a)}t.exports=_typeof,t.exports.__esModule=!0,t.exports.default=t.exports})),rd=A([].reverse),od=[1,2];_export({target:"Array",proto:!0,forced:String(od)===String(od.reverse())},{reverse:function reverse(){return ei(this)&&(this.length=this.length),rd(this)}});var nd=entryVirtual("Array").reverse,id=Array.prototype,reverse=function(t){var a=t.reverse;return t===id||H(id,t)&&a===id.reverse?nd:a},ad=createCommonjsModule((function(t){var a=td.default;function _regeneratorRuntime(){t.exports=_regeneratorRuntime=function _regeneratorRuntime(){return c},t.exports.__esModule=!0,t.exports.default=t.exports;var c={},_=Object.prototype,h=_.hasOwnProperty,m="function"==typeof Xl?Xl:{},g=m.iterator||"@@iterator",E=m.asyncIterator||"@@asyncIterator",T=m.toStringTag||"@@toStringTag";function define(t,a,c){return vi(t,a,{value:c,enumerable:!0,configurable:!0,writable:!0}),t[a]}try{define({},"")}catch(t){define=function define(t,a,c){return t[a]=c}}function wrap(t,a,c,_){var h=a&&a.prototype instanceof Generator?a:Generator,m=lt(h.prototype),g=new Context(_||[]);return m._invoke=function(t,a,c){var _="suspendedStart";return function(h,m){if("executing"===_)throw new Error("Generator is already running");if("completed"===_){if("throw"===h)throw m;return doneResult()}for(c.method=h,c.arg=m;;){var g=c.delegate;if(g){var E=maybeInvokeDelegate(g,c);if(E){if(E===I)continue;return E}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if("suspendedStart"===_)throw _="completed",c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);_="executing";var T=tryCatch(t,a,c);if("normal"===T.type){if(_=c.done?"completed":"suspendedYield",T.arg===I)continue;return{value:T.arg,done:c.done}}"throw"===T.type&&(_="completed",c.method="throw",c.arg=T.arg)}}}(t,c,g),m}function tryCatch(t,a,c){try{return{type:"normal",arg:t.call(a,c)}}catch(t){return{type:"throw",arg:t}}}c.wrap=wrap;var I={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var N={};define(N,g,(function(){return this}));var M=ss&&ss(ss(values([])));M&&M!==_&&h.call(M,g)&&(N=M);var S=GeneratorFunctionPrototype.prototype=Generator.prototype=lt(N);function defineIteratorMethods(t){var a;forEach$1(a=["next","throw","return"]).call(a,(function(a){define(t,a,(function(t){return this._invoke(a,t)}))}))}function AsyncIterator(t,c){function invoke(_,m,g,E){var T=tryCatch(t[_],t,m);if("throw"!==T.type){var I=T.arg,N=I.value;return N&&"object"==a(N)&&h.call(N,"__await")?c.resolve(N.__await).then((function(t){invoke("next",t,g,E)}),(function(t){invoke("throw",t,g,E)})):c.resolve(N).then((function(t){I.value=t,g(I)}),(function(t){return invoke("throw",t,g,E)}))}E(T.arg)}var _;this._invoke=function(t,a){function callInvokeWithMethodAndArg(){return new c((function(c,_){invoke(t,a,c,_)}))}return _=_?_.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(t,a){var c=t.iterator[a.method];if(void 0===c){if(a.delegate=null,"throw"===a.method){if(t.iterator.return&&(a.method="return",a.arg=void 0,maybeInvokeDelegate(t,a),"throw"===a.method))return I;a.method="throw",a.arg=new TypeError("The iterator does not provide a 'throw' method")}return I}var _=tryCatch(c,t.iterator,a.arg);if("throw"===_.type)return a.method="throw",a.arg=_.arg,a.delegate=null,I;var h=_.arg;return h?h.done?(a[t.resultName]=h.value,a.next=t.nextLoc,"return"!==a.method&&(a.method="next",a.arg=void 0),a.delegate=null,I):h:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,I)}function pushTryEntry(t){var a={tryLoc:t[0]};1 in t&&(a.catchLoc=t[1]),2 in t&&(a.finallyLoc=t[2],a.afterLoc=t[3]),this.tryEntries.push(a)}function resetTryEntry(t){var a=t.completion||{};a.type="normal",delete a.arg,t.completion=a}function Context(t){this.tryEntries=[{tryLoc:"root"}],forEach$1(t).call(t,pushTryEntry,this),this.reset(!0)}function values(t){if(t){var a=t[g];if(a)return a.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var c=-1,_=function next(){for(;++c<t.length;)if(h.call(t,c))return next.value=t[c],next.done=!1,next;return next.value=void 0,next.done=!0,next};return _.next=_}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(S,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,T,"GeneratorFunction"),c.isGeneratorFunction=function(t){var a="function"==typeof t&&t.constructor;return!!a&&(a===GeneratorFunction||"GeneratorFunction"===(a.displayName||a.name))},c.mark=function(t){return _t?_t(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,T,"GeneratorFunction")),t.prototype=lt(S),t},c.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,E,(function(){return this})),c.AsyncIterator=AsyncIterator,c.async=function(t,a,_,h,m){void 0===m&&(m=Jn);var g=new AsyncIterator(wrap(t,a,_,h),m);return c.isGeneratorFunction(a)?g:g.next().then((function(t){return t.done?t.value:g.next()}))},defineIteratorMethods(S),define(S,T,"Generator"),define(S,g,(function(){return this})),define(S,"toString",(function(){return"[object Generator]"})),c.keys=function(t){var a=[];for(var c in t)a.push(c);return reverse(a).call(a),function next(){for(;a.length;){var c=a.pop();if(c in t)return next.value=c,next.done=!1,next}return next.done=!0,next}},c.values=values,Context.prototype={constructor:Context,reset:function reset(t){var a;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(a=this.tryEntries).call(a,resetTryEntry),!t)for(var c in this)"t"===c.charAt(0)&&h.call(this,c)&&!isNaN(+slice$1(c).call(c,1))&&(this[c]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var a=this;function handle(c,_){return m.type="throw",m.arg=t,a.next=c,_&&(a.method="next",a.arg=void 0),!!_}for(var c=this.tryEntries.length-1;c>=0;--c){var _=this.tryEntries[c],m=_.completion;if("root"===_.tryLoc)return handle("end");if(_.tryLoc<=this.prev){var g=h.call(_,"catchLoc"),E=h.call(_,"finallyLoc");if(g&&E){if(this.prev<_.catchLoc)return handle(_.catchLoc,!0);if(this.prev<_.finallyLoc)return handle(_.finallyLoc)}else if(g){if(this.prev<_.catchLoc)return handle(_.catchLoc,!0)}else{if(!E)throw new Error("try statement without catch or finally");if(this.prev<_.finallyLoc)return handle(_.finallyLoc)}}}},abrupt:function abrupt(t,a){for(var c=this.tryEntries.length-1;c>=0;--c){var _=this.tryEntries[c];if(_.tryLoc<=this.prev&&h.call(_,"finallyLoc")&&this.prev<_.finallyLoc){var m=_;break}}m&&("break"===t||"continue"===t)&&m.tryLoc<=a&&a<=m.finallyLoc&&(m=null);var g=m?m.completion:{};return g.type=t,g.arg=a,m?(this.method="next",this.next=m.finallyLoc,I):this.complete(g)},complete:function complete(t,a){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&a&&(this.next=a),I},finish:function finish(t){for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a];if(c.finallyLoc===t)return this.complete(c.completion,c.afterLoc),resetTryEntry(c),I}},catch:function _catch(t){for(var a=this.tryEntries.length-1;a>=0;--a){var c=this.tryEntries[a];if(c.tryLoc===t){var _=c.completion;if("throw"===_.type){var h=_.arg;resetTryEntry(c)}return h}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,a,c){return this.delegate={iterator:values(t),resultName:a,nextLoc:c},"next"===this.method&&(this.arg=void 0),I}},c}t.exports=_regeneratorRuntime,t.exports.__esModule=!0,t.exports.default=t.exports})),sd=ad(),cd=sd;try{regeneratorRuntime=sd}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=sd:Function("r","regeneratorRuntime = r")(sd)}function __rest(t,a){var c={};for(var _ in t)Object.prototype.hasOwnProperty.call(t,_)&&a.indexOf(_)<0&&(c[_]=t[_]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var h=0;for(_=Object.getOwnPropertySymbols(t);h<_.length;h++)a.indexOf(_[h])<0&&Object.prototype.propertyIsEnumerable.call(t,_[h])&&(c[_[h]]=t[_[h]])}return c}function __awaiter(t,a,c,_){return new(c||(c=Promise))((function(h,m){function fulfilled(t){try{step(_.next(t))}catch(t){m(t)}}function rejected(t){try{step(_.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof c?t:new c((function(a){a(t)}))}(t.value).then(fulfilled,rejected)}step((_=_.apply(t,a||[])).next())}))}var ud=function isSymbol(t){return"symbol"==typeof t||Gu(t)&&"[object Symbol]"==eu(t)},ld=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dd=/^\w*$/;var fd=function isKey(t,a){if(qu(t))return!1;var c=typeof t;return!("number"!=c&&"symbol"!=c&&"boolean"!=c&&null!=t&&!ud(t))||(dd.test(t)||!ld.test(t)||null!=a&&t in Object(a))},pd=mu(Object,"create");var _d=function hashClear(){this.__data__=pd?pd(null):{},this.size=0};var hd=function hashDelete(t){var a=this.has(t)&&delete this.__data__[t];return this.size-=a?1:0,a},md=Object.prototype.hasOwnProperty;var gd=function hashGet(t){var a=this.__data__;if(pd){var c=a[t];return"__lodash_hash_undefined__"===c?void 0:c}return md.call(a,t)?a[t]:void 0},Ed=Object.prototype.hasOwnProperty;var vd=function hashHas(t){var a=this.__data__;return pd?void 0!==a[t]:Ed.call(a,t)};var yd=function hashSet(t,a){var c=this.__data__;return this.size+=this.has(t)?0:1,c[t]=pd&&void 0===a?"__lodash_hash_undefined__":a,this};function Hash(t){var a=-1,c=null==t?0:t.length;for(this.clear();++a<c;){var _=t[a];this.set(_[0],_[1])}}Hash.prototype.clear=_d,Hash.prototype.delete=hd,Hash.prototype.get=gd,Hash.prototype.has=vd,Hash.prototype.set=yd;var Td=Hash;var Id=function listCacheClear(){this.__data__=[],this.size=0};var Nd=function assocIndexOf(t,a){for(var c=t.length;c--;)if(vu(t[c][0],a))return c;return-1},Md=Array.prototype.splice;var Sd=function listCacheDelete(t){var a=this.__data__,c=Nd(a,t);return!(c<0)&&(c==a.length-1?a.pop():Md.call(a,c,1),--this.size,!0)};var Od=function listCacheGet(t){var a=this.__data__,c=Nd(a,t);return c<0?void 0:a[c][1]};var Ad=function listCacheHas(t){return Nd(this.__data__,t)>-1};var bd=function listCacheSet(t,a){var c=this.__data__,_=Nd(c,t);return _<0?(++this.size,c.push([t,a])):c[_][1]=a,this};function ListCache(t){var a=-1,c=null==t?0:t.length;for(this.clear();++a<c;){var _=t[a];this.set(_[0],_[1])}}ListCache.prototype.clear=Id,ListCache.prototype.delete=Sd,ListCache.prototype.get=Od,ListCache.prototype.has=Ad,ListCache.prototype.set=bd;var Rd=ListCache,Cd=mu(Hc,"Map");var Pd=function mapCacheClear(){this.size=0,this.__data__={hash:new Td,map:new(Cd||Rd),string:new Td}};var kd=function isKeyable(t){var a=typeof t;return"string"==a||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==t:null===t};var wd=function getMapData(t,a){var c=t.__data__;return kd(a)?c["string"==typeof a?"string":"hash"]:c.map};var xd=function mapCacheDelete(t){var a=wd(this,t).delete(t);return this.size-=a?1:0,a};var Dd=function mapCacheGet(t){return wd(this,t).get(t)};var Ld=function mapCacheHas(t){return wd(this,t).has(t)};var Vd=function mapCacheSet(t,a){var c=wd(this,t),_=c.size;return c.set(t,a),this.size+=c.size==_?0:1,this};function MapCache(t){var a=-1,c=null==t?0:t.length;for(this.clear();++a<c;){var _=t[a];this.set(_[0],_[1])}}MapCache.prototype.clear=Pd,MapCache.prototype.delete=xd,MapCache.prototype.get=Dd,MapCache.prototype.has=Ld,MapCache.prototype.set=Vd;var Ud=MapCache;function memoize(t,a){if("function"!=typeof t||null!=a&&"function"!=typeof a)throw new TypeError("Expected a function");var memoized=function(){var c=arguments,_=a?a.apply(this,c):c[0],h=memoized.cache;if(h.has(_))return h.get(_);var m=t.apply(this,c);return memoized.cache=h.set(_,m)||h,m};return memoized.cache=new(memoize.Cache||Ud),memoized}memoize.Cache=Ud;var Fd=memoize;var Gd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jd=/\\(\\)?/g,Bd=function memoizeCapped(t){var a=Fd(t,(function(t){return 500===c.size&&c.clear(),t})),c=a.cache;return a}((function(t){var a=[];return 46===t.charCodeAt(0)&&a.push(""),t.replace(Gd,(function(t,c,_,h){a.push(_?h.replace(jd,"$1"):c||t)})),a})),Yd=Bd;var Hd=function arrayMap(t,a){for(var c=-1,_=null==t?0:t.length,h=Array(_);++c<_;)h[c]=a(t[c],c,t);return h},Kd=Kc?Kc.prototype:void 0,Wd=Kd?Kd.toString:void 0;var qd=function baseToString(t){if("string"==typeof t)return t;if(qu(t))return Hd(t,baseToString)+"";if(ud(t))return Wd?Wd.call(t):"";var a=t+"";return"0"==a&&1/t==-Infinity?"-0":a};var zd=function toString(t){return null==t?"":qd(t)};var $d=function castPath(t,a){return qu(t)?t:fd(t,a)?[t]:Yd(zd(t))};var Jd=function toKey(t){if("string"==typeof t||ud(t))return t;var a=t+"";return"0"==a&&1/t==-Infinity?"-0":a};var Qd=function baseGet(t,a){for(var c=0,_=(a=$d(a,t)).length;null!=t&&c<_;)t=t[Jd(a[c++])];return c&&c==_?t:void 0};var Xd=function get(t,a,c){var _=null==t?void 0:Qd(t,a);return void 0===_?c:_};var Zd=function stackClear(){this.__data__=new Rd,this.size=0};var ef=function stackDelete(t){var a=this.__data__,c=a.delete(t);return this.size=a.size,c};var tf=function stackGet(t){return this.__data__.get(t)};var rf=function stackHas(t){return this.__data__.has(t)};var nf=function stackSet(t,a){var c=this.__data__;if(c instanceof Rd){var _=c.__data__;if(!Cd||_.length<199)return _.push([t,a]),this.size=++c.size,this;c=this.__data__=new Ud(_)}return c.set(t,a),this.size=c.size,this};function Stack(t){var a=this.__data__=new Rd(t);this.size=a.size}Stack.prototype.clear=Zd,Stack.prototype.delete=ef,Stack.prototype.get=tf,Stack.prototype.has=rf,Stack.prototype.set=nf;var af=Stack;var sf=function assignMergeValue(t,a,c){(void 0!==c&&!vu(t[a],c)||void 0===c&&!(a in t))&&Eu(t,a,c)};var cf=function createBaseFor(t){return function(a,c,_){for(var h=-1,m=Object(a),g=_(a),E=g.length;E--;){var T=g[t?E:++h];if(!1===c(m[T],T,m))break}return a}}(),uf=createCommonjsModule((function(t,a){var c=a&&!a.nodeType&&a,_=c&&t&&!t.nodeType&&t,h=_&&_.exports===c?Hc.Buffer:void 0,m=h?h.allocUnsafe:void 0;t.exports=function cloneBuffer(t,a){if(a)return t.slice();var c=t.length,_=m?m(c):new t.constructor(c);return t.copy(_),_}})),lf=Hc.Uint8Array;var df=function cloneArrayBuffer(t){var a=new t.constructor(t.byteLength);return new lf(a).set(new lf(t)),a};var ff=function cloneTypedArray(t,a){var c=a?df(t.buffer):t.buffer;return new t.constructor(c,t.byteOffset,t.length)};var pf=function copyArray(t,a){var c=-1,_=t.length;for(a||(a=Array(_));++c<_;)a[c]=t[c];return a},_f=Object.create,hf=function(){function object(){}return function(t){if(!tu(t))return{};if(_f)return _f(t);object.prototype=t;var a=new object;return object.prototype=void 0,a}}(),mf=al(Object.getPrototypeOf,Object);var gf=function initCloneObject(t){return"function"!=typeof t.constructor||il(t)?{}:hf(mf(t))};var Ef=function isArrayLikeObject(t){return Gu(t)&&xu(t)},vf=Function.prototype,yf=Object.prototype,Tf=vf.toString,If=yf.hasOwnProperty,Nf=Tf.call(Object);var Mf=function isPlainObject(t){if(!Gu(t)||"[object Object]"!=eu(t))return!1;var a=mf(t);if(null===a)return!0;var c=If.call(a,"constructor")&&a.constructor;return"function"==typeof c&&c instanceof c&&Tf.call(c)==Nf};var Sf=function safeGet(t,a){if(("constructor"!==a||"function"!=typeof t[a])&&"__proto__"!=a)return t[a]};var Of=function nativeKeysIn(t){var a=[];if(null!=t)for(var c in Object(t))a.push(c);return a},Af=Object.prototype.hasOwnProperty;var bf=function baseKeysIn(t){if(!tu(t))return Of(t);var a=il(t),c=[];for(var _ in t)("constructor"!=_||!a&&Af.call(t,_))&&c.push(_);return c};var Rf=function keysIn(t){return xu(t)?ol(t,!0):bf(t)};var Cf=function toPlainObject(t){return Iu(t,Rf(t))};var Pf=function baseMergeDeep(t,a,c,_,h,m,g){var E=Sf(t,c),T=Sf(a,c),I=g.get(T);if(I)sf(t,c,I);else{var N=m?m(E,T,c+"",t,a,g):void 0,M=void 0===N;if(M){var S=qu(T),O=!S&&$u(T),A=!S&&!O&&tl(T);N=T,S||O||A?qu(E)?N=E:Ef(E)?N=pf(E):O?(M=!1,N=uf(T,!0)):A?(M=!1,N=ff(T,!0)):N=[]:Mf(T)||Wu(T)?(N=E,Wu(E)?N=Cf(E):tu(E)&&!ru(E)||(N=gf(T))):M=!1}M&&(g.set(T,N),h(N,T,_,m,g),g.delete(T)),sf(t,c,N)}};var kf=function baseMerge(t,a,c,_,h){t!==a&&cf(a,(function(m,g){if(h||(h=new af),tu(m))Pf(t,a,g,c,baseMerge,_,h);else{var E=_?_(Sf(t,g),m,g+"",t,a,h):void 0;void 0===E&&(E=m),sf(t,g,E)}}),Rf)},wf=Uu((function(t,a,c){kf(t,a,c)})),xf=Ti.some,Df=arrayMethodIsStrict("some");_export({target:"Array",proto:!0,forced:!Df},{some:function some(t){return xf(this,t,arguments.length>1?arguments[1]:void 0)}});var Lf,Vf,Uf=entryVirtual("Array").some,Ff=Array.prototype,some=function(t){var a=t.some;return t===Ff||H(Ff,t)&&a===Ff.some?Uf:a};!function(t){t[t.Unset=0]="Unset",t[t.RN=2]="RN",t[t.UNIAPP=3]="UNIAPP",t[t.Electron=5]="Electron",t[t.WeiXin=6]="WeiXin",t[t.BROWSER=100]="BROWSER",t[t.H5=101]="H5",t[t.Ali=102]="Ali",t[t.Baidu=103]="Baidu",t[t.Tiktok=104]="Tiktok"}(Lf||(Lf={})),function(t){t[t.kStatNetTypeUnkonw=0]="kStatNetTypeUnkonw",t[t.kStatNetTypeEthernet=1]="kStatNetTypeEthernet",t[t.kStatNetTypeWifi=2]="kStatNetTypeWifi",t[t.kStatNetType2G=3]="kStatNetType2G",t[t.kStatNetType3G=4]="kStatNetType3G",t[t.kStatNetType4G=5]="kStatNetType4G",t[t.kStatNetType5G=6]="kStatNetType5G"}(Vf||(Vf={}));var Gf={wifi:Vf.kStatNetTypeWifi,"2g":Vf.kStatNetType2G,"3g":Vf.kStatNetType3G,"4g":Vf.kStatNetType4G,"5g":Vf.kStatNetType5G,ethernet:Vf.kStatNetTypeEthernet,unknown:Vf.kStatNetTypeUnkonw,none:Vf.kStatNetTypeUnkonw,notreachable:Vf.kStatNetTypeUnkonw,wwan:Vf.kStatNetTypeUnkonw};function isMobile(){if(!navigator||!navigator.userAgent)return!1;var t=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i];return some(t).call(t,(function(t){return navigator.userAgent.match(t)}))}function isElectron(){var t;return!(!navigator||!navigator.userAgent)&&("object"==typeof navigator&&"string"==typeof navigator.userAgent&&indexOf(t=navigator.userAgent).call(t,"Electron")>=0)}function isBrowser(){return navigator&&navigator.userAgent}var jf={setLogger:function setLogger(t){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function AdapterSocket(t,a){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,this.binaryType="",new Error("Method not implemented.")}var t=AdapterSocket.prototype;return t.close=function close(t,a){throw new Error("Method not implemented.")},t.send=function send(t){throw new Error("Method not implemented.")},t.onclose=function onclose(t){throw new Error("Method not implemented.")},t.onerror=function onerror(t){throw new Error("Method not implemented.")},t.onmessage=function onmessage(t){throw new Error("Method not implemented.")},t.onopen=function onopen(t){throw new Error("Method not implemented.")},AdapterSocket}(),localStorage:{},request:function request(t,a){throw new Error("Function not implemented.")},uploadFile:function uploadFile(t){throw new Error("Function not implemented.")},getSystemInfo:function getSystemInfo(){throw new Error("Function not implemented.")},getFileUploadInformation:function getFileUploadInformation(t){throw new Error("Function not implemented.")},net:{__getEnv:function __getEnv(){return null},__onNetworkStatusChangeFn:null,getNetworkStatus:function getNetworkStatus(){var t=this.__getEnv();return new Jn((function(a,c){t.getNetworkType({success:function success(t){var c=!1;c="boolean"==typeof t.networkAvailable?t.networkAvailable:"none"!==t.networkType.toLowerCase(),a({net_type:Gf[t.networkType.toLowerCase()],net_connect:c})},fail:function fail(){c(new Error("getNetworkType failed"))}})}))},onNetworkStatusChange:function onNetworkStatusChange(t){var a=this.__getEnv();this.offNetworkStatusChange(),a.onNetworkStatusChange&&(this.__onNetworkStatusChangeFn=function(a){var c=a.networkType.toLowerCase();t({isConnected:a.isConnected||"none"!==c,networkType:Gf[c]})},a.onNetworkStatusChange(this.__onNetworkStatusChangeFn))},offNetworkStatusChange:function offNetworkStatusChange(){var t=this.__getEnv();t.offNetworkStatusChange&&(this.__onNetworkStatusChangeFn&&t.offNetworkStatusChange(this.__onNetworkStatusChangeFn),this.__onNetworkStatusChangeFn=null)}}};function getPromiseWithAbort(t){var a={},c=new Jn((function(t,c){a.abort=c}));return a.promise=Jn.race([t,c]),a}Jn.reject;var Bf=function(){function PromiseManager(){this.abortFns=[]}var t=PromiseManager.prototype;return t.add=function add(t){var a=getPromiseWithAbort(t);return this.abortFns.push(a.abort),a.promise},t.clear=function clear(t){var a;forEach$1(a=this.abortFns).call(a,(function(a){return a(t||new Vc({code:Dc.V2NIM_ERROR_CODE_CANCELLED,detail:{reason:"Aborted"}}))})),this.abortFns=[]},t.destroy=function destroy(){this.clear()},PromiseManager}(),Yf={tolerantRTT:3e3,bestRTT:100,maxChances:5,enable:!0},Hf={timestamp:0,rtt:0,baseClock:0,baseTime:0},Kf=function(){function TimeOrigin(t,a,c){void 0===c&&(c="getServerTime"),this.serverOrigin=Hf,this.config=Yf,this.isSettingNTP=!1,this.currentChance=0,this.failedDelay=2e3,this.successDelay=3e5,this.timer=0,this.cmdName="getServerTime",this.core=t,this.logger=t.logger,this.promiseManager=new Bf,this.cmdName=c,a&&this.setOptions(a)}var t=TimeOrigin.prototype;return t.setOptions=function setOptions(t){this.config=Ct({},Yf,this.config,t)},t.reset=function reset(){this.timer&&clearTimeout(this.timer),this.promiseManager.clear(),this.serverOrigin=Hf,this.currentChance=0},t.setOriginTimetick=function setOriginTimetick(){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var t,a,c,_,h,m,g,E,T,I;return cd.wrap((function _callee$(N){for(;;)switch(N.prev=N.next){case 0:if(this.config.enable){N.next=2;break}return N.abrupt("return");case 2:if(!this.isSettingNTP){N.next=4;break}return N.abrupt("return");case 4:if(!(this.currentChance>=this.config.maxChances)){N.next=6;break}return N.abrupt("return");case 6:if(t=Xd(this.core,"auth.status"),a=Xd(this.core,"status"),c=Xd(this.core,"V2NIMLoginService.lifeCycle.loginStatus"),"logined"===t||"logined"===a||c===zs.V2NIM_LOGIN_STATUS_LOGINED){N.next=11;break}return N.abrupt("return");case 11:return this.isSettingNTP=!0,this.currentChance++,this.timer&&clearTimeout(this.timer),this.timer=0,_="TimeOrigin::setOriginTimetick:",h=Zn(),this.core.logger.log(_+" getServerTime start, times "+this.currentChance),N.prev=18,N.next=21,this.promiseManager.add(this.core.sendCmd(this.cmdName));case 21:g=N.sent,m=Xd(g,"content.time"),this.isSettingNTP=!1,N.next=33;break;case 26:return N.prev=26,N.t0=N.catch(18),E=N.t0,this.isSettingNTP=!1,this.logger.warn(_+" Calculate Delay time, getServerTime error",E),E.code!==Dc.V2NIM_ERROR_CODE_CANCELLED&&(this.timer=hi(bind$1(T=this.setOriginTimetick).call(T,this),this.failedDelay)),N.abrupt("return");case 33:if(m){N.next=37;break}return this.core.logger.warn(_+" Calculate Delay time incorrect format"),this.config.enable=!1,N.abrupt("return");case 37:I=Zn()-h,this.doSet(m,I);case 39:case"end":return N.stop()}}),_callee,this,[[18,26]])})))},t.doSet=function doSet(t,a){var c,_="TimeOrigin::setOriginTimetick:";if(a>this.config.tolerantRTT)this.logger.warn(_+" Denied, cause of exceeding the maximum tolerance range of RTT: "+a),this.timer=hi(bind$1(c=this.setOriginTimetick).call(c,this),this.failedDelay);else if(a>this.config.bestRTT){var h;this.serverOrigin.rtt&&a>=this.serverOrigin.rtt?this.logger.log(_+" Denied, cause of current.RTT >= serverOrigin.RTT: "+a):(this.setServerOrigin(a,t),this.logger.log(_+" Accept within maximum tolerance range of RTT: "+a+", ntpTimestamp: "+this.serverOrigin.timestamp+", localClock: "+this.serverOrigin.baseClock+", localTime: "+this.serverOrigin.baseTime)),this.timer=hi(bind$1(h=this.setOriginTimetick).call(h,this),this.failedDelay)}else{var m;this.setServerOrigin(a,t),this.logger.log(_+" Accept within best RTT: "+a+", ntpTimestamp: "+this.serverOrigin.timestamp+", localClock: "+this.serverOrigin.baseClock+", localTime: "+this.serverOrigin.baseTime),this.currentChance=0,this.timer=hi(bind$1(m=this.setOriginTimetick).call(m,this),this.successDelay)}},t.getNTPTime=function getNTPTime(t){if(void 0===t&&(t=this.getTimeNode()),this.checkNodeReliable(t)){var a=Math.floor(t.time-this.serverOrigin.baseTime);return this.serverOrigin.timestamp+a}return Zn()},t.checkNodeReliable=function checkNodeReliable(t){if(void 0===t&&(t=this.getTimeNode()),this.serverOrigin.timestamp){if(0===this.serverOrigin.baseClock)return!0;var a=t.clock-this.serverOrigin.baseClock,c=t.time-this.serverOrigin.baseTime;return Math.abs(c-a)<500}return!1},t.checkPerformance=function checkPerformance(){return"BROWSER"===jf.platform&&!("undefined"==typeof performance||!performance.now)},TimeOrigin.checkPerformance=function checkPerformance(){return"BROWSER"===jf.platform&&!("undefined"==typeof performance||!performance.now)},t.getTimeNode=function getTimeNode(){return{clock:this.checkPerformance()?performance.now():0,time:Zn()}},TimeOrigin.getTimeNode=function getTimeNode(){return{clock:TimeOrigin.checkPerformance()?performance.now():0,time:Zn()}},t.setServerOrigin=function setServerOrigin(t,a){this.serverOrigin={timestamp:a+Math.floor(t/2),rtt:t,baseClock:this.checkPerformance()?performance.now():0,baseTime:Zn()}},TimeOrigin}();function _createForOfIteratorHelperLoose$2(t,a){var c,_=void 0!==Xl&&Zl(t)||t["@@iterator"];if(_)return bind$1(c=(_=_.call(t)).next).call(c,_);if(hl(t)||(_=function _unsupportedIterableToArray$2(t,a){var c;if(!t)return;if("string"==typeof t)return _arrayLikeToArray$2(t,a);var _=slice$1(c=Object.prototype.toString.call(t)).call(c,8,-1);"Object"===_&&t.constructor&&(_=t.constructor.name);if("Map"===_||"Set"===_)return El(t);if("Arguments"===_||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$2(t,a)}(t))||a&&t&&"number"==typeof t.length){_&&(t=_);var h=0;return function(){return h>=t.length?{done:!0}:{done:!1,value:t[h++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayLikeToArray$2(t,a){(null==a||a>t.length)&&(a=t.length);for(var c=0,_=new Array(a);c<a;c++)_[c]=t[c];return _}var Wf={},qf={};function parseEachCmd(t,a,c,_,h){var m,g={cmd:c,raw:t,error:null,service:null==a?void 0:a.service,content:{},__receiveTimeNode:Kf.getTimeNode()};if(!c||!a)return g.notFound=!0,g;(18===a.sid||a.sid>=26&&a.sid<100)&&(t.code=function toReadableCode(t){if("number"!=typeof t||t!=t)throw new Vc({code:Dc.V2NIM_ERROR_CODE_INTERNAL,detail:{reason:"Read code failed",rawData:""+t}});if(t<0||t>=0&&t<1e3||t>=2e4&&t<=20099)return t;var a=(65535&t)>>9;a-=a<=38?1:2;return 1e5+1e3*a+(511&t)}(t.code));var E,T=function genCmdError(t,a){var c=Lc[t],_=jc[t];return null===_?null:new Vc({code:t,desc:c||_||t,detail:{cmd:a,timetag:Zn()}})}(t.code,c);if(g.error=T,g.error){if(g.error.detail.cmd=c,!(null===(m=null==a?void 0:a.ignoreErrCodes)||void 0===m?void 0:includes(m).call(m,t.code)))return g;h.warn("parseCmd:: ignore error ",g.error),g.error.detail.ignore=!0}a.response&&forEach$1(E=a.response).call(E,(function(t,a){var c=_[a],h=t.type,m=t.name,E=t.reflectMapper;if(!pl(c))switch(h){case"Property":g.content[m]=E?deserialize(c,E):c;break;case"PropertyArray":g.content[m]=map$6(c).call(c,(function(t){return E?deserialize(t,E):t}));break;case"Int":case"Long":case"Byte":g.content[m]=+c;break;case"Bool":g.content[m]="true"===c||!0===c||1===c;break;default:g.content[m]=c}}));return g}function serialize(t,a,c){var _={};for(var h in t=function flattenObjByMapper(t,a){var c={};for(var _ in a){for(var h,m=a[_],g="number"==typeof m?_:m.access?m.access:_,E=t,T=_createForOfIteratorHelperLoose$2(g.split("."));!(h=T()).done;){var I=h.value;if(void 0===E[I]||null===E[I]){E=void 0;break}E=E[I]}void 0!==E&&(c[g]=E)}return c}(t,a),a){var m=a[h],g="number"==typeof m?h:m.access?m.access:h;if(!c||includes(c).call(c,h))if(g in t){if("number"==typeof m)_[m]=t[g];else if("object"==typeof m)if(m.converter){var E=m.converter(t[g],t);void 0!==E&&(_[m.id]=E)}else _[m.id]=t[g]}else"object"==typeof m&&m.def&&("function"==typeof m.def?_[m.id]=m.def(t):_[m.id]=m.def)}return _}function deserialize(t,a){var c={};for(var _ in t){var h=a[_];if("string"==typeof h)c[h]=t[_];else if("object"==typeof h&&"prop"in h){var m=h.access?h.access:h.prop;if(h.converter){var g=h.converter(t[_],t);void 0!==g&&(c[m]=g)}else h.type&&"number"===h.type?c[m]=+t[_]:h.type&&"boolean"===h.type?c[m]=!("0"===t[_]||!t[_]):c[m]=t[_]}}for(var E in a){var T=a[E];if(T&&void 0!==T.def){var I=T.access?T.access:T.prop;I in c||("function"==typeof T.def?c[I]=T.def(t):c[I]=T.def)}}return c=function unflattenObj(t){var a={},c=function _loop(c){var _=c.split(".");reduce(_).call(_,(function(a,h,m){return a[h]||(a[h]=isNaN(Number(_[m+1]))?_.length-1==m?t[c]:{}:[])}),a)};for(var _ in t)c(_);return a}(c),c}function registerParser(t){for(var a in Ct(Wf,t.cmdConfig),t.cmdMap){var c=t.cmdMap[a],_=t.cmdConfig[c];if(_)if(hl(qf[a])){for(var h,m=!1,g=_createForOfIteratorHelperLoose$2(qf[a]);!(h=g()).done;){var E=h.value;if(E.cmd===c&&E.config.service===_.service){m=!0;break}}m||qf[a].push({config:_,cmd:c})}else qf[a]=[{config:_,cmd:c}]}}var zf=entryVirtual("Array").values,$f=Array.prototype,Jf={DOMTokenList:!0,NodeList:!0},values=function(t){var a=t.values;return t===$f||H($f,t)&&a===$f.values||de(Jf,Zt(t))?zf:a},Qf=Ti.every,Xf=arrayMethodIsStrict("every");_export({target:"Array",proto:!0,forced:!Xf},{every:function every(t){return Qf(this,t,arguments.length>1?arguments[1]:void 0)}});var Zf=entryVirtual("Array").every,ep=Array.prototype,every=function(t){var a=t.every;return t===ep||H(ep,t)&&a===ep.every?Zf:a};var tp=function baseIsRegExp(t){return Gu(t)&&"[object RegExp]"==eu(t)},rp=Zu&&Zu.isRegExp,op=rp?Xu(rp):tp;var np=function setCacheAdd(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var ip=function setCacheHas(t){return this.__data__.has(t)};function SetCache(t){var a=-1,c=null==t?0:t.length;for(this.__data__=new Ud;++a<c;)this.add(t[a])}SetCache.prototype.add=SetCache.prototype.push=np,SetCache.prototype.has=ip;var ap=SetCache;var sp=function baseFindIndex(t,a,c,_){for(var h=t.length,m=c+(_?1:-1);_?m--:++m<h;)if(a(t[m],m,t))return m;return-1};var cp=function baseIsNaN(t){return t!=t};var up=function strictIndexOf(t,a,c){for(var _=c-1,h=t.length;++_<h;)if(t[_]===a)return _;return-1};var lp=function baseIndexOf(t,a,c){return a==a?up(t,a,c):sp(t,cp,c)};var dp=function arrayIncludes(t,a){return!!(null==t?0:t.length)&&lp(t,a,0)>-1};var fp=function arrayIncludesWith(t,a,c){for(var _=-1,h=null==t?0:t.length;++_<h;)if(c(a,t[_]))return!0;return!1};var pp=function cacheHas(t,a){return t.has(a)};var _p=function baseDifference(t,a,c,_){var h=-1,m=dp,g=!0,E=t.length,T=[],I=a.length;if(!E)return T;c&&(a=Hd(a,Xu(c))),_?(m=fp,g=!1):a.length>=200&&(m=pp,g=!1,a=new ap(a));e:for(;++h<E;){var N=t[h],M=null==c?N:c(N);if(N=_||0!==N?N:0,g&&M==M){for(var S=I;S--;)if(a[S]===M)continue e;T.push(N)}else m(a,M,_)||T.push(N)}return T},hp=ku((function(t,a){return Ef(t)?_p(t,a):[]})),mp=hp;function replacer(t,a){return a instanceof RegExp?"__REGEXP "+a.toString():a}function validate(t,a,c,_){var h;void 0===a&&(a={}),void 0===_&&(_=!1);var m={};return forEach$1(h=Ui(t)).call(h,(function(h){var g=t[h].type,E=c?"In "+c+", ":"";if(null==a){var T=E+"param is null or undefined";throw _?new Fc({detail:{reason:T,data:{key:h},rules:"required"}}):new Uc(T,{key:h},"required")}if(void 0===a[h]){if(!1===t[h].required)return void(m[h]=a[h]);var I=E+"param '"+h+"' is required";throw _?new Fc({detail:{reason:I,data:{key:h},rules:"required"}}):new Uc(I,{key:h},"required")}var N=gp[g];if(N&&!N(a,h,t[h],_)){var M=E+"param '"+h+"' unexpected",S={key:h,value:a[h]};throw _?new Fc({detail:{reason:M,data:S,rules:ws(t[h],replacer)}}):new Uc(M,S,ws(t[h],replacer))}m[h]=a[h]})),m}var gp={string:function string(t,a,c){var _=c.allowEmpty,h=c.max,m=c.min,g=c.regExp,E=t[a];return"string"==typeof E&&((!1!==_||""!==E)&&(!("number"==typeof h&&E.length>h)&&(!("number"==typeof m&&E.length<m)&&!(op(g)&&!g.test(E)))))},number:function number(t,a,c){var _=c.min,h=c.max,m=t[a];return"number"==typeof m&&(!("number"==typeof _&&m<_)&&!("number"==typeof h&&m>h))},boolean:function boolean(t,a){return"boolean"==typeof t[a]},file:function file(t,a){return!0},enum:function _enum(t,a,c){var _=values(c),h=t[a];return!_||indexOf(_).call(_,h)>-1},jsonstr:function jsonstr(t,a){try{var c=JSON.parse(t[a]);return"object"==typeof c&&null!==c}catch(t){return!1}},func:function func(t,a){return"function"==typeof t[a]},array:function array(t,a,c,_){var h;void 0===_&&(_=!1);var m=c.itemType,g=c.rules,E=c.min,T=c.max,I=values(c),N=t[a];return!!hl(N)&&(!("number"==typeof T&&N.length>T)&&(!("number"==typeof E&&N.length<E)&&(!(m&&"enum"!==m&&!every(N).call(N,(function(t){return typeof t===m})))&&(("enum"!==m||!I||!mp.apply(void 0,concat(h=[N]).call(h,I)).length)&&(g&&forEach$1(N).call(N,(function(t,c){return validate(g,t,a+"["+c+"]",_)})),!0)))))},object:function object(t,a,c,_){void 0===_&&(_=!1);var h=c.rules,m=c.allowEmpty,g=t[a];if("object"!=typeof g||null===g)return!1;if(h){var E=Ui(h),T=Ui(g),I=filter(T).call(T,(function(t){return indexOf(E).call(E,t)>-1}));if(!1===m&&0===I.length)return!1;validate(h,g,a,_)}return!0}},Ep=["error","warn","log","debug"],vp=function emptyFunc(){},yp=["off","error","warn","log","debug"],Tp=function(){function Logger(t){this.strategies={debug:{name:"debug",func:console.log},log:{name:"  log",func:console.log},warn:{name:" warn",func:console.warn},error:{name:"error",func:console.error}},this.debug=vp,this.log=vp,this.warn=vp,this.error=vp,includes(yp).call(yp,t)||(t="off"),this.setLogFunc(t)}var t=Logger.prototype;return t.setLogFunc=function setLogFunc(t){var a=this,c=findIndex(Ep).call(Ep,(function(a){return a===t}));forEach$1(Ep).call(Ep,(function(t,_){_<=c&&(a[t]=function(){var a=slice$1(Array.prototype).call(arguments),c=this.strategies[t],_=this.formatArgs(a,c.name);c.func(_)})}))},t.formatArgs=function formatArgs(t,a){var c=new Date;return"[NIM "+a+" "+(c.getMonth()+1+"-"+c.getDate()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+":"+c.getMilliseconds())+"] "+map$6(t).call(t,(function(t){return t instanceof Vc?t.toString():t instanceof Error?t&&t.message?t.message:t:"object"==typeof t?ws(t):t})).join(" ")},t.destroy=function destroy(){this.debug=vp,this.log=vp,this.warn=vp,this.error=vp},Logger}(),Ip=function(){function CoreAdapters(t){this.lastCommonHost="",this.core=t}var t=CoreAdapters.prototype;return t.getFileUploadInformation=function getFileUploadInformation(t){return jf.getFileUploadInformation(t)},t.request=function request(t,a,c){var _=this,h=(new Date).getTime(),m=(null==c?void 0:c.exception_service)||0;return jf.request(t,a).catch((function(c){var g,E,T,I,N=c;throw _.core.reporter.reportTraceStart("exceptions",{user_id:_.core.options.account||(null===(E=null===(g=_.core)||void 0===g?void 0:g.auth)||void 0===E?void 0:E.account),trace_id:null===(I=null===(T=_.core.clientSocket)||void 0===T?void 0:T.socket)||void 0===I?void 0:I.sessionId,start_time:h,action:1,exception_service:m}),_.core.reporter.reportTraceUpdateV2("exceptions",{code:"number"==typeof N.code?N.code:0,description:N.message||""+N.code,operation_type:0,target:t,context:a?ws(a):""},{asyncParams:jf.net.getNetworkStatus()}),_.core.reporter.reportTraceEnd("exceptions",1),c}))},t.uploadFile=function uploadFile(t){var a,c,_,h;return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var m,g,E,T,I,N,M,S,O,A,b,R,C,P;return cd.wrap((function _callee$(k){for(;;)switch(k.prev=k.next){case 0:N=indexOf(m=t.commonUploadHostBackupList).call(m,t.commonUploadHost),M=-1===N?concat(g=[t.commonUploadHost]).call(g,t.commonUploadHostBackupList):concat(E=[t.commonUploadHost]).call(E,slice$1(T=t.commonUploadHostBackupList).call(T,0,N),slice$1(I=t.commonUploadHostBackupList).call(I,N+1)),S=Math.max(indexOf(M).call(M,this.lastCommonHost),0),O="BROWSER"===jf.platform?1:M.length,A=null,b=0;case 6:if(!(b<O)){k.next=26;break}return R=(new Date).getTime(),this.lastCommonHost=M[(b+S)%M.length],k.prev=9,k.next=12,jf.uploadFile(Ct(Ct({},t),{commonUploadHost:this.lastCommonHost}));case 12:return k.abrupt("return",k.sent);case 15:k.prev=15,k.t0=k.catch(9),A=k.t0,C=k.t0,this.core.reporter.reportTraceStart("exceptions",{user_id:this.core.options.account||(null===(c=null===(a=this.core)||void 0===a?void 0:a.auth)||void 0===c?void 0:c.account),trace_id:null===(h=null===(_=this.core.clientSocket)||void 0===_?void 0:_.socket)||void 0===h?void 0:h.sessionId,start_time:R,action:1,exception_service:3}),P="BROWSER"===jf.platform?t.chunkUploadHost:this.lastCommonHost+"/"+(t.nosToken&&t.nosToken.bucket),this.core.reporter.reportTraceUpdateV2("exceptions",{code:"number"==typeof C.code?C.code:0,description:C.message||""+C.code,operation_type:1,target:P},{asyncParams:jf.net.getNetworkStatus()}),this.core.reporter.reportTraceEnd("exceptions",1);case 23:b++,k.next=6;break;case 26:throw A;case 27:case"end":return k.stop()}}),_callee,this,[[9,15]])})))},CoreAdapters}(),Np="https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",Mp="imElite_sdk_abtest_web",Sp=function(){function ABTest(t,a){this.abtInfo={},this.core=t,this.config=assignOptions({isAbtestEnable:!0,abtestUrl:Np,abtestProjectKey:Mp},a)}var t=ABTest.prototype;return t.setOptions=function setOptions(t){this.config=assignOptions(this.config,t)},t.abtRequest=function abtRequest(){var t,a;return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var c;return cd.wrap((function _callee$(_){for(;;)switch(_.prev=_.next){case 0:if(this.config.isAbtestEnable){_.next=2;break}return _.abrupt("return");case 2:if(!this.abtInfo.experiments){_.next=4;break}return _.abrupt("return");case 4:if(this.config.abtestUrl){_.next=6;break}return _.abrupt("return");case 6:return _.prev=6,_.next=9,this.core.adapters.request(this.config.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.config.abtestProjectKey,appKey:this.core.options.appkey,osType:"Web",sdkVersion:"10.4.0",deviceId:this.core.config.deviceId},useLocalCache:!0}},{exception_service:7});case 9:c=_.sent,_.next=15;break;case 12:_.prev=12,_.t0=_.catch(6),this.core.logger.warn("ABTest request failed");case 15:this.abtInfo=(null===(a=null===(t=null==c?void 0:c.data)||void 0===t?void 0:t.data)||void 0===a?void 0:a.abtInfo)||{};case 16:case"end":return _.stop()}}),_callee,this,[[6,12]])})))},ABTest}(),Op=TypeError,Ap=Object.getOwnPropertyDescriptor,bp=b&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,a){if(ei(t)&&!Ap(t,"length").writable)throw Op("Cannot set read only .length");return t.length=a}:function(t,a){return t.length=a},Rp=TypeError,deletePropertyOrThrow=function(t,a){if(!delete t[a])throw Rp("Cannot delete property "+tryToString(a)+" of "+tryToString(t))},Cp=arrayMethodHasSpeciesSupport("splice"),Pp=Math.max,kp=Math.min;_export({target:"Array",proto:!0,forced:!Cp},{splice:function splice(t,a){var c,_,h,m,g,E,T=toObject(this),I=lengthOfArrayLike(T),N=toAbsoluteIndex(t,I),M=arguments.length;for(0===M?c=_=0:1===M?(c=0,_=I-N):(c=M-2,_=kp(Pp(toIntegerOrInfinity(a),0),I-N)),doesNotExceedSafeInteger(I+c-_),h=arraySpeciesCreate(T,_),m=0;m<_;m++)(g=N+m)in T&&createProperty(h,m,T[g]);if(h.length=_,c<_){for(m=N;m<I-_;m++)E=m+c,(g=m+_)in T?T[E]=T[g]:deletePropertyOrThrow(T,E);for(m=I;m>I-_+c;m--)deletePropertyOrThrow(T,m-1)}else if(c>_)for(m=I-_;m>N;m--)E=m+c-1,(g=m+_-1)in T?T[E]=T[g]:deletePropertyOrThrow(T,E);for(m=0;m<c;m++)T[m+N]=arguments[m+2];return bp(T,I-_+c),h}});var wp=entryVirtual("Array").splice,xp=Array.prototype,splice=function(t){var a=t.splice;return t===xp||H(xp,t)&&a===xp.splice?wp:a};function _createForOfIteratorHelperLoose$1(t,a){var c,_=void 0!==Xl&&Zl(t)||t["@@iterator"];if(_)return bind$1(c=(_=_.call(t)).next).call(c,_);if(hl(t)||(_=function _unsupportedIterableToArray$1(t,a){var c;if(!t)return;if("string"==typeof t)return _arrayLikeToArray$1(t,a);var _=slice$1(c=Object.prototype.toString.call(t)).call(c,8,-1);"Object"===_&&t.constructor&&(_=t.constructor.name);if("Map"===_||"Set"===_)return El(t);if("Arguments"===_||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$1(t,a)}(t))||a&&t&&"number"==typeof t.length){_&&(t=_);var h=0;return function(){return h>=t.length?{done:!0}:{done:!1,value:t[h++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayLikeToArray$1(t,a){(null==a||a>t.length)&&(a=t.length);for(var c=0,_=new Array(a);c<a;c++)_[c]=t[c];return _}var Dp=function(){function TimerManager(){this.timerList=[],this.id=1,this.timer=null,this.timeout=0}var t=TimerManager.prototype;return t.addTimer=function addTimer(t,a,c){void 0===a&&(a=0),void 0===c&&(c=1);var _=(new Date).getTime(),h=this.id;return this.timerList.push({id:h,loop:c,count:0,timeout:_+a,interval:a,callback:t}),this.id++,this.checkTimer(_),h},t.checkTimer=function checkTimer(t){if(void 0===t&&(t=(new Date).getTime()),this.removeFinished(),0!==this.timerList.length||null==this.timer){for(var a,c,_=0,h=_createForOfIteratorHelperLoose$1(this.timerList);!(a=h()).done;){var m=a.value;(0===_||_>m.timeout)&&(_=m.timeout)}if(0!==this.timerList.length)if(null===this.timer||_<this.timeout||this.timeout<t)this.timer=hi(bind$1(c=this.nowTime).call(c,this),_-t),this.timeout=_}},t.nowTime=function nowTime(){for(var t,nowTime=(new Date).getTime(),a=_createForOfIteratorHelperLoose$1(this.timerList);!(t=a()).done;){var c=t.value;nowTime>=c.timeout&&(c.callback(),c.count++,c.timeout=nowTime+c.interval)}this.clerTime(),this.checkTimer(nowTime)},t.clerTime=function clerTime(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.deleteTimer=function deleteTimer(t){for(var a=this.timerList.length-1;a>=0;a--){var c;if(this.timerList[a].id===t)splice(c=this.timerList).call(c,a,1)}},t.removeFinished=function removeFinished(){for(var t=this.timerList.length-1;t>=0;t--){var a,c=this.timerList[t];if(c.loop>=0&&c.count>=c.loop)splice(a=this.timerList).call(a,t,1)}},t.destroy=function destroy(){this.clerTime(),this.timerList=[],this.id=1,this.timer=null},TimerManager}(),Lp=function(){function Service(t,a){this.name=t,this.core=a,this.name=t,this.logger=a.logger,this.core=a}return Service.prototype.process=function process(t){var a=this[t.cmd+"Handler"];if("function"==typeof a)return a.call(this,t);var c=Xd(t,"error.detail.ignore");return t.error&&!c?Jn.reject(t.error):Jn.resolve(t)},Service}(),Vp=Backoff;function Backoff(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),c=Math.floor(a*this.jitter*t);t=0==(1&Math.floor(10*a))?t-c:t+c}return 0|Math.min(t,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(t){this.ms=t},Backoff.prototype.setMax=function(t){this.max=t},Backoff.prototype.setJitter=function(t){this.jitter=t};var Up=mu(Hc,"Set");var Fp=function noop(){};var Gp=function setToArray(t){var a=-1,c=Array(t.size);return t.forEach((function(t){c[++a]=t})),c},jp=Up&&1/Gp(new Up([,-0]))[1]==1/0?function(t){return new Up(t)}:Fp,Bp=jp;var Yp=function baseUniq(t,a,c){var _=-1,h=dp,m=t.length,g=!0,E=[],T=E;if(c)g=!1,h=fp;else if(m>=200){var I=a?null:Bp(t);if(I)return Gp(I);g=!1,h=pp,T=new ap}else T=a?[]:E;e:for(;++_<m;){var N=t[_],M=a?a(N):N;if(N=c||0!==N?N:0,g&&M==M){for(var S=T.length;S--;)if(T[S]===M)continue e;a&&T.push(M),E.push(N)}else h(T,M,c)||(T!==E&&T.push(M),E.push(N))}return E};var Hp,Kp=function uniq(t){return t&&t.length?Yp(t):[]},Wp=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],qp=["transport not supported","client not handshaken","unauthorized"],zp=["reconnect"],$p=function(t){function BaseWebsocket(a,c){var _;return(_=t.call(this)||this).url=c,_.websocket=null,_.socketConnectTimer=0,_.core=a,_.url=c,_.status="disconnected",_.logger=a.logger,_.connect(),_}Mt(BaseWebsocket,t);var a=BaseWebsocket.prototype;return a.connect=function connect(){var t=this;"connecting"!==this.status&&"connected"!==this.status?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+Zn(),{method:"GET",dataType:"text",timeout:this.core.options.xhrConnectTimeout||8e3},{exception_service:6}).then((function(a){if("connecting"===t.status){var c=a.data.split(":"),_=c[0];return c[1],t.sessionId=_,t.logger.log("imsocket::XHR success. status "+t.status+", "+("connecting"===t.status?"continue websocket connection":"stop websocket connection")),t._createWebsocket("wss://"+t.url+"/socket.io/1/websocket/"+_)}})).catch((function(a){if("connecting"===t.status){var c='imsocket::XHR fail. raw message: "'+(a=a||{}).message+'", code: "'+a.code+'"',_=a.code;_="v2"===Xd(t.core,"options.apiVersion")?a.code===Dc.V2NIM_ERROR_CODE_CONNECT_TIMEOUT?Dc.V2NIM_ERROR_CODE_CONNECT_TIMEOUT:Dc.V2NIM_ERROR_CODE_CONNECT_FAILED:408===a.code?408:415;var h=new Vc({code:_,detail:{reason:c,rawError:a}});t.logger.error(c),t.status="disconnected",t.emit("handshakeFailed",h)}}))):this.logger.warn("imsocket::socket is connecting or connected",this.status)},a.close=function close(){if(this.status="disconnected",this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"}))}catch(t){this.logger.warn("imsocket::attempt to send encodePacket error",t)}try{this.websocket.close()}catch(t){this.logger.warn("imsocket::attempt to close websocket error",t)}this.clean(),this.emit("disconnect",{code:0,reason:"Active close websocket"})}},a.clean=function clean(){this.status="disconnected",this.websocket&&(this.socketUrl=void 0,this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null)},a.onConnect=function onConnect(){this.status="connected",this.emit("connect"),clearTimeout(this.socketConnectTimer)},a._createWebsocket=function _createWebsocket(t){var a,c=this;this.socketConnectTimer=hi((function(){c.logger.error("imsocket::Websocket connect timeout. url: ",c.socketUrl),c.emit("handshakeFailed",new Vc({code:"v2"===Xd(c.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_CONNECT_TIMEOUT:415,detail:{reason:"imsocket::Websocket connect timeout. url: "+c.socketUrl}}))}),this.core.options.socketConnectTimeout||8e3),this.socketUrl=t,this.websocket=new jf.WebSocket(t),this.websocket.onmessage=bind$1(a=this.onMessage).call(a,this),this.websocket.onclose=function(t){var a=(null==t?void 0:t.reason)||(null==t?void 0:t.message)||(null==t?void 0:t.errMsg)||"websocket.onclose";c.logger.log("imsocket::Websocket onclose done. code is "+(null==t?void 0:t.code)+" and reason is "+a),c.clean(),c.emit("disconnect",{code:(null==t?void 0:t.code)||0,reason:a})},this.websocket.onerror=function(t){c.logger.error("imsocket::Websocket onerror",t),"logined"===c.core.status&&c.core.clientSocket.ping()}},a.onMessage=function onMessage(t){var a,c=this.decodePacket(t.data);if(c)switch(c.type){case"connect":this.onConnect();break;case"disconnect":this.close(),this.emit("disconnect",{code:0,reason:"MessageEvent type disconnect"});break;case"message":case"json":this.emit("message",c.data);break;case"event":c.name&&this.emit(c.name,c.args);break;case"error":"unauthorized"===c.reason?this.emit("connect_failed",c.reason):this.emit("error",c.reason),this.logger.error("imsocket::Websocket connect failed, onmessage type error. url: ",this.socketUrl),clearTimeout(this.socketConnectTimer),this.emit("handshakeFailed",new Vc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_CONNECT_FAILED:408,detail:{reason:"imsocket::Websocket connect failed, onMessage socket error. url: "+this.socketUrl}}));break;case"heartbeat":null===(a=this.websocket)||void 0===a||a.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::Websocket no handler type",c.type)}},a.encodePacket=function encodePacket(t){var a,c,_=t.type,h=t.id,m=void 0===h?"":h,g=t.endpoint,E=void 0===g?"":g,T=t.ack,I=null;if(!_)return"";switch(_){case"error":a=t.reason?indexOf(qp).call(qp,t.reason):"",c=t.advice?indexOf(zp).call(zp,t.advice):"",""===a&&""===c||(I=a+(""!==c?"+"+c:""));break;case"message":""!==t.data&&(I=t.data);break;case"event":a={name:t.name},a=t.args&&t.args.length?{name:t.name,args:t.args}:{name:t.name},I=ws(a);break;case"json":I=ws(t.data);break;case"connect":t.qs&&(I=t.qs);break;case"ack":I=t.ackId+(t.args&&t.args.length?"+"+ws(t.args):"")}var N=[indexOf(Wp).call(Wp,_),m+("data"===T?"+":""),E];return null!=I&&N.push(I),N.join(":")},a.decodePacket=function decodePacket(t){if(t)if("ï¿½"!=t.charAt(0)){var a=t.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(a){var c,_=a[1],h=a[2],m=a[3],g=a[4],E=a[5],T={type:Wp[+_],endpoint:g};switch(h&&(T.id=h,T.ack=!m||"data"),T.type){case"error":c=E.split("+"),T.reason=qp[+c[0]]||"";break;case"message":T.data=E||"";break;case"connect":T.qs=E||"";break;case"event":try{var I=JSON.parse(E);T.name=I.name,T.args=I.args}catch(t){this.logger.error("imsocket::parseData::type::event error",t)}T.args=T.args||[];break;case"json":try{T.data=JSON.parse(E)}catch(t){this.logger.error("imsocket::parseData::type::json error",t)}break;case"ack":if((c=E.match(/^([0-9]+)(\+)?(.*)/))&&(T.ackId=c[1],T.args=[],c[3]))try{T.args=c[3]?JSON.parse(c[3]):[]}catch(t){this.logger.error("imsocket::parseData::type::ack error",t)}}return T}}else this.logger.error("imsocket::unrecognize dataStr",slice$1(t).call(t,0,20))},a.send=function send(t){var a,c={data:t,type:"message",endpoint:""};null===(a=this.websocket)||void 0===a||a.send(this.encodePacket(c))},BaseWebsocket}(mi);function _createForOfIteratorHelperLoose(t,a){var c,_=void 0!==Xl&&Zl(t)||t["@@iterator"];if(_)return bind$1(c=(_=_.call(t)).next).call(c,_);if(hl(t)||(_=function _unsupportedIterableToArray(t,a){var c;if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,a);var _=slice$1(c=Object.prototype.toString.call(t)).call(c,8,-1);"Object"===_&&t.constructor&&(_=t.constructor.name);if("Map"===_||"Set"===_)return El(t);if("Arguments"===_||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray(t,a)}(t))||a&&t&&"number"==typeof t.length){_&&(t=_);var h=0;return function(){return h>=t.length?{done:!0}:{done:!1,value:t[h++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayLikeToArray(t,a){(null==a||a>t.length)&&(a=t.length);for(var c=0,_=new Array(a);c<a;c++)_[c]=t[c];return _}!function(t){t[t.ACTIVE=1]="ACTIVE",t[t.KICKED=2]="KICKED",t[t.OFFLINE=3]="OFFLINE"}(Hp||(Hp={}));var Jp=function(){function V1ClientSocket(t,a){this.linkUrls=[],this.isAutoReconnect=!1,this.packetTimeout=3e4,this.packetSer=1,this.retryCount=0,this.reconnectTimer=0,this.backoff=new Vp({max:8e3,min:1600,jitter:.01}),this.sendingCmdMap=new is,this.pingTimer=0,this.hasNetworkListener=!1,this.core=t,a&&(this.auth=a),this.logger=t.logger,this.reporter=t.reporter,this.timerManager=t.timerManager}var t=V1ClientSocket.prototype;return t.setSessionId=function setSessionId(t){},t.connect=function connect(t,a){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,cd.mark((function _callee(){var c,_,h,m,g,E;return cd.wrap((function _callee$(T){for(;;)switch(T.prev=T.next){case 0:if(validate({linkUrls:{type:"array",itemType:"string",required:!1}},t),/^(unconnected|waitReconnect)$/.test(this.core.status)){T.next=5;break}return c="Core socket status is "+this.core.status+", and would not connect",this.logger.warn(c),T.abrupt("return",Jn.reject(c));case 5:this.core.status="connecting",t.linkUrls&&t.linkUrls.length>0&&(this.linkUrls=concat(_=t.linkUrls).call(_,this.linkUrls),this.linkUrls=Kp(this.linkUrls)),0===this.linkUrls.length&&this.linkUrls.push("weblink.netease.im:443"),h=0;case 9:if(!(h<this.linkUrls.length)){T.next=31;break}return m=this.linkUrls[h],g=(new Date).getTime(),T.prev=12,T.next=15,this.doConnect(m);case 15:return this.core.status="connected",this.logger.log("clientsocketV1::connect success with url: "+m),T.abrupt("return",m);case 20:T.prev=20,T.t0=T.catch(12),E=T.t0,a&&a(E,m),this.reporter.reportTraceStart("exceptions",{user_id:this.core.options.account,start_time:g,action:0,exception_service:6}),this.reporter.reportTraceUpdateV2("exceptions",{code:"number"==typeof E.code?E.code:0,description:E.message||""+E.code,operation_type:0,target:m},{asyncParams:jf.net.getNetworkStatus()}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("clientsocketV1::connect failed with url: "+m,T.t0);case 28:h++,T.next=9;break;case 31:throw 0===this.retryCount?this.doDisconnect(Hp.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(Hp.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("clientSocketV1::socket xhr or socket connect failed");case 33:case"end":return T.stop()}}),_callee,this,[[12,20]])})))},t.doConnect=function doConnect(t){var a=this,c=!1;return new Jn((function(_,h){var m;a.socket=new $p(a.core,t),a.socket.on("connect",(function(){a.logger.log("clientSocketV1::on connect",t),a.core.reporterHookLinkKeep&&(a.core.reporterHookLinkKeep.start(),a.core.reporterHookLinkKeep.update({code:0,description:"connection begin",operation_type:0,target:t})),c=!0,_()})),a.socket.on("message",bind$1(m=a.onMessage).call(m,a)),a.socket.on("disconnect",(function(_){return __awaiter(a,void 0,void 0,cd.mark((function _callee2(){return cd.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:if(this.logger.log("clientSocketV1::socket on disconnect",_),!this.core.reporterHookLinkKeep){a.next=5;break}return a.next=4,this.core.reporterHookLinkKeep.update({code:(null==_?void 0:_.code)||0,description:(null==_?void 0:_.reason)||"socket on disconnect",operation_type:1,target:t});case 4:this.core.reporterHookLinkKeep.end(!1);case 5:c=!0,this.doDisconnect(Hp.OFFLINE,"SocketOnDisconnect");case 7:case"end":return a.stop()}}),_callee2,this)})))})),a.socket.on("handshakeFailed",(function(t){c?a.ping():(a.logger.error('clientsocketV1::handshake failed: "'+(t&&t.message)+'"'),a.cleanSocket()),c=!0,h(t)}))}))},t.cleanSocket=function cleanSocket(){this.socket&&("function"==typeof this.socket.removeAllListeners&&this.socket.removeAllListeners(),"function"==typeof this.socket.close&&this.socket.close(),this.socket=void 0)},t.beforeConnect=function beforeConnect(){this.reconnectTimer&&clearTimeout(this.reconnectTimer)},t.resetConnectStatus=function resetConnectStatus(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},t.doDisconnect=function doDisconnect(t,a,c){var _,h,m,g,E;if(this.logger.log("doDisconnect: type "+t+", description "+a),"unconnected"!==this.core.status){var T={1:"close",2:"kicked",3:"broken"}[t]||"";this.markAllCmdInvaild(new Vc({code:415,desc:"Packet timeout due to instance disconnect",detail:{reason:"Packet timeout due to instance disconnect",disconnect_reason:T}})),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.cleanSocket();var I=!this.core.options.needReconnect||this.retryCount>=this.core.options.reconnectionAttempts;if(t===Hp.ACTIVE||I)this.logger.log("doDisconnect: emit disconnect, type "+t,I),this.core.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.core.eventBus.emit("disconnect"),this.core.emit("disconnect"),null===(_=this.auth)||void 0===_||_.emit("disconnect"),this.destroyOnlineListener();else if(t===Hp.KICKED){this.logger.log("doDisconnect: kicked"),this.core.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var N="string"==typeof a?{reason:"unknow",message:a}:a;this.core.eventBus.emit("kicked",N),this.core.emit("kicked",N),null===(h=this.auth)||void 0===h||h.emit("kicked",N),this.destroyOnlineListener()}else t===Hp.OFFLINE&&this.core.V1NIMLoginService.isManualLoginAttempt?(this.logger.log("doDisconnect: offline in manual login phase. no reconnect"),this.core.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.destroyOnlineListener()):t===Hp.OFFLINE&&(null===(g=null===(m=this.auth)||void 0===m?void 0:m.authenticator)||void 0===g?void 0:g.checkLoginTerminalCode(null==c?void 0:c.code))?(this.logger.log("doDisconnect: login terminal code "+(null==c?void 0:c.code)+", no reconnect"),this.core.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.destroyOnlineListener(),this.core.eventBus.emit("disconnect"),this.core.emit("disconnect"),null===(E=this.auth)||void 0===E||E.emit("disconnect")):t===Hp.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},t.attempToReconnect=function attempToReconnect(){var t,a,c=this;if("waitReconnect"!==this.core.status){0===this.retryCount&&(this.core.eventBus.emit("disconnect"),this.core.emit("disconnect"),null===(t=this.auth)||void 0===t||t.emit("disconnect"));var _=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+_),this.core.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:_}),this.core.emit("willReconnect",{retryCount:this.retryCount,duration:_}),null===(a=this.auth)||void 0===a||a.emit("willReconnect",{retryCount:this.retryCount,duration:_}),this.core.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=hi((function(){return __awaiter(c,void 0,void 0,cd.mark((function _callee3(){var t=this;return cd.wrap((function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:if("waitReconnect"===this.core.status){a.next=3;break}return this.logger.warn("doDisconnect: reconnectTimer status is "+this.core.status+", would not go on reconnecting"),a.abrupt("return");case 3:return a.next=5,jf.net.getNetworkStatus();case 5:!1===a.sent.net_connect?(this.logger.log("doDisconnect: skip this reconnection attempt because network is offline"),this.core.status="connecting",this.retryCount>=this.core.options.reconnectionAttempts?this.doDisconnect(Hp.OFFLINE,"MaxReconnectionAttemptExceed"):this.attempToReconnect()):this.core.V1NIMLoginService.login({isAutoReconnect:!0}).catch((function(){t.logger.error("clientsocketV1::attempToReconnect failed "+t.retryCount)}));case 7:case"end":return a.stop()}}),_callee3,this)})))}),_)}else this.logger.warn("doDisconnect: already is waiting reconnect")},t.sendCmd=function sendCmd(t,a,c){var _=this;if("logined"!==this.core.status&&"login"!==t&&"chatroomLogin"!==t&&"qchatLogin"!==t)return this.logger.warn("instance status is "+this.core.status+", so can not sendCmd "+t),Jn.reject({cmd:t,error:{code:"No_connected",message:"Connection not established",timetag:(new Date).getTime()}});if(!this.socket||!this.socket.send)return Jn.reject("No_socket");var h="heartbeat"!==t,m=h?this.packetSer++:0,g=function createCmd(t,a,c,_){var h=Wf[t];if(!h)return c.error("createCmd:: can not find cmd config: ",t),null;var m,g={SER:a,SID:h.sid,CID:h.cid,Q:[]};return h.params&&_&&forEach$1(m=h.params).call(m,(function(t){var a=_[t.name];if(null!=a){var c=t.type,h=t.reflectMapper,m=t.select;switch(t.type){case"PropertyArray":c="ArrayMable",a=map$6(a).call(a,(function(t){return{t:"Property",v:h?serialize(t,h,m):t}}));break;case"Property":a=h?serialize(a,h,m):a;break;case"Bool":a=a?"true":"false"}g.Q.push({t:c,v:a})}})),{packet:g,hasPacketResponse:"boolean"!=typeof h.hasPacketResponse||h.hasPacketResponse,hasPacketTimer:"boolean"!=typeof h.hasPacketTimer||h.hasPacketTimer}}(t,m,this.logger,a);if(!g){var E="SendCmd "+m+" "+t+" error";return this.logger.error(E),Jn.reject(new Error(E))}var T=g.packet,I=g.hasPacketResponse,N=g.hasPacketTimer,M=ws(T);h&&("debug"===this.core.options.debugLevel?this.logger.debug("clientsocketV1::sendCmd",t,"ser:"+m,M):this.logger.log("clientsocketV1::sendCmd",t,"ser:"+m));var S=(new Date).getTime();return new Jn((function(h,g){I&&_.sendingCmdMap.set(m,{cmd:t,params:a,callback:[h,g],timer:N?hi((function(){var a=new Vc({code:408,desc:"Packet Timeout",detail:{reason:"Packet Timeout",cmd:t,ser:m,timetag:Zn()}});_.markCmdInvalid(m,a,t)}),c&&c.timeout?c.timeout:_.core.config.timeout):null});try{_.socket.send(M),I||h(T)}catch(a){var E=new Vc({code:415,detail:{reason:a&&a.message||"Unable to send packet",cmd:t,ser:m,timetag:Zn(),rawError:a}});_.markCmdInvalid(m,E,t),g(a)}})).catch((function(t){var a,c=[408,415];if(!includes(c).call(c,t.code))return Jn.reject(t);_.reporter.reportTraceStart("exceptions",{user_id:_.core.options.account,trace_id:null===(a=_.socket)||void 0===a?void 0:a.sessionId,start_time:S,action:2,exception_service:6});var h=Xd(t,"data.disconnect_reason")||"",m=408===t.code?"Send failed due to timeout":"Send failed. Reason unknown";return m=415===t.code?ws({disconnect_reason:h}):m,_.reporter.reportTraceUpdateV2("exceptions",{code:t.code||415,description:m,operation_type:1,target:T.SID+"-"+T.CID,context:""+T.SER},{asyncParams:jf.net.getNetworkStatus()}),_.reporter.reportTraceEnd("exceptions",1),Jn.reject(t)}))},t.onMessage=function onMessage(t){var a=function parseCmd(t,a){var c,_;try{_=JSON.parse(t)}catch(c){return void a.error('Parse command error:"'+t+'"')}var h=_.sid+"_"+_.cid,m=_.r;if(includes(c=["4_1","4_2","4_10","4_11"]).call(c,h)){var g=_.r[1].headerPacket;h=g.sid+"_"+g.cid,_.sid=g.sid,_.cid=g.cid,m=_.r[1].body}var E=qf[h],T=[];if(E){for(var I,N=_createForOfIteratorHelperLoose$2(E);!(I=N()).done;){var M=I.value;T.push(parseEachCmd(_,M.config,M.cmd,m,a))}return T}a.error("parseCmd:: mapper not exist",h,_.code)}(t,this.logger);if(a)for(var c,_=_createForOfIteratorHelperLoose(a);!(c=_()).done;){var h=c.value,m=h.raw.ser;if(h.error&&this.logger.error("core:onMessage packet error",h.raw.sid+"_"+h.raw.cid+", ser:"+m+",",h.error),h.notFound)return void this.logger.warn("clientsocketV1::onMessage packet not found",h.raw.sid+"_"+h.raw.cid+", ser:"+m);"heartbeat"!==h.cmd&&("debug"===this.core.options.debugLevel?this.logger.debug("imsocket::recvCmd ser:"+m,h.cmd,h.content):this.logger.log("imsocket::recvCmd ser:"+m,h.cmd)),this.packetHandler(h)}},t.packetHandler=function packetHandler(t){var a,c;if(t){var _=t.raw.ser,h=this.sendingCmdMap.get(_);if(h&&h.cmd===t.cmd){var m=h.callback,g=h.timer,E=h.params;if(clearTimeout(g),t.params=E,this.sendingCmdMap.delete(_),"heartbeat"===t.cmd)return void m[0]();var T=null===(a=this.core[t.service])||void 0===a?void 0:a.process(t);T&&"function"==typeof T.then?T.then((function(t){m[0](t)})).catch((function(t){m[1](t)})):(this.logger.log("imsocket:: handlerFn without promise",t.service,t.cmd),m[0]())}else null===(c=this.core[t.service])||void 0===c||c.process(t)}},t.markCmdInvalid=function markCmdInvalid(t,a,c){var _=this.sendingCmdMap.get(t);if(_){var h=_.callback,m=_.timer;m&&clearTimeout(m),this.sendingCmdMap.delete(t),this.logger.warn("packet "+t+", "+c+" is invalid:",a),h[1](a)}},t.markAllCmdInvaild=function markAllCmdInvaild(t){var a,c=this;this.logger.log("markAllCmdInvaild",t),forEach$1(a=this.sendingCmdMap).call(a,(function(a){var _=a.callback,h=a.timer,m=a.cmd;c.logger.debug('markAllCmdInvaild:: cmd "'+m+'"'),h&&clearTimeout(h),_[1](t)})),this.sendingCmdMap.clear()},t.ping=function ping(){var t;return __awaiter(this,void 0,void 0,cd.mark((function _callee4(){var a=this;return cd.wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:return clearTimeout(this.pingTimer),c.prev=1,c.next=4,this.sendCmd("heartbeat");case 4:c.next=18;break;case 6:return c.prev=6,c.t0=c.catch(1),c.next=10,this.testHeartBeat5Timeout();case 10:if(!c.sent){c.next=18;break}if(!this.core.reporterHookLinkKeep){c.next=16;break}return c.next=15,this.core.reporterHookLinkKeep.update({code:0,description:"Heartbeat-discovered link failure",operation_type:1,target:null===(t=this.socket)||void 0===t?void 0:t.url});case 15:this.core.reporterHookLinkKeep.end(!0);case 16:return this.doDisconnect(Hp.OFFLINE,"PingError"),c.abrupt("return");case 18:this.pingTimer=hi((function(){a.ping()}),3e4);case 19:case"end":return c.stop()}}),_callee4,this,[[1,6]])})))},t.testHeartBeat5Timeout=function testHeartBeat5Timeout(){return __awaiter(this,void 0,void 0,cd.mark((function _callee5(){var t;return cd.wrap((function _callee5$(a){for(;;)switch(a.prev=a.next){case 0:clearTimeout(this.pingTimer),t=0;case 2:if(!(t<5)){a.next=15;break}return a.prev=3,a.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return a.abrupt("return",!1);case 9:a.prev=9,a.t0=a.catch(3),this.logger.debug("clientsocketV1:: test heartbeat "+t+" Timeout");case 12:t++,a.next=2;break;case 15:return a.abrupt("return",!0);case 16:case"end":return a.stop()}}),_callee5,this,[[3,9]])})))},t.initOnlineListener=function initOnlineListener(){var t=this;this.hasNetworkListener||(this.logger.log("clientsocketV1::onlineListener:init"),this.hasNetworkListener=!0,jf.net.onNetworkStatusChange((function(a){t.logger.log("clientsocketV1::onlineListener:network change",a),a.isConnected&&"logined"===t.core.status?t.ping():a.isConnected&&"waitReconnect"===t.core.status?(t.reconnectTimer&&clearTimeout(t.reconnectTimer),t.core.V1NIMLoginService.login({isAutoReconnect:!0}).catch((function(){t.logger.error("clientsocketV1::attempToReconnect failed "+t.retryCount)}))):a.isConnected||t.doDisconnect(Hp.OFFLINE,"OfflineListener")})))},t.destroyOnlineListener=function destroyOnlineListener(){this.logger.log("clientsocketV1::onlineListener:destroy"),jf.net.offNetworkStatusChange(),this.hasNetworkListener=!1},t.disconnect=function disconnect(){switch(this.core.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(Hp.ACTIVE,"UserActiveDisconnect"),Jn.resolve();default:return Jn.resolve()}},V1ClientSocket}();var Qp=function baseForOwn(t,a){return t&&cf(t,a,ll)};var Xp=function baseInverter(t,a,c,_){return Qp(t,(function(t,h,m){a(_,c(t),h,m)})),_};var Zp,e_,t_=function createInverter(t,a){return function(c,_){return Xp(c,t,a(_),{})}},r_=Object.prototype.toString,o_=t_((function(t,a,c){null!=a&&"function"!=typeof a.toString&&(a=r_.call(a)),t[a]=c}),Au(Nu));function formatChatroom(t){var a=Ct({},t),c=["announcement","broadcastUrl","ext"],_=["createTime","updateTime","onlineMemberNum"],h=["mute"];return forEach$1(c).call(c,(function(t){void 0===a[t]&&(a[t]="")})),forEach$1(_).call(_,(function(t){void 0!==a[t]&&(a[t]=pa(a[t]))})),forEach$1(h).call(h,(function(t){void 0!==a[t]&&(a[t]=1===pa(a[t]))})),a}!function(t){t[t.Android=1]="Android",t[t.iOS=2]="iOS",t[t.PC=4]="PC",t[t.WindowsPhone=8]="WindowsPhone",t[t.Web=16]="Web",t[t.Server=32]="Server",t[t.Mac=64]="Mac",t[t.HarmonyOS=65]="HarmonyOS"}(Zp||(Zp={})),function(t){t[t.text=0]="text",t[t.image=1]="image",t[t.audio=2]="audio",t[t.video=3]="video",t[t.geo=4]="geo",t[t.notification=5]="notification",t[t.file=6]="file",t[t.tip=10]="tip",t[t.robot=11]="robot",t[t.g2=12]="g2",t[t.custom=100]="custom"}(e_||(e_={}));var n_=o_({unset:"-2",restricted:"-1",common:"0",owner:"1",manager:"2",guest:"3",anonymous:"4"});function formatChatroomMember(t){var a,c=Ct({},t),_=["chatroomId"],h=["level","enterTime","updateTime","tempMuteDuration"],m=["online","guest","blacked","muted","valid","tempMuted"],g={tempMuted:!1,tempMuteDuration:0};return forEach$1(a=Ui(g)).call(a,(function(t){c[t]=c[t]||g[t]})),forEach$1(_).call(_,(function(t){void 0!==c[t]&&(c[t]=c[t].toString())})),forEach$1(h).call(h,(function(t){void 0!==c[t]&&(c[t]=pa(c[t]))})),forEach$1(m).call(m,(function(t){void 0!==c[t]&&(c[t]=1===pa(c[t]))})),void 0!==c.type&&(c.type=n_[c.type]),c.avatar,c.online||delete c.enterTime,c.guest&&(c.type="guest",delete c.valid,delete c.guest),"common"!==c.type&&delete c.level,c}function formatChatroomMembers(t){return t&&t.length>0?map$6(t).call(t,(function(t){return formatChatroomMember(t)})):[]}function generatorMsgForCmd(t,a,c){t.onSendBefore;var _=__rest(t,["onSendBefore"]),h=["subType"],m=["body","antiSpamContent","antiSpamBusinessId","ext"],g=["resend","needAntiSpam","antiSpamUsingYidun","skipHistory","highPriority","clientAntiSpam"];return t.resend||(_.idClient=_l()),_.type=e_[t.type],_.from=a,_.fromClientType=16,_.fromDeviceId=c,_.status=_.status||"sending",forEach$1(g).call(g,(function(a){void 0!==t[a]&&(_[a]=t[a]?1:0)})),forEach$1(h).call(h,(function(a){void 0!==t[a]&&(_[a]=pa(t[a]))})),forEach$1(m).call(m,(function(a){void 0!==t[a]&&(_[a]="string"==typeof t[a]?t[a]:ws(t[a]))})),_}var i_={301:"memberEnter",302:"memberExit",303:"blackMember",304:"unblackMember",305:"gagMember",306:"ungagMember",307:"addManager",308:"removeManager",309:"addCommon",310:"removeCommon",311:"closeChatroom",312:"updateChatroom",313:"kickMember",314:"addTempMute",315:"removeTempMute",316:"updateMemberInfo",317:"updateQueue",318:"muteRoom",319:"unmuteRoom",320:"batchUpdateQueue",321:"addTempMuteTag",322:"removeTempMuteTag",323:"deleteChatroomMsg",325:"updateChatroomTags"};function formatChatroomMsg(t,a){t.onUploadDone,t.onUploadProgress,t.onUploadStart;var c=__rest(t,["onUploadDone","onUploadProgress","onUploadStart"]),_=["time","userUpdateTime"],h=["resend","needAntiSpam","antiSpamUsingYidun","skipHistory","highPriority","clientAntiSpam"];if(forEach$1(_).call(_,(function(t){void 0!==c[t]&&(c[t]=pa(c[t]))})),forEach$1(h).call(h,(function(t){void 0!==c[t]&&(c[t]=1===pa(c[t]))})),c.type=getEnumKeyByEnumValue(e_,c.type),c.fromClientType=getEnumKeyByEnumValue(Zp,c.fromClientType),c.flow=c.from===a?"out":"in",c.status=c.status||"success","string"==typeof c.body)try{c.body=JSON.parse(c.body)}catch(t){}return"notification"===c.type&&(c.attach=c.body?function formatNotificationBody(t){var a,c={};if(c.type=i_[t.id]||t.id,!t.data)return t;c=Ct(c,t.data);var _={operator:"from",opeNick:"fromNick",target:"to",tarNick:"toNick"};forEach$1(a=Ui(_)).call(a,(function(t){void 0!==c[t]&&(c[_[t]]=c[t],delete c[t])}));var h=["muteDuration"];if(forEach$1(h).call(h,(function(t){void 0!==c[t]&&(c[t]=pa(c[t]))})),!c.queueChange)return c;var m={};try{m=JSON.parse(c.queueChange)}catch(t){return c}switch(m._e){case"OFFER":m={type:"OFFER",elementKey:m.key,elementValue:m.content};break;case"POLL":m={type:"POLL",elementKey:m.key,elementValue:m.content};break;case"DROP":m={type:"DROP"};break;case"PARTCLEAR":case"BATCH_UPDATE":m={type:m._e,elementKv:m.kvObject}}return c.queueChange=m,c}(c.body):{},c.body=""),c}function formatChatroomMsgs(t,a){return t&&t.length>0?map$6(t).call(t,(function(t){return formatChatroomMsg(t,a)})):[]}var a_={1:{code:"chatroomClosed",message:"Chatroom is closed"},2:{code:"managerKick",message:"Kicked out by owners or administrators"},3:{code:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},4:{code:"silentlyKick",message:"Quietly kicked"},5:{code:"blacked",message:"Was blacklisted"}};var s_,c_,u_=function(){function V1AuthAuthenticatorService(t){this.core=t}return V1AuthAuthenticatorService.prototype.verifyAuthentication=function verifyAuthentication(t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,cd.mark((function _callee(){var a,c,_,h,m,g,E,T;return cd.wrap((function _callee$(I){for(;;)switch(I.prev=I.next){case 0:return c=this.core.options,_=jf.getSystemInfo(),h=Ct(Ct({},c),{appLogin:t?0:1,deviceId:this.core.config.deviceId,clientSession:this.core.config.clientSession,clientType:16,protocolVersion:1,sdkVersion:100400,sdkHumanVersion:"10.4.0",os:_.os,browser:_.browser,userAgent:this.core.options.loginSDKTypeParamCompat?"Native/10.4.0":slice$1(a=_.userAgent).call(a,0,299),libEnv:this.core.options.loginSDKTypeParamCompat?void 0:_.libEnv,hostEnv:this.core.options.loginSDKTypeParamCompat?0:_.hostEnvEnum}),m=Ct(Ct({},c),{appkey:c.appkey,account:c.account,deviceId:this.core.config.deviceId,clientSession:this.core.config.clientSession,appLogin:1}),c.isAnonymous&&(m.isAnonymous=1,m.account=m.account||"nimanon_"+_l(),h.account=m.account,m.chatroomNick=m.account||"nimanon_"+_l(),m.chatroomAvatar=m.chatroomAvatar||" "),c.tags&&c.tags.length>0&&(m.tags=ws(c.tags)),I.next=8,this.core.clientSocket.sendCmd("chatroomLogin",{type:1,chatroomLogin:m,chatroomIMLogin:h});case 8:return g=I.sent,this.core.status="logined",E=formatChatroom(g.content.chatroom),T=formatChatroomMember(g.content.chatroomMember),I.abrupt("return",{chatroom:E,member:T});case 13:case"end":return I.stop()}}),_callee,this)})))},V1AuthAuthenticatorService}(),l_=function(t){function ChatroomAuthService(a){var c;return(c=t.call(this,"chatroomAuth",a)||this).account="",c.token="",c.deviceId="",c.isManualLoginAttempt=!1,c.authenticatorService=new u_(a),c}Mt(ChatroomAuthService,t);var a=ChatroomAuthService.prototype;return a.login=function login(t){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,cd.mark((function _callee(){var a,c;return cd.wrap((function _callee$(_){for(;;)switch(_.prev=_.next){case 0:return t.isAutoReconnect||(this.isManualLoginAttempt=!0),a=Zn(),_.next=4,this._connect(t);case 4:return c=_.sent,this.core.abtest.abtRequest(),_.prev=6,_.next=9,this.doLogin(t.isAutoReconnect,c,a);case 9:this.isManualLoginAttempt=!1,_.next=16;break;case 12:throw _.prev=12,_.t0=_.catch(6),this.isManualLoginAttempt=!1,_.t0;case 16:case"end":return _.stop()}}),_callee,this,[[6,12]])})))},a._connect=function _connect(t){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,cd.mark((function _callee2(){var a,c,_;return cd.wrap((function _callee2$(h){for(;;)switch(h.prev=h.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.core.status)){h.next=4;break}return a="Chatroom status is "+this.core.status+", and would not connect",this.logger.warn(a),h.abrupt("return",Jn.reject(a));case 4:return this.core.clientSocket.beforeConnect(),c=t.isAutoReconnect||!1,h.next=8,this.core.clientSocket.connect({linkUrls:this.core.options.chatroomAddresses,isAutoReconnect:c});case 8:return _=h.sent,h.abrupt("return",_);case 10:case"end":return h.stop()}}),_callee2,this)})))},a.doLogin=function doLogin(t,a,c){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,cd.mark((function _callee3(){var _,h,m,g,E,T,I;return cd.wrap((function _callee3$(N){for(;;)switch(N.prev=N.next){case 0:return N.prev=0,N.next=3,this.authenticatorService.verifyAuthentication(t);case 3:return _=N.sent,N.next=6,jf.net.getNetworkStatus();case 6:h=N.sent,m=h.net_connect,this.core.status="logined",this.core.reporter.report("chatroomLogin",{accid:this.core.account,roomId:this.core.options.chatroomId,serverIps:this.core.options.chatroomAddresses,currentServerIp:a,rt:Zn()-c,result:200,failReason:"",time:Zn(),net_connect:m}),N.next=26;break;case 12:return N.prev=12,N.t0=N.catch(0),this.logger.error("chatroom login error",N.t0),g=Xd(N.t0,"error.code")||Xd(N.t0,"code")||408,E=Xd(N.t0,"error.message")||Xd(N.t0,"message")||"login failed",N.next=19,jf.net.getNetworkStatus();case 19:if(T=N.sent,I=T.net_connect,this.core.reporter.report("chatroomLogin",{accid:this.core.account,roomId:this.core.options.chatroomId,serverIps:this.core.options.chatroomAddresses,currentServerIp:a,rt:Zn()-c,result:g,failReason:E,time:Zn(),net_connect:I}),this.core.clientSocket.doDisconnect(Hp.OFFLINE,this.isManualLoginAttempt?"FailedToInitializeLogin":"ReconnectLoginFailed"),!this.isManualLoginAttempt){N.next=25;break}throw N.t0;case 25:return N.abrupt("return");case 26:return N.prev=26,N.next=29,this.core.cloudStorage.init();case 29:N.next=34;break;case 31:N.prev=31,N.t1=N.catch(26),this.logger.error("NIM:login cloudStorage init failed ",N.t1);case 34:this.core.eventBus.emit("logined",_),this.core.emit("logined",_),this.core.clientSocket.resetConnectStatus(),this.core.clientSocket.ping(),this.core.timeOrigin.setOriginTimetick();case 39:case"end":return N.stop()}}),_callee3,this,[[0,12],[26,31]])})))},a.beKickedFromChatroomHandler=function beKickedFromChatroomHandler(t){var a=t.content,c=a.reason,_=a.ext,h=function formatKickedReason(t){var a=a_[t];return{reason:a?a.code:"unknow",message:a?a.message:"Unknown reason"}}(c);this.logger.warn("beKickedFromChatroomHandler:: ",h.reason,h.message,_),this.core.clientSocket.doDisconnect(Hp.KICKED,h)},ChatroomAuthService}(Lp),d_=function(t){function ChatroomService(a){return t.call(this,"chatroom",a)||this}Mt(ChatroomService,t);var a=ChatroomService.prototype;return a.getInfo=function getInfo(){var t;return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var a;return cd.wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.core.sendCmd("getChatroom");case 2:return a=c.sent,c.abrupt("return",formatChatroom(null===(t=a.content)||void 0===t?void 0:t.chatroom));case 4:case"end":return c.stop()}}),_callee,this)})))},a.updateInfo=function updateInfo(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){return cd.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return validate({chatroom:{type:"object",rules:{name:{type:"string",required:!1},announcement:{type:"string",required:!1},broadcastUrl:{type:"string",required:!1},ext:{type:"string",required:!1},queuelevel:{type:"number",min:0,max:1,required:!1}}},needNotify:{type:"boolean"},ext:{type:"string",required:!1}},t),a.next=3,this.core.sendCmd("updateChatroom",Ct(Ct({},t),{ext:t.ext||""}));case 3:case"end":return a.stop()}}),_callee2,this)})))},a.updateChatroomTagHandler=function updateChatroomTagHandler(t){var a,c=t.content;this.logger.log("updateChatroomTagHandler:: ",c);var _=null===(a=null==c?void 0:c.updateTags)||void 0===a?void 0:a.currentTags;try{_=JSON.parse(_)}catch(t){this.logger.error("updateChatroomTagHandler:: ",t)}this.core.emit("tagsUpdate",_)},ChatroomService}(Lp),f_=getDefaultExportFromCjs(createCommonjsModule((function(t){function _defineProperties(t,a){for(var c=0;c<a.length;c++){var _=a[c];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),vi(t,_.key,_)}}t.exports=function _createClass(t,a,c){return a&&_defineProperties(t.prototype,a),c&&_defineProperties(t,c),vi(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}))),p_={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},__={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function getUploadResponseFormat(t){return void 0===t&&(t="file"),ws(p_[t]||{}).replace(/"/gi,'\\"')}!function(t){t[t.nos=1]="nos",t[t.s3=2]="s3"}(s_||(s_={})),function(t){t[t.dontNeed=-1]="dontNeed",t[t.time=2]="time",t[t.urls=3]="urls"}(c_||(c_={}));var h_={chunkUploadHost:"https://wannos-web.127.net",commonUploadHost:"https://fileup.chatnos.com",commonUploadHostBackupList:["https://oss.chatnos.com"],chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim-nosdn.netease.im",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0};var m_=function arraySome(t,a){for(var c=-1,_=null==t?0:t.length;++c<_;)if(a(t[c],c,t))return!0;return!1};var g_=function equalArrays(t,a,c,_,h,m){var g=1&c,E=t.length,T=a.length;if(E!=T&&!(g&&T>E))return!1;var I=m.get(t),N=m.get(a);if(I&&N)return I==a&&N==t;var M=-1,S=!0,O=2&c?new ap:void 0;for(m.set(t,a),m.set(a,t);++M<E;){var A=t[M],b=a[M];if(_)var R=g?_(b,A,M,a,t,m):_(A,b,M,t,a,m);if(void 0!==R){if(R)continue;S=!1;break}if(O){if(!m_(a,(function(t,a){if(!pp(O,a)&&(A===t||h(A,t,c,_,m)))return O.push(a)}))){S=!1;break}}else if(A!==b&&!h(A,b,c,_,m)){S=!1;break}}return m.delete(t),m.delete(a),S};var E_=function mapToArray(t){var a=-1,c=Array(t.size);return t.forEach((function(t,_){c[++a]=[_,t]})),c},v_=Kc?Kc.prototype:void 0,y_=v_?v_.valueOf:void 0;var T_=function equalByTag(t,a,c,_,h,m,g){switch(c){case"[object DataView]":if(t.byteLength!=a.byteLength||t.byteOffset!=a.byteOffset)return!1;t=t.buffer,a=a.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=a.byteLength||!m(new lf(t),new lf(a)));case"[object Boolean]":case"[object Date]":case"[object Number]":return vu(+t,+a);case"[object Error]":return t.name==a.name&&t.message==a.message;case"[object RegExp]":case"[object String]":return t==a+"";case"[object Map]":var E=E_;case"[object Set]":var T=1&_;if(E||(E=Gp),t.size!=a.size&&!T)return!1;var I=g.get(t);if(I)return I==a;_|=2,g.set(t,a);var N=g_(E(t),E(a),_,h,m,g);return g.delete(t),N;case"[object Symbol]":if(y_)return y_.call(t)==y_.call(a)}return!1};var I_=function arrayPush(t,a){for(var c=-1,_=a.length,h=t.length;++c<_;)t[h+c]=a[c];return t};var N_=function baseGetAllKeys(t,a,c){var _=a(t);return qu(t)?_:I_(_,c(t))};var M_=function arrayFilter(t,a){for(var c=-1,_=null==t?0:t.length,h=0,m=[];++c<_;){var g=t[c];a(g,c,t)&&(m[h++]=g)}return m};var S_=function stubArray(){return[]},O_=Object.prototype.propertyIsEnumerable,A_=Object.getOwnPropertySymbols,b_=A_?function(t){return null==t?[]:(t=Object(t),M_(A_(t),(function(a){return O_.call(t,a)})))}:S_,R_=b_;var C_=function getAllKeys(t){return N_(t,ll,R_)},P_=Object.prototype.hasOwnProperty;var k_=function equalObjects(t,a,c,_,h,m){var g=1&c,E=C_(t),T=E.length;if(T!=C_(a).length&&!g)return!1;for(var I=T;I--;){var N=E[I];if(!(g?N in a:P_.call(a,N)))return!1}var M=m.get(t),S=m.get(a);if(M&&S)return M==a&&S==t;var O=!0;m.set(t,a),m.set(a,t);for(var A=g;++I<T;){var b=t[N=E[I]],R=a[N];if(_)var C=g?_(R,b,N,a,t,m):_(b,R,N,t,a,m);if(!(void 0===C?b===R||h(b,R,c,_,m):C)){O=!1;break}A||(A="constructor"==N)}if(O&&!A){var P=t.constructor,k=a.constructor;P==k||!("constructor"in t)||!("constructor"in a)||"function"==typeof P&&P instanceof P&&"function"==typeof k&&k instanceof k||(O=!1)}return m.delete(t),m.delete(a),O},w_=mu(Hc,"DataView"),x_=mu(Hc,"Promise"),D_=mu(Hc,"WeakMap"),L_="[object Map]",V_="[object Promise]",U_="[object Set]",F_="[object WeakMap]",G_="[object DataView]",j_=su(w_),B_=su(Cd),Y_=su(x_),H_=su(Up),K_=su(D_),W_=eu;(w_&&W_(new w_(new ArrayBuffer(1)))!=G_||Cd&&W_(new Cd)!=L_||x_&&W_(x_.resolve())!=V_||Up&&W_(new Up)!=U_||D_&&W_(new D_)!=F_)&&(W_=function(t){var a=eu(t),c="[object Object]"==a?t.constructor:void 0,_=c?su(c):"";if(_)switch(_){case j_:return G_;case B_:return L_;case Y_:return V_;case H_:return U_;case K_:return F_}return a});var q_=W_,z_="[object Arguments]",$_="[object Array]",J_="[object Object]",Q_=Object.prototype.hasOwnProperty;var X_=function baseIsEqualDeep(t,a,c,_,h,m){var g=qu(t),E=qu(a),T=g?$_:q_(t),I=E?$_:q_(a),N=(T=T==z_?J_:T)==J_,M=(I=I==z_?J_:I)==J_,S=T==I;if(S&&$u(t)){if(!$u(a))return!1;g=!0,N=!1}if(S&&!N)return m||(m=new af),g||tl(t)?g_(t,a,c,_,h,m):T_(t,a,T,c,_,h,m);if(!(1&c)){var O=N&&Q_.call(t,"__wrapped__"),A=M&&Q_.call(a,"__wrapped__");if(O||A){var b=O?t.value():t,R=A?a.value():a;return m||(m=new af),h(b,R,c,_,m)}}return!!S&&(m||(m=new af),k_(t,a,c,_,h,m))};var Z_=function baseIsEqual(t,a,c,_,h){return t===a||(null==t||null==a||!Gu(t)&&!Gu(a)?t!=t&&a!=a:X_(t,a,c,_,baseIsEqual,h))};var eh=function baseIsMatch(t,a,c,_){var h=c.length,m=h,g=!_;if(null==t)return!m;for(t=Object(t);h--;){var E=c[h];if(g&&E[2]?E[1]!==t[E[0]]:!(E[0]in t))return!1}for(;++h<m;){var T=(E=c[h])[0],I=t[T],N=E[1];if(g&&E[2]){if(void 0===I&&!(T in t))return!1}else{var M=new af;if(_)var S=_(I,N,T,t,a,M);if(!(void 0===S?Z_(N,I,3,_,M):S))return!1}}return!0};var th=function isStrictComparable(t){return t==t&&!tu(t)};var rh=function getMatchData(t){for(var a=ll(t),c=a.length;c--;){var _=a[c],h=t[_];a[c]=[_,h,th(h)]}return a};var oh=function matchesStrictComparable(t,a){return function(c){return null!=c&&(c[t]===a&&(void 0!==a||t in Object(c)))}};var nh=function baseMatches(t){var a=rh(t);return 1==a.length&&a[0][2]?oh(a[0][0],a[0][1]):function(c){return c===t||eh(c,t,a)}};var ih=function baseHasIn(t,a){return null!=t&&a in Object(t)};var ah=function hasPath(t,a,c){for(var _=-1,h=(a=$d(a,t)).length,m=!1;++_<h;){var g=Jd(a[_]);if(!(m=null!=t&&c(t,g)))break;t=t[g]}return m||++_!=h?m:!!(h=null==t?0:t.length)&&wu(h)&&Lu(g,h)&&(qu(t)||Wu(t))};var sh=function hasIn(t,a){return null!=t&&ah(t,a,ih)};var ch=function baseMatchesProperty(t,a){return fd(t)&&th(a)?oh(Jd(t),a):function(c){var _=Xd(c,t);return void 0===_&&_===a?sh(c,t):Z_(a,_,3)}};var uh=function baseProperty(t){return function(a){return null==a?void 0:a[t]}};var lh=function basePropertyDeep(t){return function(a){return Qd(a,t)}};var dh=function property(t){return fd(t)?uh(Jd(t)):lh(t)};var fh=function baseIteratee(t){return"function"==typeof t?t:null==t?Nu:"object"==typeof t?qu(t)?ch(t[0],t[1]):nh(t):dh(t)};var ph=function baseSet(t,a,c,_){if(!tu(t))return t;for(var h=-1,m=(a=$d(a,t)).length,g=m-1,E=t;null!=E&&++h<m;){var T=Jd(a[h]),I=c;if("__proto__"===T||"constructor"===T||"prototype"===T)return t;if(h!=g){var N=E[T];void 0===(I=_?_(N,T,E):void 0)&&(I=tu(N)?N:Lu(a[h+1])?[]:{})}Tu(E,T,I),E=E[T]}return t};var _h=function basePickBy(t,a,c){for(var _=-1,h=a.length,m={};++_<h;){var g=a[_],E=Qd(t,g);c(E,g)&&ph(m,$d(g,t),E)}return m},hh=Object.getOwnPropertySymbols?function(t){for(var a=[];t;)I_(a,R_(t)),t=mf(t);return a}:S_;var mh=function getAllKeysIn(t){return N_(t,Rf,hh)};var gh=function pickBy(t,a){if(null==t)return{};var c=Hd(mh(t),(function(t){return[t]}));return a=fh(a),_h(t,c,(function(t,c){return a(t,c[0])}))},Eh=function(){function NOS(t,a){this.nosCdnHostTimer=0,this.nosErrorCount=0,this.core=t,this.cloudStorage=a}var t=NOS.prototype;return t.reset=function reset(){this.nosErrorCount=0},t.getNosAccessToken=function getNosAccessToken(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var a,c,_;return cd.wrap((function _callee$(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.core.sendCmd("getNosAccessToken",{tag:t});case 2:return a=h.sent,c=Xd(a,"content.nosAccessTokenTag.token"),_=t.url,h.abrupt("return",{token:c,url:-1!==indexOf(_).call(_,"?")?_+"&token="+c:_+"?token="+c});case 6:case"end":return h.stop()}}),_callee,this)})))},t.deleteNosAccessToken=function deleteNosAccessToken(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){return cd.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.core.sendCmd("deleteNosAccessToken",{tag:t});case 2:case"end":return a.stop()}}),_callee2,this)})))},t.nosUpload=function nosUpload(t,a){var c,_,h,m,g,E,T,I;return __awaiter(this,void 0,void 0,cd.mark((function _callee3(){var N,M,S,O,A,b,R,C,P,k,w,x,D,L,V,U,G,j,B;return cd.wrap((function _callee3$(Y){for(;;)switch(Y.prev=Y.next){case 0:if(N=Xd(this.core,"config.cdn.bucket"),M={tag:t.nosScenes||N||"nim"},t.nosSurvivalTime&&(M.expireSec=t.nosSurvivalTime),S=this.core.adapters.getFileUploadInformation(t),!(!a&&!S)){Y.next=18;break}return Y.prev=6,Y.next=9,this.core.sendCmd("getNosToken",{responseBody:getUploadResponseFormat(t.type),nosToken:M});case 9:O=Y.sent,Y.next=18;break;case 12:if(Y.prev=12,Y.t0=Y.catch(6),this.core.logger.error("uploadFile:: getNosToken error",Y.t0),!(Y.t0 instanceof Vc)){Y.next=17;break}throw Y.t0;case 17:throw new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:400,detail:{reason:"getNosToken error",rawError:Y.t0,curProvider:1}});case 18:return A=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",S?null===(c=S.uploadInfo)||void 0===c?void 0:c.objectName:a?null==a?void 0:a.objectName:O.content.nosToken.objectName),b="",a&&a.shortUrl&&(b=a.shortUrl),(null===(m=null===(h=null===(_=null==S?void 0:S.uploadInfo)||void 0===_?void 0:_.payload)||void 0===h?void 0:h.mixStoreToken)||void 0===m?void 0:m.shortUrl)&&(b=S.uploadInfo.payload.mixStoreToken.shortUrl),R=b||A,Y.prev=23,P=S?{token:null===(g=null==S?void 0:S.uploadInfo)||void 0===g?void 0:g.token,bucket:null===(E=null==S?void 0:S.uploadInfo)||void 0===E?void 0:E.bucketName,objectName:null===(T=null==S?void 0:S.uploadInfo)||void 0===T?void 0:T.objectName}:a||O.content.nosToken,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:P,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,commonUploadHostBackupList:this.config.commonUploadHostBackupList,platform:jf.platform}),k="BROWSER"===jf.platform?this.config.chunkUploadHost:this.config.commonUploadHost+"/"+(P&&P.bucket),this.core.reporterHookCloudStorage.update({remote_addr:k,operation_type:a?2:0}),Y.next=30,this.core.adapters.uploadFile(Ct(Ct(Ct({},t),{nosToken:P,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,commonUploadHostBackupList:this.config.commonUploadHostBackupList,maxSize:t.maxSize||this.config.chunkMaxSize}),a?{payload:{mixStoreToken:a}}:{}));case 30:C=Y.sent,Y.next=65;break;case 33:if(Y.prev=33,Y.t1=Y.catch(23),this.core.logger.error("uploadFile::nos uploadFile error:",Y.t1),w="v2"===Xd(this.core,"options.apiVersion"),Y.t1.code!==Dc.V2NIM_ERROR_CODE_CANCELLED&&10499!==Y.t1.errCode){Y.next=39;break}throw new Gc({code:w?Dc.V2NIM_ERROR_CODE_CANCELLED:400,detail:{reason:Xd(Y.t1,"message")||"Request abort",rawError:Y.t1,curProvider:1}});case 39:if(!w||Y.t1.errCode!==Dc.V2NIM_ERROR_CODE_FILE_OPEN_FAILED){Y.next=41;break}throw new Vc({code:Dc.V2NIM_ERROR_CODE_FILE_OPEN_FAILED,detail:{reason:Xd(Y.t1,"message")||"Read file failed",rawError:Y.t1,curProvider:1}});case 41:return Y.next=43,jf.net.getNetworkStatus();case 43:if(x=Y.sent,!1!==x.net_connect){Y.next=47;break}throw new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:400,detail:{reason:"No network",rawError:Y.t1,curProvider:1}});case 47:if(!a){Y.next=64;break}if(0!==this.nosErrorCount){Y.next=60;break}Y.prev=49,this.cloudStorage.mixStorage._addCircuitTimer(),Y.next=56;break;case 53:throw Y.prev=53,Y.t2=Y.catch(49),new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:400,detail:{reason:"All upload attempts failed",rawError:Y.t2,curProvider:this.cloudStorage.mixStorage.curProvider,mixStorePolicy:this.cloudStorage.mixStorage.mixStorePolicy,file:t.file||t.filePath}});case 56:return this.nosErrorCount=Xd(this.cloudStorage,"mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry"),Y.abrupt("return",this.cloudStorage._uploadFile(t));case 60:return this.nosErrorCount--,Y.abrupt("return",this.nosUpload(t,a));case 62:Y.next=65;break;case 64:throw new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:400,detail:{reason:"NOS attempts failed",rawError:Y.t1,curProvider:1}});case 65:if(D=null==C?void 0:C.type,(L=D&&indexOf(D).call(D,"/")>-1?slice$1(D).call(D,0,indexOf(D).call(D,"/")):"")||(L=t.type||""),(V={image:"imageInfo",video:"vinfo",audio:"vinfo"})[L]){Y.next=71;break}return Y.abrupt("return",Ct({url:R},C));case 71:return Y.prev=71,Y.next=74,this.core.adapters.request(A+"?"+V[L],{method:"GET",dataType:"json",timeout:5e3},{exception_service:3});case 74:U=Y.sent,Y.next=81;break;case 77:return Y.prev=77,Y.t3=Y.catch(71),this.core.logger.error("uploadFile:: fetch file info error",Y.t3),Y.abrupt("return",Ct({url:R},C));case 81:if(!U){Y.next=88;break}return G=U.data,j="imageInfo"===V[L]?G:null===(I=null==G?void 0:G.GetVideoInfo)||void 0===I?void 0:I.VideoInfo,B={url:R,name:C.name,size:C.size,ext:C.ext,w:null==j?void 0:j.Width,h:null==j?void 0:j.Height,orientation:null==j?void 0:j.Orientation,dur:null==j?void 0:j.Duration,audioCodec:null==j?void 0:j.AudioCodec,videoCodec:null==j?void 0:j.VideoCodec,container:null==j?void 0:j.Container},Y.abrupt("return",gh(B,(function(t,a){return void 0!==a})));case 88:return Y.abrupt("return",Ct({url:R},C));case 89:case"end":return Y.stop()}}),_callee3,this,[[6,12],[23,33],[49,53],[71,77]])})))},t._getNosCdnHost=function _getNosCdnHost(){var t;return __awaiter(this,void 0,void 0,cd.mark((function _callee4(){var a,c,_,h=this;return cd.wrap((function _callee4$(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,this.core.sendCmd("getNosCdnHost");case 3:a=m.sent,m.next=10;break;case 6:return m.prev=6,m.t0=m.catch(0),this.core.logger.error("getNosCdnHost::error",m.t0),m.abrupt("return");case 10:if(a){m.next=12;break}return m.abrupt("return");case 12:c=null===(t=null==a?void 0:a.content)||void 0===t?void 0:t.nosConfigTag,0!==(_=pa(null==c?void 0:c.expire))&&c.cdnDomain?-1===_?(this.config.cdn.bucket=c.bucket,this.config.cdn.cdnDomain=c.cdnDomain,this.config.cdn.objectNamePrefix=c.objectNamePrefix):(this.config.cdn.bucket=c.bucket,this.config.cdn.cdnDomain=c.cdnDomain,this.config.cdn.objectNamePrefix=c.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer((function(){h._getNosCdnHost()}),1e3*_)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return m.stop()}}),_callee4,this,[[0,6]])})))},f_(NOS,[{key:"config",get:function get(){return this.cloudStorage.config}}]),NOS}(),vh={"6_2":"getNosToken","6_22":"getOriginUrl","6_24":"getNosAccessToken","6_25":"deleteNosAccessToken","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},yh={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,nosSurvivalTime:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3}},Th={getNosToken:{sid:6,cid:2,service:"cloudStorage",params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:yh.nosToken}],response:[{type:"Property",name:"nosToken",reflectMapper:o_(yh.nosToken)}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:yh.nosSafeUrlTag}],response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:o_(yh.nosSafeUrlTag)}]},getNosCdnHost:{sid:6,cid:26,service:"cloudStorage",response:[{type:"Property",name:"nosConfigTag",reflectMapper:o_(yh.nosConfigTag)}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",params:[{type:"Property",name:"config"}],response:[{type:"Property",name:"grayConfigTag",reflectMapper:o_(yh.grayConfigTag)}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:o_(yh.mixStorePolicyTag)}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:yh.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:o_(yh.mixStoreTokenResTag)}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:yh.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:o_(yh.mixStoreAuthTokenResTag)}]},getNosAccessToken:{sid:6,cid:24,service:"cloudStorage",params:[{type:"Property",name:"tag",reflectMapper:yh.nosAccessTokenTag}],response:[{type:"Property",name:"tag",reflectMapper:o_(yh.nosAccessTokenTag)}]},deleteNosAccessToken:{sid:6,cid:25,service:"cloudStorage",params:[{type:"Property",name:"tag",reflectMapper:yh.nosAccessTokenTag}]}},Ih=function(){function MixStorage(t,a){this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=s_.nos,this.mixStoreErrorCount=10,this.circuitTimer=0,this.core=t,this.cloudStorage=a,this.logger=t.logger}var t=MixStorage.prototype;return t.reset=function reset(){this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=s_.nos,this.mixStoreErrorCount=10},t.getGrayscaleConfig=function getGrayscaleConfig(t){var a;return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var c,_;return cd.wrap((function _callee$(h){for(;;)switch(h.prev=h.next){case 0:if(jf.localStorage)try{jf.localStorage.getItem&&jf.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(jf.localStorage.getItem(this.GRAYKEY))[t])}catch(t){jf.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",t)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<(new Date).getTime())){h.next=17;break}return h.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(c=h.sent).content||!c.content.grayConfigTag){h.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(c.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(c.content.grayConfigTag.ttl)}catch(t){this.logger.error("getGrayscaleConfig error",t)}if(this.grayConfig){h.next=10;break}return h.abrupt("return");case 10:_=jf.localStorage.getItem(this.GRAYKEY)?JSON.parse(jf.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=(new Date).getTime(),_[t]=this.grayConfig,jf.localStorage.setItem(this.GRAYKEY,ws(_)),h.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",c.content);case 17:if(!(null===(a=this.grayConfig)||void 0===a?void 0:a.mixStoreEnable)){h.next=20;break}return h.next=20,this._getMixStorePolicy(t);case 20:case"end":return h.stop()}}),_callee,this)})))},t._getMixStorePolicy=function _getMixStorePolicy(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){var a,c,_,h,m,g,E;return cd.wrap((function _callee2$(T){for(;;)switch(T.prev=T.next){case 0:if(a=(new Date).getTime(),jf.localStorage)try{this.mixStorePolicy=JSON.parse(jf.localStorage.getItem(this.MIXSTOREKEY))[t],this.curProvider=pa(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>a&&(_=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-a,this.core.timerManager.addTimer(bind$1(c=this._getMixStorePolicy).call(c,this,t),_))}catch(a){jf.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(jf.localStorage.getItem(this.MIXSTOREKEY))[t]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",a)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=a)){T.next=30;break}return T.prev=3,T.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.cloudStorage.aws.s3?[1,2]:[1]});case 6:m=T.sent,g=m.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(g.ttl),this.mixStorePolicy.providers=g.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=pa(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=g.nosPolicy?JSON.parse(g.nosPolicy):null,this.mixStorePolicy.s3Policy=g.s3Policy?JSON.parse(g.s3Policy):null,null===this.mixStorePolicy.s3Policy?this.mixStorePolicy.providers=["1"]:null===this.mixStorePolicy.nosPolicy?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(bind$1(h=this._getMixStorePolicy).call(h,this,t),1e3*this.mixStorePolicy.ttl),E=jf.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(jf.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=(new Date).getTime(),E[t]=this.mixStorePolicy,jf.localStorage.setItem(this.MIXSTOREKEY,ws(E)),T.next=30;break;case 23:if(T.prev=23,T.t0=T.catch(3),this.logger.error("getMixStorePolicy error",T.t0),0!==this.mixStoreErrorCount){T.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(t),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.cloudStorage.nos.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return T.stop()}}),_callee2,this,[[3,23]])})))},t._addCircuitTimer=function _addCircuitTimer(){var t=this,a=this.mixStorePolicy.providers,c=a[(indexOf(a).call(a,String(this.curProvider))+1)%a.length];if(!c)throw new Error("uploadFile nextProvider error");if(c===a[0])throw new Error("uploadFile all policy fail");if(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+c),this.curProvider=pa(c),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy){var _=this.mixStorePolicy[this.curProvider===s_.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!_||0===_)throw new Error("uploadFile circuit error");this.circuitTimer=this.core.timerManager.addTimer((function(){t.logger.log("uploadFile:: upload policy will change,now policy:"+t.curProvider+" nextProvider:"+pa(t.mixStorePolicy.providers[0])),t.curProvider=pa(t.mixStorePolicy.providers[0]),t.core.timerManager.deleteTimer(t.circuitTimer)}),1e3*_)}throw new Error("uploadFile will not retry again")},t.getFileAuthToken=function getFileAuthToken(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee3(){var a;return cd.wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:t});case 2:return a=c.sent,c.abrupt("return",a.content.mixStoreAuthTokenResTag);case 4:case"end":return c.stop()}}),_callee3,this)})))},MixStorage}(),Nh=ia.trim,Mh=A("".charAt),Sh=h.parseFloat,Oh=h.Symbol,Ah=Oh&&Oh.iterator,bh=1/Sh(ea+"-0")!=-1/0||Ah&&!fails((function(){Sh(Object(Ah))}))?function parseFloat(t){var a=Nh(toString$1(t)),c=Sh(a);return 0===c&&"-"==Mh(a,0)?-0:c}:Sh;_export({global:!0,forced:parseFloat!=bh},{parseFloat:bh});var Rh,Ch=Y.parseFloat,Ph=function(){function AWS(t,a){this.s3=null,this.core=t,this.cloudStorage=a,this.logger=t.logger}var t=AWS.prototype;return t.s3Upload=function s3Upload(t,a){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){var c,_,h,m,g,E,T,I,N,M,S=this;return cd.wrap((function _callee2$(O){for(;;)switch(O.prev=O.next){case 0:if(!t.file){O.next=4;break}c=t.file,O.next=19;break;case 4:if("string"!=typeof t.fileInput){O.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((_=document.getElementById(t.fileInput))&&_.files&&_.files[0])){O.next=11;break}c=_.files[0],O.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:O.next=19;break;case 14:if(!(t.fileInput&&t.fileInput.files&&t.fileInput.files[0])){O.next=18;break}c=t.fileInput.files[0],O.next=19;break;case 18:throw new Error("Can not get file from fileInput "+t.fileInput);case 19:if(this.mixStorePolicy.s3Policy){O.next=21;break}throw new Error("dont get s3 policy");case 21:return h={accessKeyId:a.accessKeyId,secretAccessKey:a.secretAccessKey,sessionToken:a.sessionToken,region:a.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},m=this.s3,(g=new m).config.update(h),E=decodeURIComponent(a.bucket),T=decodeURIComponent(a.objectName),N={Bucket:E,Key:T,Body:I=c,Metadata:{token:a.token},ContentType:I.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",N),(M=g.upload(N)).on("httpUploadProgress",(function(a){var c=Ch((a.loaded/a.total).toFixed(2));t.onUploadProgress&&t.onUploadProgress({total:a.total,loaded:a.loaded,percentage:c,percentageText:Math.round(100*c)+"%"})})),O.abrupt("return",new Jn((function(c,_){var h=(new Date).getTime();M.send((function(m,g){return __awaiter(S,void 0,void 0,cd.mark((function _callee(){var N,M,S,O,A,b,R,C;return cd.wrap((function _callee$(P){for(;;)switch(P.prev=P.next){case 0:if(!m||"RequestAbortedError"!==m.code){P.next=5;break}this.logger.error("uploadFile:","api::s3:upload file abort.",m),_(new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_CANCELLED:400,detail:{reason:"S3RequestAbortedError",rawError:m,curProvider:2}})),P.next=42;break;case 5:if(!m){P.next=26;break}return this.logger.error("uploadFile:","api::s3:upload file failed.",m),this.core.reporter.reportTraceStart("exceptions",{user_id:this.core.options.account||(null===(M=null===(N=this.core)||void 0===N?void 0:N.auth)||void 0===M?void 0:M.account),trace_id:null===(S=this.core.clientSocket.socket)||void 0===S?void 0:S.sessionId,start_time:h,action:1,exception_service:4}),this.core.reporter.reportTraceUpdateV2("exceptions",{code:"number"==typeof m.status?m.status:"number"==typeof m.code?m.code:0,description:m.message||""+m.code,operation_type:1,target:ws({bucket:E,object:T})},{asyncParams:jf.net.getNetworkStatus()}),this.core.reporter.reportTraceEnd("exceptions",1),P.next=12,jf.net.getNetworkStatus();case 12:if(O=P.sent,!1!==O.net_connect){P.next=16;break}return P.abrupt("return",_(new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:400,detail:{reason:"No network",rawError:m,curProvider:this.cloudStorage.mixStorage.curProvider}})));case 16:P.prev=16,this.cloudStorage.mixStorage._addCircuitTimer(),P.next=23;break;case 20:return P.prev=20,P.t0=P.catch(16),P.abrupt("return",_(new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:400,detail:{reason:"All upload attempts failed",rawError:P.t0,curProvider:this.cloudStorage.mixStorage.curProvider,mixStorePolicy:this.mixStorePolicy,file:t.file||t.filePath}})));case 23:c(this.cloudStorage._uploadFile(t)),P.next=42;break;case 26:if(A=(A=this.mixStorePolicy.s3Policy.cdnSchema).replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn),this.core.reporterHookCloudStorage.update({remote_addr:A,operation_type:1}),A=A.replace("{objectName}",g.Key),b={size:I.size,name:I.name,url:a.shortUrl?a.shortUrl:A,ext:I.name.split(".")[1]||"unknown"},R=t.type||"",(C={image:"imageInfo"})[R]){P.next=37;break}return P.abrupt("return",c(b));case 37:return P.t1=c,P.next=40,this.getS3FileInfo({url:A,infoSuffix:C[R],s3Result:b});case 40:return P.t2=P.sent,P.abrupt("return",(0,P.t1)(P.t2));case 42:case"end":return P.stop()}}),_callee,this,[[16,20]])})))})),t.onUploadStart&&t.onUploadStart(M)})));case 33:case"end":return O.stop()}}),_callee2,this)})))},t.getS3FileInfo=function getS3FileInfo(t){var a;return __awaiter(this,void 0,void 0,cd.mark((function _callee3(){var c,_,h,m,g,E,T;return cd.wrap((function _callee3$(I){for(;;)switch(I.prev=I.next){case 0:return c=t.url,_=t.infoSuffix,h=t.s3Result,I.prev=1,I.next=4,this.core.adapters.request(c+"?"+_,{method:"GET",dataType:"text",timeout:5e3},{exception_service:3});case 4:m=I.sent,I.next=11;break;case 7:return I.prev=7,I.t0=I.catch(1),this.core.logger.error("uploadFile:: fetch file info error",I.t0),I.abrupt("return",h);case 11:if(!m){I.next=18;break}return g=m.data,E="imageInfo"===_?g:null===(a=null==g?void 0:g.GetVideoInfo)||void 0===a?void 0:a.VideoInfo,T=Ct(Ct({},h),{w:null==E?void 0:E.Width,h:null==E?void 0:E.Height,orientation:null==E?void 0:E.Orientation,dur:null==E?void 0:E.Duration,audioCodec:null==E?void 0:E.AudioCodec,videoCodec:null==E?void 0:E.VideoCodec,container:null==E?void 0:E.Container}),I.abrupt("return",gh(T,(function(t,a){return void 0!==a})));case 18:return this.core.logger.error("uploadFile:: fetch s3 file info no result",c+"?"+_),I.abrupt("return",h);case 20:case"end":return I.stop()}}),_callee3,this,[[1,7]])})))},f_(AWS,[{key:"mixStorePolicy",get:function get(){return this.cloudStorage.mixStorage.mixStorePolicy}}]),AWS}(),kh=function(){function CloudStorageService(t,a){void 0===a&&(a={}),this.config={},this.uploadTaskMap={},this.name="cloudStorage",this.logger=t.logger,this.core=t,this.nos=new Eh(t,this),this.mixStorage=new Ih(t,this),this.aws=new Ph(t,this),registerParser({cmdMap:vh,cmdConfig:Th}),this.setOptions(a),this.setListeners()}var t=CloudStorageService.prototype;return t.setOptions=function setOptions(t){void 0===t&&(t={});var a=t.storageKeyPrefix||"NIMClient";this.mixStorage.GRAYKEY=a+"-AllGrayscaleConfig",this.mixStorage.MIXSTOREKEY=a+"-AllMixStorePolicy";var c=t.s3,_=__rest(t,["s3"]),h=Ct({},h_,this.config);if(_&&Object.prototype.hasOwnProperty.call(_,"cdn")){var m=Ct(Ct({},h.cdn),_.cdn);this.config=Ct({},h,_),this.config.cdn=m}else this.config=Ct({},h,_);c&&(this.aws.s3=c)},t.setListeners=function setListeners(){var t,a,c,_;this.core.eventBus.on("kicked",bind$1(t=this._clearUnCompleteTask).call(t,this)),this.core.eventBus.on("disconnect",bind$1(a=this._clearUnCompleteTask).call(a,this)),this.core.eventBus.on("V2NIMLoginService/loginLifeCycleLogout",bind$1(c=this._clearUnCompleteTask).call(c,this)),this.core.eventBus.on("V2NIMLoginService/loginLifeCycleKicked",bind$1(_=this._clearUnCompleteTask).call(_,this))},t._clearUnCompleteTask=function _clearUnCompleteTask(){var t,a=this;forEach$1(t=Ui(this.uploadTaskMap)).call(t,(function(t){var c=a.uploadTaskMap[t];c&&c.abort&&c.abort()})),this.uploadTaskMap={}},t.init=function init(){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){return cd.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(this.mixStorage.reset(),this.nos.reset(),!this.config.isNeedToGetUploadPolicyFromServer){t.next=5;break}return t.next=5,this.mixStorage.getGrayscaleConfig(this.core.options.appkey);case 5:return t.next=7,this.nos._getNosCdnHost();case 7:case"end":return t.stop()}}),_callee,this)})))},t.processCallback=function processCallback(t,a){var c=this,_=t.onUploadProgress,h=t.onUploadDone,m=t.onUploadStart;return{onUploadStart:"function"==typeof m?function(t){c.uploadTaskMap[a]=t;try{m(t)}catch(t){c.logger.error("CloudStorage::uploadFile:options.onUploadStart execute error",t)}}:function(t){c.uploadTaskMap[a]=t},onUploadProgress:"function"==typeof _?function(t){c.core.reporterHookCloudStorage.update({transferred_size:t.loaded});try{_(t)}catch(t){c.logger.error("CloudStorage::uploadFile:options.onUploadProgress execute error",t)}}:function(t){c.core.reporterHookCloudStorage.update({transferred_size:t.loaded})},onUploadDone:"function"==typeof h?function(t){c.core.reporterHookCloudStorage.end(0);try{h(t)}catch(t){c.logger.error("CloudStorage::uploadFile:options.onUploadDone execute error",t)}}:function(){c.core.reporterHookCloudStorage.end(0)},taskKey:a}},t.uploadFile=function uploadFile(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){var a,c,_,h,m,g,E,T;return cd.wrap((function _callee2$(I){for(;;)switch(I.prev=I.next){case 0:if(validate({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},t),t.fileInput||t.file||t.filePath){I.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!t.type||"file"===t.type){I.next=7;break}if(!(a=Xd(t,"file.type"))||"string"!=typeof a||-1!==indexOf(a).call(a,t.type)){I.next=7;break}throw new Error('The meta type "'+a+'" does not match "'+t.type+'"');case 7:return this.core.reporterHookCloudStorage.start(),t.file?this.core.reporterHookCloudStorage.update({full_size:t.file.size}):"string"==typeof t.fileInput?(c=document.getElementById(t.fileInput))&&c.files&&c.files[0]&&this.core.reporterHookCloudStorage.update({full_size:c.files[0].size}):t.fileInput&&t.fileInput.files&&t.fileInput.files[0]&&this.core.reporterHookCloudStorage.update({full_size:t.fileInput.files[0].size}),_=_l(),h=this.processCallback(t,_),m=h.onUploadStart,g=h.onUploadProgress,E=h.onUploadDone,t.onUploadStart=m,t.onUploadProgress=g,t.onUploadDone=E,T=null,I.prev=15,I.next=18,this._uploadFile(t);case 18:T=I.sent,t.md5&&(T.md5=t.md5),delete this.uploadTaskMap[_],I.next=28;break;case 23:throw I.prev=23,I.t0=I.catch(15),delete this.uploadTaskMap[_],this.core.reporterHookCloudStorage.end((I.t0&&I.t0.code)===Dc.V2NIM_ERROR_CODE_CANCELLED?3:1),I.t0;case 28:return T&&(T.size=void 0===T.size?void 0:Number(T.size),T.w=void 0===T.w?void 0:Number(T.w),T.h=void 0===T.h?void 0:Number(T.h),T.dur=void 0===T.dur?void 0:Number(T.dur)),T.url=decodeURIComponent(T.url),t.onUploadDone({size:T.size,name:T.name,url:T.url,ext:T.name.split(".")[1]||"unknown"}),I.abrupt("return",T);case 32:case"end":return I.stop()}}),_callee2,this,[[15,23]])})))},t._uploadFile=function _uploadFile(t){var a,c;return __awaiter(this,void 0,void 0,cd.mark((function _callee3(){var _,h,m,g;return cd.wrap((function _callee3$(E){for(;;)switch(E.prev=E.next){case 0:if(Xd(this.mixStorage,"grayConfig.mixStoreEnable")&&Xd(this.mixStorage,"mixStorePolicy.providers.length")){E.next=3;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),E.abrupt("return",this.nos.nosUpload(t));case 3:if(this.logger.log("uploadFile::_uploadFile, grayConfig enable:"+Xd(this.mixStorage,"grayConfig.mixStoreEnable")+" curProvider:"+Xd(this.mixStorage,"curProvider")),_=this.core.adapters.getFileUploadInformation(t),h=!0,_?!1===_.complete&&this.mixStorage.curProvider===s_.s3&&(h=!1):h=!1,this.aws.s3||(this.mixStorage.curProvider=s_.nos),m=__,h){E.next=23;break}return E.prev=10,E.next=13,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.mixStorage.curProvider,tokenCount:1,tag:"qchat",nosSurvivalTime:t.nosSurvivalTime,returnBody:getUploadResponseFormat(t.type)}});case 13:g=E.sent,m=g.content.mixStoreTokenResTag,E.next=23;break;case 17:if(E.prev=17,E.t0=E.catch(10),this.core.logger.error("uploadFile:: getMixStoreToken error",E.t0),!(E.t0 instanceof Vc)){E.next=22;break}throw E.t0;case 22:throw new Gc({code:"v2"===Xd(this.core,"options.apiVersion")?Dc.V2NIM_ERROR_CODE_FILE_UPLOAD_FAILED:400,detail:{reason:"getMixStoreToken error",rawError:E.t0,curProvider:this.mixStorage.curProvider,mixStorePolicy:this.mixStorage.mixStorePolicy}});case 23:if(h){E.next=27;break}return E.abrupt("return",this.mixStorage.curProvider===s_.s3?this.aws.s3Upload(t,m):this.nos.nosUpload(t,m));case 27:return E.abrupt("return",this.nos.nosUpload(t,null===(c=null===(a=null==_?void 0:_.uploadInfo)||void 0===a?void 0:a.payload)||void 0===c?void 0:c.mixStoreToken));case 28:case"end":return E.stop()}}),_callee3,this,[[10,17]])})))},t.getThumbUrl=function getThumbUrl(t,a){var c,_,h,m,g;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(t))return this.logger.error("illegal file url:"+t),t;var E=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(t);E[0],E[1],E[2],E[3],E[4];var T=E[5];if(E[6],E[7],null===(c=this.grayConfig)||void 0===c?void 0:c.mixStoreEnable){var I=this._getUrlType(t);if(I===s_.s3&&this.mixStorePolicy.s3Policy&&Xd(this.mixStorePolicy,"s3Policy.thumbPolicy.imagethumb"))return(null===(h=null===(_=this.mixStorePolicy.s3Policy)||void 0===_?void 0:_.thumbPolicy)||void 0===h?void 0:h.imagethumb).replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",T).replace("{x}",a.width.toString()).replace("{y}",a.height.toString());if(I===s_.nos&&this.mixStorePolicy.nosPolicy&&Xd(this.mixStorePolicy,"nosPolicy.thumbPolicy.imagethumb"))return(null===(g=null===(m=this.mixStorePolicy.nosPolicy)||void 0===m?void 0:m.thumbPolicy)||void 0===g?void 0:g.imagethumb).replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",T).replace("{x}",a.width.toString()).replace("{y}",a.height.toString())}return includes(t).call(t,"?")?t+"&imageView&thumbnail="+a.width+"x"+a.height:t+"?imageView&thumbnail="+a.width+"x"+a.height},t.getVideoCoverUrl=function getVideoCoverUrl(t,a){var c,_,h,m,g;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(t))return this.logger.error("illegal file url:"+t),t;var E=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(t);E[0],E[1],E[2],E[3],E[4];var T=E[5];if(E[6],E[7],null===(c=this.grayConfig)||void 0===c?void 0:c.mixStoreEnable){var I=this._getUrlType(t);if(I===s_.s3&&this.mixStorePolicy.s3Policy&&Xd(this.mixStorePolicy,"s3Policy.thumbPolicy.vframe"))return(null===(h=null===(_=this.mixStorePolicy.s3Policy)||void 0===_?void 0:_.thumbPolicy)||void 0===h?void 0:h.vframe).replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",T).replace("{x}",a.width.toString()).replace("{y}",a.height.toString()).replace("{offset}","0").replace("{type}","png");if(I===s_.nos&&this.mixStorePolicy.nosPolicy&&Xd(this.mixStorePolicy,"nosPolicy.thumbPolicy.vframe"))return(null===(g=null===(m=this.mixStorePolicy.nosPolicy)||void 0===m?void 0:m.thumbPolicy)||void 0===g?void 0:g.vframe).replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",T).replace("{x}",a.width.toString()).replace("{y}",a.height.toString()).replace("{offset}","0").replace("{type}","png")}return includes(t).call(t,"?")?t+"&vframe&offset=0&resize="+a.width+"x"+a.height+"&type=png":t+"?vframe&offset=0&resize="+a.width+"x"+a.height+"&type=png"},t.getPrivateUrl=function getPrivateUrl(t){var a;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(t))return this.logger.error("illegal file url:"+t),"";var c=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(t);c[0];var _=c[1];c[2];var h=c[3];c[4];var m=c[5];if(c[6],c[7],null===(a=this.grayConfig)||void 0===a?void 0:a.mixStoreEnable){var g=this._getUrlType(t);return g===s_.s3&&this.mixStorePolicy.s3Policy&&(t=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",m)),g===s_.nos&&this.mixStorePolicy.nosPolicy&&(t=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",m)),t}var E=this.config,T=E.downloadUrl,I=E.downloadHostList,N=E.nosCdnEnable,M=this.config.cdn.cdnDomain,S=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",O=decodeURIComponent(m),A=indexOf(O).call(O,S);if(M&&A>-1&&N)return""+_+M+"/"+slice$1(O).call(O,A);if(includes(I).call(I,h)&&includes(m).call(m,"/")){var b=indexOf(m).call(m,"/"),R=m.substring(0,b),C=m.substring(b+1);return T.replace("{bucket}",R).replace("{object}",C)}var P=filter(I).call(I,(function(t){return"string"==typeof h&&includes(h).call(h,t)}))[0],k=P?h.replace(P,"").replace(/\W/g,""):null;return k?T.replace("{bucket}",k).replace("{object}",m):t},t.getOriginUrl=function getOriginUrl(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee4(){var a;return cd.wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:if("string"==typeof t&&includes(t).call(t,"_im_url=1")){c.next=2;break}return c.abrupt("return",t);case 2:return c.next=4,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:t}});case 4:return a=c.sent,c.abrupt("return",a.content.nosSafeUrlTag.originUrl);case 6:case"end":return c.stop()}}),_callee4,this)})))},t.getFileToken=function getFileToken(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee5(){var a,c,_,h,m,g=this;return cd.wrap((function _callee5$(E){for(;;)switch(E.prev=E.next){case 0:if(validate({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},t),a=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,c=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,a!==String(c_.dontNeed)||c!==String(c_.dontNeed)){E.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(t.type!==c_.time){E.next=17;break}if(!(a&&indexOf(a).call(a,String(c_.time))>=0||c&&indexOf(c).call(c,String(c_.time))>0)){E.next=13;break}return E.abrupt("return",this.mixStorage.getFileAuthToken(t));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:E.next=33;break;case 17:if(t.urls&&t.urls.length){E.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(h=[],m=[],forEach$1(_=t.urls).call(_,(function(t){var a=g._getUrlType(t);a===s_.nos&&m.push(t),a===s_.s3&&h.push(t)})),(!c||0!==h.length&&indexOf(c).call(c,String(c_.urls))<0)&&(this.logger.warn("s3 url don't support url token"),h=[]),(!a||0!==m.length&&indexOf(a).call(a,String(c_.urls))<0)&&(this.logger.warn("nos url don't support url token"),m=[]),0!==h.length||0!==m.length){E.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(0!==h.length&&0!==m.length){E.next=33;break}return t.urls=ws(t.urls),E.abrupt("return",this.mixStorage.getFileAuthToken(t));case 33:case"end":return E.stop()}}),_callee5,this)})))},t._getUrlType=function _getUrlType(t){var a,c;return this.mixStorePolicy.nosPolicy&&some(a=this.mixStorePolicy.nosPolicy.dlcdns).call(a,(function(a){return indexOf(t).call(t,a)>=0}))?s_.nos:this.mixStorePolicy.s3Policy&&some(c=this.mixStorePolicy.s3Policy.dlcdns).call(c,(function(a){return indexOf(t).call(t,a)>=0}))?s_.s3:null},t.getNosAccessToken=function getNosAccessToken(t){return validate({url:{type:"string",allowEmpty:!1}},t),this.nos.getNosAccessToken(t)},t.deleteNosAccessToken=function deleteNosAccessToken(t){return validate({token:{type:"string",allowEmpty:!1}},t),this.nos.deleteNosAccessToken(t)},t.process=function process(t){var a=Xd(t,"error.detail.ignore");return t.error&&!a?Jn.reject(t.error):Jn.resolve(t)},f_(CloudStorageService,[{key:"grayConfig",get:function get(){return this.mixStorage.grayConfig}},{key:"mixStorePolicy",get:function get(){return this.mixStorage.mixStorePolicy}}]),CloudStorageService}(),wh=function(t){function ChatroomMsgService(a){return t.call(this,"chatroomMsg",a)||this}Mt(ChatroomMsgService,t);var a=ChatroomMsgService.prototype;return a.sendTextMsg=function sendTextMsg(t){return validate({body:{type:"string",allowEmpty:!1}},t),this.sendMsg(Ct(Ct({},t),{type:"text"}))},a.sendGeoLocationMsg=function sendGeoLocationMsg(t){return validate({body:{type:"object",rules:{title:{type:"string",allowEmpty:!1},lat:{type:"number"},lng:{type:"number"}}}},t),this.sendMsg(Ct(Ct({},t),{type:"geo",body:ws(t.body)}))},a.sendTipMsg=function sendTipMsg(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){return cd.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return validate({body:{type:"string",allowEmpty:!1}},t),a.abrupt("return",this.sendMsg(Ct(Ct({},t),{type:"tip"})));case 2:case"end":return a.stop()}}),_callee,this)})))},a.sendCustomMsg=function sendCustomMsg(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){return cd.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return validate({body:{type:"string",allowEmpty:!1}},t),a.abrupt("return",this.sendMsg(Ct(Ct({},t),{type:"custom"})));case 2:case"end":return a.stop()}}),_callee2,this)})))},a.sendImageMsg=function sendImageMsg(t){return this.doSendFile(Ct(Ct({},t),{type:"image"}))},a.sendFileMsg=function sendFileMsg(t){return this.doSendFile(Ct(Ct({},t),{type:"file"}))},a.sendAudioMsg=function sendAudioMsg(t){return this.doSendFile(Ct(Ct({},t),{type:"audio"}))},a.sendVideoMsg=function sendVideoMsg(t){return this.doSendFile(Ct(Ct({},t),{type:"video"}))},a.doSendFile=function doSendFile(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee3(){var a;return cd.wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:if(validate({type:{type:"string",allowEmpty:!1},body:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},t),a=t.body){c.next=15;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){c.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return c.prev=5,c.next=8,this.core.cloudStorage.uploadFile(t);case 8:a=c.sent,c.next=15;break;case 11:throw c.prev=11,c.t0=c.catch(5),this.logger.error("sendFile:: upload File error or abort.",c.t0),c.t0;case 15:return c.abrupt("return",this.sendMsg(Ct(Ct({},t),{body:ws(a),type:t.type})));case 16:case"end":return c.stop()}}),_callee3,this,[[5,11]])})))},a.queryMessageHistory=function queryMessageHistory(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee4(){var a,c,_;return cd.wrap((function _callee4$(h){for(;;)switch(h.prev=h.next){case 0:return validate({timetag:{type:"number",required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1},msgTypes:{type:"array",itemType:"string",required:!1}},t),h.next=3,this.core.sendCmd("chatroomQueryMessageHistory",Ct(Ct({timetag:0,limit:100,reverse:!1},t),{msgTypes:t.msgTypes?map$6(a=t.msgTypes).call(a,(function(t){return e_[t]})):[]}));case 3:return c=h.sent,_=c.content.chatroomMsgs,h.abrupt("return",formatChatroomMsgs(_,this.core.account));case 6:case"end":return h.stop()}}),_callee4,this)})))},a.getHistoryMsgsByTags=function getHistoryMsgsByTags(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee5(){var a,c,_,h,m;return cd.wrap((function _callee5$(g){for(;;)switch(g.prev=g.next){case 0:return validate({tags:{type:"array",itemType:"string",required:!0},types:{type:"array",itemType:"string",required:!1},fromTime:{type:"number",min:0,required:!1},toTime:{type:"number",min:0,required:!1},limit:{type:"number",min:0,required:!1},reverse:{type:"number",required:!1}},t),_=Ct(Ct({fromTime:0,toTime:0,limit:100,reverse:0},t),{types:t.types?map$6(a=filter(c=t.types).call(c,(function(t){return void 0!==e_[t]}))).call(a,(function(t){return e_[t]})):[]}),g.next=4,this.core.sendCmd("getHistoryMsgsByTags",{chatRoomTagHistoryMsgRequestTag:Ct(_,{tags:ws(_.tags),types:ws(_.types)})});case 4:return h=g.sent,m=h.content.chatroomMsgs,g.abrupt("return",formatChatroomMsgs(m,this.core.account));case 7:case"end":return g.stop()}}),_callee5,this)})))},a.onChatroomMsgHandler=function onChatroomMsgHandler(t){var a=t.content;Zn();var c=formatChatroomMsg(null==a?void 0:a.chatroomMsg,this.core.account);"debug"===this.core.options.debugLevel?this.logger.debug("onChatroomMsgHandler::recvMsg",c.type,c.idClient,c):this.logger.log("onChatroomMsgHandler::recvMsg",c.type,c.idClient),this.core.emit("chatroomMsg",c),"out"!==c.flow&&this.doMsgReceiveReport(c,t)},a.doMsgReceiveReport=function doMsgReceiveReport(t,a){if(t.from!==this.core.account){var c=Xd(t,"__clientExt.statistics.apiCallingTime")||0,_=Xd(t,"__clientExt.statistics.sendTime")||0,h=Xd(t,"__clientExt.statistics.attachUploadDuration")||0,m=this.core.timeOrigin.getNTPTime(),g=t.time,E=this.core.timeOrigin.checkNodeReliable(a.__receiveTimeNode)?this.core.timeOrigin.getNTPTime(a.__receiveTimeNode):m;this.core.reporter.report("msgReceive",{msgId:"",clientId:t.idClient,serverTime:g,receiveTime:E,fromAccid:t.from,toAccid:this.core.account,type:4,roomId:t.chatroomId,apiCallingTime:c,sendTime:_,attachUploadDuration:h,callbackTime:m,preHandleTime:m,result:200,failReason:"",rt:m-g})}},a.sendMsg=function sendMsg(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee6(){var a,c,_,h,m;return cd.wrap((function _callee6$(g){for(;;)switch(g.prev=g.next){case 0:validate({type:{type:"enum",values:getEnumKeys(e_)},subType:{type:"number",min:1,required:!1}},t),a=generatorMsgForCmd(t,this.core.account,this.core.config.deviceId),c=formatChatroomMsg(Ct(Ct({},a),{status:"sending",time:(new Date).getTime()}),this.core.account);try{t.onSendBefore&&t.onSendBefore(c)}catch(t){this.core.logger.error("sendMsg: options.onSendBefore error",t)}return g.prev=4,g.next=7,this.core.sendCmd("sendChatroomMsg",{chatroomMsg:a});case 7:return _=g.sent,h=formatChatroomMsg(Ct(Ct(Ct({},a),_.content.chatroomMsg),{status:"success"}),this.core.account),this.core.reporter.report("msgSend",{msgId:"",clientId:h.idClient,msgTime:h.time,fromAccid:this.core.account,toAccid:"",type:4,roomId:h.chatroomId,tid:"",result:200,failReason:"",rt:Zn()-c.time}),g.abrupt("return",h);case 13:throw g.prev=13,g.t0=g.catch(4),m=formatChatroomMsg(Ct(Ct({},a),{status:"fail"}),this.core.account),g.t0.msg=m,this.core.reporter.report("msgSend",{msgId:"",clientId:m.idClient,fromAccid:this.core.account,toAccid:"",type:4,roomId:m.chatroomId,tid:"",result:null===g.t0||void 0===g.t0?void 0:g.t0.code,failReason:(null===g.t0||void 0===g.t0?void 0:g.t0.message)||"",rt:Zn()-a.time}),g.t0;case 19:case"end":return g.stop()}}),_callee6,this,[[4,13]])})))},ChatroomMsgService}(Lp);!function(t){t[t.regular=0]="regular",t[t.temp=1]="temp",t[t.regularOnline=2]="regularOnline",t[t.regularReverse=3]="regularReverse"}(Rh||(Rh={}));var xh=function(t){function ChatroomMemberService(a){return t.call(this,"chatroomMember",a)||this}Mt(ChatroomMemberService,t);var a=ChatroomMemberService.prototype;return a.updateMyRoomRole=function updateMyRoomRole(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){return cd.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return validate({member:{type:"object",rules:{nick:{type:"string",required:!1},avatar:{type:"string",required:!1},ext:{type:"string",required:!1}}},needNotify:{type:"boolean"},ext:{type:"string",required:!1},needSave:{type:"boolean",required:!1}},t),a.next=3,this.core.sendCmd("chatroomUpdateMyRoomRole",Ct(Ct({},t),{chatroomMember:t.member,ext:t.ext||""}));case 3:case"end":return a.stop()}}),_callee,this)})))},a.setMemberManager=function setMemberManager(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){return cd.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.markChatroomMember(Ct(Ct({},t),{type:1}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),_callee2,this)})))},a.setMemberNormal=function setMemberNormal(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee3(){return cd.wrap((function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.markChatroomMember(Ct(Ct({},t),{type:2}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),_callee3,this)})))},a.setMemberMute=function setMemberMute(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee4(){return cd.wrap((function _callee4$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.markChatroomMember(Ct(Ct({},t),{type:-2}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),_callee4,this)})))},a.setMemberBlackList=function setMemberBlackList(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee5(){return cd.wrap((function _callee5$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.markChatroomMember(Ct(Ct({},t),{type:-1}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),_callee5,this)})))},a.queryMembers=function queryMembers(t){var a;return __awaiter(this,void 0,void 0,cd.mark((function _callee6(){var c;return cd.wrap((function _callee6$(_){for(;;)switch(_.prev=_.next){case 0:return validate({type:{type:"enum",values:getEnumKeys(Rh)},time:{type:"number",required:!1},limit:{type:"number",required:!1}},t),_.next=3,this.core.sendCmd("chatroomQueryMembers",Ct(Ct({time:0,limit:100},t),{type:Rh[t.type]}));case 3:return c=_.sent,_.abrupt("return",formatChatroomMembers(null===(a=c.content)||void 0===a?void 0:a.members));case 5:case"end":return _.stop()}}),_callee6,this)})))},a.queryMembersByAccounts=function queryMembersByAccounts(t){var a;return __awaiter(this,void 0,void 0,cd.mark((function _callee7(){var c;return cd.wrap((function _callee7$(_){for(;;)switch(_.prev=_.next){case 0:return validate({accounts:{type:"array",min:1,max:20,itemType:"string"}},t),_.next=3,this.core.sendCmd("chatroomQueryMembersByAccounts",t);case 3:return c=_.sent,_.abrupt("return",formatChatroomMembers(null===(a=c.content)||void 0===a?void 0:a.members));case 5:case"end":return _.stop()}}),_callee7,this)})))},a.setMemberTempMute=function setMemberTempMute(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee8(){return cd.wrap((function _callee8$(a){for(;;)switch(a.prev=a.next){case 0:return validate({account:{type:"string",allowEmpty:!1},duration:{type:"number",min:0},needNotify:{type:"boolean",required:!1},ext:{type:"string",required:!1}},t),a.next=3,this.core.sendCmd("chatroomSetMemberTempMute",Ct(Ct({},t),{ext:t.ext||""}));case 3:case"end":return a.stop()}}),_callee8,this)})))},a.kickMember=function kickMember(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee9(){return cd.wrap((function _callee9$(a){for(;;)switch(a.prev=a.next){case 0:return validate({account:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},t),a.next=3,this.core.sendCmd("chatroomKickMember",Ct(Ct({},t),{ext:t.ext||""}));case 3:case"end":return a.stop()}}),_callee9,this)})))},a.queryMembersCountByTag=function queryMembersCountByTag(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee10(){var a;return cd.wrap((function _callee10$(c){for(;;)switch(c.prev=c.next){case 0:return validate({tag:{type:"string",allowEmpty:!1}},t),c.next=3,this.core.sendCmd("chatroomQueryMembersCountByTag",Ct({},t));case 3:return a=c.sent,c.abrupt("return",a.content.count);case 5:case"end":return c.stop()}}),_callee10,this)})))},a.queryMembersByTag=function queryMembersByTag(t){var a;return __awaiter(this,void 0,void 0,cd.mark((function _callee11(){var c;return cd.wrap((function _callee11$(_){for(;;)switch(_.prev=_.next){case 0:return validate({tag:{type:"string",allowEmpty:!1},time:{type:"number",required:!1},limit:{type:"number",max:100,required:!1}},t),_.next=3,this.core.sendCmd("chatroomQueryMembersByTag",{chatroomTagMemberReq:Ct({time:0,limit:100},t)});case 3:return c=_.sent,_.abrupt("return",formatChatroomMembers(null===(a=c.content)||void 0===a?void 0:a.members));case 5:case"end":return _.stop()}}),_callee11,this)})))},a.setMembersTempMuteByTag=function setMembersTempMuteByTag(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee12(){return cd.wrap((function _callee12$(a){for(;;)switch(a.prev=a.next){case 0:return validate({tag:{type:"string",allowEmpty:!1},duration:{type:"number",min:0},needNotify:{type:"boolean"},notifyTargetTags:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1}},t),a.next=3,this.core.sendCmd("chatroomSetMembersTempMuteByTag",{chatroomTagMuteReq:Ct(Ct({},t),{needNotify:t.needNotify?1:0,ext:t.ext||""})});case 3:case"end":return a.stop()}}),_callee12,this)})))},a.markChatroomMember=function markChatroomMember(t){var a;return __awaiter(this,void 0,void 0,cd.mark((function _callee13(){var c;return cd.wrap((function _callee13$(_){for(;;)switch(_.prev=_.next){case 0:return validate({account:{type:"string"},isAdd:{type:"boolean"},ext:{type:"string",required:!1},level:{type:"number",required:!1}},t),_.next=3,this.core.sendCmd("markChatroomMember",Ct(Ct({level:0},t),{ext:t.ext||""}));case 3:return c=_.sent,_.abrupt("return",formatChatroomMember(null===(a=c.content)||void 0===a?void 0:a.chatroomMember));case 5:case"end":return _.stop()}}),_callee13,this)})))},ChatroomMemberService}(Lp),Dh=function(t){function ChatroomQueueService(a){return t.call(this,"chatroomQueue",a)||this}Mt(ChatroomQueueService,t);var a=ChatroomQueueService.prototype;return a.init=function init(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){return cd.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return validate({maxItemCount:{type:"number",min:0,max:1e3}},t),a.next=3,this.core.sendCmd("chatroomQueueInit",t);case 3:case"end":return a.stop()}}),_callee,this)})))},a.update=function update(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee2(){return cd.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return validate({elementKey:{type:"string",allowEmpty:!1},elementValue:{type:"string",max:4096,allowEmpty:!1},transient:{type:"boolean",required:!1},account:{type:"string",required:!1}},t),a.next=3,this.core.sendCmd("chatroomQueueOffer",Ct(Ct({},t),{transient:!!t.transient}));case 3:case"end":return a.stop()}}),_callee2,this)})))},a.poll=function poll(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee3(){var a;return cd.wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return validate({key:{type:"string",required:!1}},t),t.key||(t.key=""),c.next=4,this.core.sendCmd("chatroomQueuePoll",t||{});case 4:return a=c.sent,c.abrupt("return",a.content);case 6:case"end":return c.stop()}}),_callee3,this)})))},a.batchUpdate=function batchUpdate(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee4(){var a;return cd.wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:return validate({itemList:{type:"object"},needNotify:{type:"boolean",required:!1},notifyExtension:{type:"string",required:!1}},t),c.next=3,this.core.sendCmd("chatroomQueueChange",Ct(Ct({},t),{needNotify:!!t.needNotify}));case 3:return a=c.sent,c.abrupt("return",a.content.invalidKeyList);case 5:case"end":return c.stop()}}),_callee4,this)})))},a.fetch=function fetch(){return __awaiter(this,void 0,void 0,cd.mark((function _callee5(){var t;return cd.wrap((function _callee5$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.core.sendCmd("chatroomQueueList");case 2:return t=a.sent,a.abrupt("return",t.content.itemList);case 4:case"end":return a.stop()}}),_callee5,this)})))},a.pickHeader=function pickHeader(){return __awaiter(this,void 0,void 0,cd.mark((function _callee6(){var t,a,c,_;return cd.wrap((function _callee6$(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.core.sendCmd("chatroomQueuePeak");case 2:return a=h.sent,c=a.content.elementKey,_=a.content.elementValue,h.abrupt("return",((t={})[c]=_,t));case 6:case"end":return h.stop()}}),_callee6,this)})))},a.clear=function clear(){return __awaiter(this,void 0,void 0,cd.mark((function _callee7(){return cd.wrap((function _callee7$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.sendCmd("chatroomQueueDrop");case 2:case"end":return t.stop()}}),_callee7,this)})))},ChatroomQueueService}(Lp),Lh={"1_2":"heartbeat","6_23":"getServerTime","13_2":"chatroomLogin","13_3":"beKickedFromChatroom","13_4":"chatroomExit","13_6":"sendChatroomMsg","13_7":"onChatroomMsg","13_8":"chatroomQueryMembers","13_9":"chatroomQueryMessageHistory","13_11":"markChatroomMember","13_12":"closeChatroom","13_13":"getChatroom","13_14":"updateChatroom","13_15":"chatroomUpdateMyRoomRole","13_16":"chatroomQueryMembersByAccounts","13_17":"chatroomKickMember","13_19":"chatroomSetMemberTempMute","13_20":"chatroomQueueOffer","13_21":"chatroomQueuePoll","13_22":"chatroomQueueList","13_23":"chatroomQueuePeak","13_24":"chatroomQueueDrop","13_25":"chatroomQueueInit","13_26":"chatroomQueueChange","13_30":"chatroomSetMembersTempMuteByTag","13_31":"chatroomQueryMembersByTag","13_32":"chatroomQueryMembersCountByTag","13_36":"getHistoryMsgsByTags","13_101":"updateChatroomTag"},Vh={chatroomLogin:{appkey:1,account:2,deviceId:3,chatroomId:5,appLogin:8,chatroomNick:20,chatroomAvatar:21,chatroomExt:22,chatroomEnterExt:23,clientSession:26,isAnonymous:38,tags:39,notifyTargetTags:40,authType:41,loginExt:42},chatroomIMLogin:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appkey:18,account:19,browser:24,clientSession:26,deviceInfo:32,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,hostEnv:41,userAgent:42,libEnv:44,isReactNative:112,authType:115,loginExt:116},chatroomMsg:{idClient:1,type:2,body:3,ext:4,resend:5,userUpdateTime:6,fromNick:7,fromAvatar:8,fromExt:9,needAntiSpam:10,antiSpamContent:11,skipHistory:12,messageBody:13,antiSpamBusinessId:14,clientAntiSpam:15,antiSpamUsingYidun:16,time:20,from:21,chatroomId:22,fromClientType:23,highPriority:25,callbackExt:27,subType:28,yidunAntiCheating:29,env:30,notifyTargetTags:31,yidunAntiSpamExt:32,yidunAntiSpamRes:33,__clientExt:{id:39,converter:function objectToJSONString(t){if(t&&"object"==typeof t)try{return ws(t)}catch(t){return}},retConverter:function stringToJSONObject(t){if(t&&"string"==typeof t)try{return JSON.parse(t)}catch(t){return}}}},chatroom:{id:1,name:3,announcement:4,broadcastUrl:5,ext:12,createTime:14,updateTime:15,queuelevel:16,creator:100,onlineMemberNum:101,mute:102},chatroomMember:{chatroomId:1,account:2,type:3,level:4,nick:5,avatar:6,ext:7,online:8,guest:9,enterTime:10,blacked:12,muted:13,valid:14,updateTime:15,tempMuted:16,tempMuteDuration:17},chatroomTagMemberReq:{tag:1,time:2,limit:3},chatroomTagMuteReq:{tag:1,duration:2,needNotify:3,ext:4,notifyTargetTags:5},chatroomCdnInfo:{enable:1,cdnUrls:2,timestamp:3,interval:4,decryptType:5,decryptKey:6,timeout:7},chatRoomTagHistoryMsgRequestTag:{tags:1,types:2,fromTime:3,toTime:4,limit:5,reverse:6},updateTags:{currentTags:1}},Uh=function getDeserializeTag(){return function invertSerializeMap(t){var a,c={};return forEach$1(a=Ui(t)).call(a,(function(a){c[a]=function invertSerializeItem(t){var a={};for(var c in t){var _=t[c];"number"==typeof _?a[_]=c:"object"==typeof _&&(a[_.id]={prop:c,type:_.retType,access:_.retAccess?_.retAccess:_.access?_.access:c,def:_.retDef,converter:_.retConverter})}return a}(t[a])})),c}(Vh)},Fh=function getCmdConfig(){var t=Uh();return{heartbeat:{sid:1,cid:2,service:"chatroom"},getServerTime:{sid:6,cid:23,service:"chatroom",response:[{type:"Long",name:"time"}]},chatroomLogin:{sid:13,cid:2,service:"chatroom",params:[{type:"Byte",name:"type"},{type:"Property",name:"chatroomLogin",reflectMapper:Vh.chatroomLogin},{type:"Property",name:"chatroomIMLogin",reflectMapper:Vh.chatroomIMLogin}],response:[{type:"Property",name:"chatroom",reflectMapper:t.chatroom},{type:"Property",name:"chatroomMember",reflectMapper:t.chatroomMember},{type:"Property",name:"chatroomCdnInfo",reflectMapper:t.chatroomCdnInfo}]},chatroomExit:{sid:13,cid:4,service:"chatroom"},sendChatroomMsg:{sid:13,cid:6,service:"chatroomMsg",params:[{type:"Property",name:"chatroomMsg",reflectMapper:Vh.chatroomMsg}],response:[{type:"Property",name:"chatroomMsg",reflectMapper:t.chatroomMsg}]},chatroomQueryMessageHistory:{sid:13,cid:9,service:"chatroomMsg",params:[{type:"Long",name:"timetag"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"chatroomMsgs",reflectMapper:t.chatroomMsg}]},getHistoryMsgsByTags:{sid:13,cid:36,service:"chatroomMsg",params:[{type:"Property",name:"chatRoomTagHistoryMsgRequestTag",reflectMapper:Vh.chatRoomTagHistoryMsgRequestTag}],response:[{type:"PropertyArray",name:"chatroomMsgs",reflectMapper:t.chatroomMsg}]},getChatroom:{sid:13,cid:13,service:"chatroom",response:[{type:"Property",name:"chatroom",reflectMapper:t.chatroom}]},updateChatroom:{sid:13,cid:14,service:"chatroom",params:[{type:"Property",name:"chatroom",reflectMapper:Vh.chatroom},{type:"Bool",name:"needNotify"},{type:"String",name:"ext"}]},chatroomUpdateMyRoomRole:{sid:13,cid:15,service:"chatroomMember",params:[{type:"Property",name:"chatroomMember",reflectMapper:Vh.chatroomMember},{type:"Bool",name:"needNotify"},{type:"String",name:"ext"},{type:"Bool",name:"needSave"}]},markChatroomMember:{sid:13,cid:11,service:"chatroomMember",params:[{type:"String",name:"account"},{type:"Int",name:"type"},{type:"Bool",name:"isAdd"},{type:"Int",name:"level"},{type:"String",name:"ext"}],response:[{type:"Property",name:"chatroomMember",reflectMapper:t.chatroomMember}]},chatroomQueryMembers:{sid:13,cid:8,service:"chatroomMember",params:[{type:"Byte",name:"type"},{type:"Long",name:"time"},{type:"Int",name:"limit"}],response:[{type:"PropertyArray",name:"members",reflectMapper:t.chatroomMember}]},chatroomQueryMembersByAccounts:{sid:13,cid:16,service:"chatroomMember",params:[{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"members",reflectMapper:t.chatroomMember}]},chatroomKickMember:{sid:13,cid:17,service:"chatroomMember",params:[{type:"String",name:"account"},{type:"String",name:"ext"}]},chatroomSetMemberTempMute:{sid:13,cid:19,service:"chatroomMember",params:[{type:"String",name:"account"},{type:"Long",name:"duration"},{type:"Bool",name:"needNotify"},{type:"String",name:"ext"}]},closeChatroom:{sid:13,cid:12,service:"chatroom",params:[{type:"String",name:"ext"}]},chatroomQueryMembersCountByTag:{sid:13,cid:32,service:"chatroomMember",params:[{type:"String",name:"tag"}],response:[{type:"Long",name:"count"}]},chatroomQueryMembersByTag:{sid:13,cid:31,service:"chatroomMember",params:[{type:"Property",name:"chatroomTagMemberReq",reflectMapper:Vh.chatroomTagMemberReq}],response:[{type:"PropertyArray",name:"members",reflectMapper:t.chatroomMember}]},chatroomSetMembersTempMuteByTag:{sid:13,cid:30,service:"chatroomMember",params:[{type:"Property",name:"chatroomTagMuteReq",reflectMapper:Vh.chatroomTagMuteReq}]},chatroomQueueOffer:{sid:13,cid:20,service:"chatroomQueue",params:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"},{type:"Bool",name:"transient"},{type:"String",name:"account"}]},chatroomQueuePoll:{sid:13,cid:21,service:"chatroomQueue",params:[{type:"String",name:"key"}],response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},chatroomQueueChange:{sid:13,cid:26,service:"chatroomQueue",params:[{type:"StrStrMap",name:"itemList"},{type:"Bool",name:"needNotify"},{type:"String",name:"notifyExtension"}],response:[{type:"StrArray",name:"invalidKeyList"}]},chatroomQueueList:{sid:13,cid:22,service:"chatroomQueue",response:[{type:"KVArray",name:"itemList"}]},chatroomQueuePeak:{sid:13,cid:23,service:"chatroomQueue",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},chatroomQueueDrop:{sid:13,cid:24,service:"chatroomQueue"},chatroomQueueInit:{sid:13,cid:25,service:"chatroomQueue",params:[{type:"Int",name:"maxItemCount"}]},onChatroomMsg:{sid:13,cid:7,service:"chatroomMsg",response:[{type:"Property",name:"chatroomMsg",reflectMapper:t.chatroomMsg}]},beKickedFromChatroom:{sid:13,cid:3,service:"auth",response:[{type:"Int",name:"reason"},{type:"String",name:"ext"}]},updateChatroomTag:{sid:13,cid:101,service:"chatroom",response:[{type:"Property",name:"updateTags",reflectMapper:t.updateTags}]}}},Gh={user_id:"",trace_id:"",action:7,exception_service:6,duration:0,start_time:0,state:1,extension:[]},jh=function(){function ReporterHookLinkKeep(t,a){this.traceData=Gh,this.core=t,this.traceData=Ct({},Gh,a),this.traceData.extension=[]}var t=ReporterHookLinkKeep.prototype;return t.reset=function reset(){this.traceData=Ct({},Gh),this.traceData.extension=[]},t.start=function start(){var t,a;this.reset(),this.traceData.user_id=this.core.account,this.traceData.trace_id=(null===(a=null===(t=this.core.clientSocket)||void 0===t?void 0:t.socket)||void 0===a?void 0:a.sessionId)||"",this.traceData.start_time=(new Date).getTime()},t.update=function update(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var a,c,_;return cd.wrap((function _callee$(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,jf.net.getNetworkStatus();case 2:a=h.sent,c=a.net_type,_=a.net_connect,this.traceData.extension.push(Ct({code:0,foreground:!0,foreg_backg_switch:!1,net_type:c,net_connect:_},t));case 6:case"end":return h.stop()}}),_callee,this)})))},t.end=function end(t){var a=this.traceData.extension[0],c=this.traceData.extension[1];if(a&&0===a.operation_type&&c&&1===c.operation_type){var _=a.net_type!==c.net_type||a.net_connect!==c.net_connect;if(t||!_)return this.traceData.duration=(new Date).getTime()-this.traceData.start_time,this.core.reporter.report("exceptions",this.traceData),void this.reset();this.reset()}else this.reset()},ReporterHookLinkKeep}(),Bh={user_id:"",trace_id:"",action:0,state:0,duration:0,start_time:0,offset:0,full_size:0,transferred_size:0,operation_type:0,remote_addr:""},Yh="ReporterHook::setMonitorForResources:",Hh=function(){function ReporterHookCloudStorage(t,a){this.traceData=Bh,this.core=t,this.traceData=Ct({},Bh,a)}var t=ReporterHookCloudStorage.prototype;return t.reset=function reset(){this.traceData=Ct({},Bh)},t.start=function start(){var t,a;this.reset(),this.traceData.user_id=this.core.account,this.traceData.trace_id=(null===(a=null===(t=this.core.clientSocket)||void 0===t?void 0:t.socket)||void 0===a?void 0:a.sessionId)||"",this.traceData.start_time="timeOrigin"in this.core?this.core.timeOrigin.getNTPTime():Zn()},t.update=function update(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){return cd.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(this.traceData.user_id){a.next=2;break}return a.abrupt("return");case 2:this.core.logger.log(Yh+" upload update",t),Ct(this.traceData,t);case 4:case"end":return a.stop()}}),_callee,this)})))},t.end=function end(t){this.traceData.user_id&&(this.core.logger.log(Yh+" upload end cause of "+t),this.traceData.state=t,this.traceData.duration=("timeOrigin"in this.core?this.core.timeOrigin.getNTPTime():Zn())-this.traceData.start_time,this.core.reporter.report("nim_sdk_resources",this.traceData),this.traceData=Bh)},ReporterHookCloudStorage}(),Kh=A("".endsWith),Wh=A("".slice),qh=Math.min,zh=correctIsRegexpLogic("endsWith");_export({target:"String",proto:!0,forced:!zh},{endsWith:function endsWith(t){var a=toString$1(requireObjectCoercible(this));notARegexp(t);var c=arguments.length>1?arguments[1]:void 0,_=a.length,h=void 0===c?_:qh(toLength(c),_),m=toString$1(t);return Kh?Kh(a,m,h):Wh(a,h-m.length,h)===m}});var $h=entryVirtual("String").endsWith,Jh=String.prototype,endsWith=function(t){var a=t.endsWith;return"string"==typeof t||t===Jh||H(Jh,t)&&a===Jh.endsWith?$h:a};function getIsDataReportEnable(t){var a,c,_=!0;return"boolean"==typeof(null===(a=null==t?void 0:t.reporterConfig)||void 0===a?void 0:a.enableCompass)?_=t.reporterConfig.enableCompass:"boolean"==typeof(null===(c=null==t?void 0:t.reporterConfig)||void 0===c?void 0:c.isDataReportEnable)&&(_=t.reporterConfig.isDataReportEnable),_}function getReportConfigUrl(t){var a,c,_="https://statistic.live.126.net/dispatcher/req";return"string"==typeof(null===(a=null==t?void 0:t.reporterConfig)||void 0===a?void 0:a.compassDataEndpoint)?(_=t.reporterConfig.compassDataEndpoint,endsWith(_).call(_,"/")&&(_=slice$1(_).call(_,0,-1)),_+="/dispatcher/req"):"string"==typeof(null===(c=null==t?void 0:t.reporterConfig)||void 0===c?void 0:c.reportConfigUrl)&&(_=t.reporterConfig.reportConfigUrl),_}function getReportUrl(t){var a,c,_="https://statistic.live.126.net/statics/report/common/form";return"string"==typeof(null===(a=null==t?void 0:t.reporterConfig)||void 0===a?void 0:a.compassDataEndpoint)?(_=t.reporterConfig.compassDataEndpoint,endsWith(_).call(_,"/")&&(_=slice$1(_).call(_,0,-1)),_+="/statics/report/common/form"):"string"==typeof(null===(c=null==t?void 0:t.reporterConfig)||void 0===c?void 0:c.reportUrl)&&(_=t.reporterConfig.reportUrl),_}var Qh={debugLevel:"off",needReconnect:!0,reconnectionAttempts:9007199254740991,autoMarkRead:!0,isAbtestEnable:!0,abtestUrl:Np,abtestProjectKey:Mp},Xh=function(t){function Chatroom(a,c){var h;void 0===c&&(c={}),(h=t.call(this)||this).instanceName="Chatroom",h.status="unconnected",h.account="",h.eventBus=new mi,h.options={},h.chatroom={},h.chatroomMsg={},h.chatroomMember={},h.chatroomQueue={},h.cloudStorage={},h.logger=new Tp(a.debugLevel),h.setInitOptions(a),registerParser({cmdMap:Lh,cmdConfig:Fh()}),h.otherOptions=c,h.timerManager=new Dp,h.adapters=new Ip(_(h)),h.timeOrigin=new Kf(_(h)),h.abtest=new Sp(_(h),{isAbtestEnable:h.options.isAbtestEnable,abtestUrl:h.options.abtestUrl,abtestProjectKey:Mp});var m="",g="";h.options.isFixedDeviceId?(m=jf.localStorage.getItem("__CHATROOM_DEVC_ID__")||_l(),g=jf.localStorage.getItem("__CHATROOM_CLIENT_SESSION_ID__")||_l(),jf.localStorage.setItem("__CHATROOM_DEVC_ID__",m),jf.localStorage.setItem("__CHATROOM_CLIENT_SESSION_ID__",g)):(m=_l(),g=_l()),h.config={timeout:8e3,deviceId:m,clientSession:g};var E=jf.getSystemInfo();return h.reporter=new $i({reportConfigUrl:getReportConfigUrl(c),reportUrl:getReportUrl(c),isDataReportEnable:getIsDataReportEnable(c),common:{app_key:a.appkey,dev_id:h.config.deviceId,platform:"Web",sdk_ver:"10.4.0",env:"online",os_name:E.os,os_ver:E.osVer,lib_env:E.libEnv,host_env:E.hostEnv,host_env_ver:E.hostEnvVer,manufactor:E.manufactor,model:E.model,v2:!1},request:jf.request,logger:h.logger,autoStart:!0}),h.reporterHookLinkKeep=new jh(_(h)),h.reporterHookCloudStorage=new Hh(_(h)),jf.setLogger(h.logger),h.auth=new l_(_(h)),h.V1NIMLoginService=h.auth,h.clientSocket=new Jp(_(h)),h.chatroom=new d_(_(h)),h.chatroomMsg=new wh(_(h)),h.chatroomMember=new xh(_(h)),h.chatroomQueue=new Dh(_(h)),h.cloudStorage=new kh(_(h),Ct({storageKeyPrefix:h.instanceName},c.cloudStorageConfig)),Chatroom.instance=_(h),h.logger.log("Chatroom init, version ","10.4.0"," sdk version ",100400," appkey ",a.appkey),h}Mt(Chatroom,t),Chatroom.getInstance=function getInstance(t,a){if(!Chatroom.instance){if(t)return new Chatroom(t,a);throw new Error("Instance not exist, please input options")}if(t){if(Chatroom.instance.options.account===t.account&&Chatroom.instance.options.appkey===t.appkey)return Chatroom.instance.setOptions(t),Chatroom.instance;throw new Error("Unexpected login")}return Chatroom.instance};var a=Chatroom.prototype;return a.setOptions=function setOptions(t){if("object"==typeof t&&null!==t&&(Object.prototype.hasOwnProperty.call(t,"account")&&t.account!==this.options.account||Object.prototype.hasOwnProperty.call(t,"appkey")&&t.appkey!==this.options.appkey))throw new Error("chatroom::setOptions account and appkey is not allowed to reset");validate({token:{type:"string",required:!1},chatroomId:{type:"string",required:!1},chatroomAddresses:{type:"array",itemType:"string",min:1,required:!1},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},isAnonymous:{type:"boolean",required:!1},tags:{type:"array",itemType:"string",required:!1}},t),this.logger.log("chatroom::setOptions options is",t),this.options=Ct(Ct({},this.options),t)},a.setInitOptions=function setInitOptions(t){validate({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},chatroomId:{type:"string"},chatroomAddresses:{type:"array",itemType:"string",min:1},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},isAnonymous:{type:"boolean",required:!1},tags:{type:"array",itemType:"string",required:!1}},t),this.logger&&this.logger.log("chatroom::setInitOptions options is",t),this.account=t.account,this.options=Ct(Ct({},Qh),t)},a.connect=function connect(t){return void 0===t&&(t={}),this.auth.login(t)},a.disconnect=function disconnect(){var t=this;switch(this.status){case"logined":return this.sendCmd("chatroomExit",void 0,{timeout:1e3}).then((function(){t.clientSocket.doDisconnect(Hp.ACTIVE,"UserActiveDisconnect")})).catch((function(a){t.logger.error("Instance::disconnect sendCmd:logout error",a),t.clientSocket.doDisconnect(Hp.ACTIVE,"UserActiveDisconnect")}));case"connected":case"connecting":case"waitReconnect":return this.clientSocket.doDisconnect(Hp.ACTIVE,"UserActiveDisconnect"),Jn.resolve();case"unconnected":case"destroyed":return Jn.resolve()}},a.destroy=function destroy(){var t=this;return Chatroom.instance=void 0,this.disconnect().then((function(){t.status="destroyed",t.removeAllListeners(),t.eventBus.removeAllListeners(),t.logger.destroy(),t.reporter.destroy(),t.timerManager.destroy(),t.connect=emptyFuncWithPromise,t.disconnect=emptyFuncWithPromise,t.destroy=emptyFuncWithPromise}))},a.sendCmd=function sendCmd(t,a,c){return this.clientSocket.sendCmd(t,a,c)},a.emit=function emit(a){var c=this;try{for(var _,h,m=Zn(),g=arguments.length,E=new Array(g>1?g-1:0),T=1;T<g;T++)E[T-1]=arguments[T];var I=(_=t.prototype.emit).call.apply(_,concat(h=[this,a]).call(h,E)),N=Zn()-m;return N>=10&&this.logger.warn("Core::emit event: "+a+" process takes: "+N+"ms"),I}catch(t){return this.logger.error("Core::emit event: "+a+". Error: "+t),hi((function(){throw c.logger.error("Core::emit throw error in setTimeout. event: "+a+". Error: "+t),t}),0),!1}},Chatroom}(mi),Zh=createCommonjsModule((function(a,c){(function(){var _={function:!0,object:!0}[typeof window]&&window||this,h=c,m=a&&!a.nodeType&&a,g=h&&m&&"object"==typeof t&&t;!g||g.global!==g&&g.window!==g&&g.self!==g||(_=g);var E=Math.pow(2,53)-1,T=/\bOpera/,I=Object.prototype,N=I.hasOwnProperty,M=I.toString;function capitalize(t){return(t=String(t)).charAt(0).toUpperCase()+t.slice(1)}function format(t){return t=trim(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:capitalize(t)}function forOwn(t,a){for(var c in t)N.call(t,c)&&a(t[c],c,t)}function getClassOf(t){return null==t?capitalize(t):M.call(t).slice(8,-1)}function qualify(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function reduce(t,a){var c=null;return function each(t,a){var c=-1,_=t?t.length:0;if("number"==typeof _&&_>-1&&_<=E)for(;++c<_;)a(t[c],c,t);else forOwn(t,a)}(t,(function(_,h){c=a(c,_,h,t)})),c}function trim(t){return String(t).replace(/^ +| +$/g,"")}var S=function parse(t){var a=_,c=t&&"object"==typeof t&&"String"!=getClassOf(t);c&&(a=t,t=null);var h=a.navigator||{},m=h.userAgent||"";t||(t=m);var g,E,I=c?!!h.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(M.toString()),N="Object",S=c?N:"ScriptBridgingProxyObject",O=c?N:"Environment",A=c&&a.java?"JavaPackage":getClassOf(a.java),b=c?N:"RuntimeObject",R=/\bJava/.test(A)&&a.java,C=R&&getClassOf(a.environment)==O,P=R?"a":"Î±",k=R?"b":"Î²",w=a.document||{},x=a.operamini||a.opera,D=T.test(D=c&&x?x["[[Class]]"]:getClassOf(x))?D:x=null,L=t,V=[],U=null,G=t==m,j=G&&x&&"function"==typeof x.version&&x.version(),B=function getLayout(a){return reduce(a,(function(a,c){return a||RegExp("\\b"+(c.pattern||qualify(c))+"\\b","i").exec(t)&&(c.label||c)}))}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Y=function getName(a){return reduce(a,(function(a,c){return a||RegExp("\\b"+(c.pattern||qualify(c))+"\\b","i").exec(t)&&(c.label||c)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),H=getProduct([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),K=function getManufacturer(a){return reduce(a,(function(a,c,_){return a||(c[H]||c[/^[a-z]+(?: +[a-z]+\b)*/i.exec(H)]||RegExp("\\b"+qualify(_)+"(?:\\b|\\w*\\d)","i").exec(t))&&_}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),W=function getOS(a){return reduce(a,(function(a,c){var _=c.pattern||qualify(c);return!a&&(a=RegExp("\\b"+_+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(a=function cleanupOS(t,a,c){var _={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return a&&c&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(_=_[/[\d.]+$/.exec(t)])&&(t="Windows "+_),t=String(t),a&&c&&(t=t.replace(RegExp(a,"i"),c)),format(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(a,_,c.label||c)),a}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function getProduct(a){return reduce(a,(function(a,c){var _=c.pattern||qualify(c);return!a&&(a=RegExp("\\b"+_+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+_+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+_+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((a=String(c.label&&!RegExp(_,"i").test(c.label)?c.label:a).split("/"))[1]&&!/[\d.]+/.test(a[0])&&(a[0]+=" "+a[1]),c=c.label||c,a=format(a[0].replace(RegExp(_,"i"),c).replace(RegExp("; *(?:"+c+"[_-])?","i")," ").replace(RegExp("("+c+")[-_.]?(\\w)","i"),"$1 $2"))),a}))}function getVersion(a){return reduce(a,(function(a,c){return a||(RegExp(c+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(B&&(B=[B]),/\bAndroid\b/.test(W)&&!H&&(g=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(H=trim(g[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),K&&!H?H=getProduct([K]):K&&H&&(H=H.replace(RegExp("^("+qualify(K)+")[-_.\\s]","i"),K+" ").replace(RegExp("^("+qualify(K)+")[-_.]?(\\w)","i"),K+" $2")),(g=/\bGoogle TV\b/.exec(H))&&(H=g[0]),/\bSimulator\b/i.test(t)&&(H=(H?H+" ":"")+"Simulator"),"Opera Mini"==Y&&/\bOPiOS\b/.test(t)&&V.push("running in Turbo/Uncompressed mode"),"IE"==Y&&/\blike iPhone OS\b/.test(t)?(K=(g=parse(t.replace(/like iPhone OS/,""))).manufacturer,H=g.product):/^iP/.test(H)?(Y||(Y="Safari"),W="iOS"+((g=/ OS ([\d_]+)/i.exec(t))?" "+g[1].replace(/_/g,"."):"")):"Konqueror"==Y&&/^Linux\b/i.test(W)?W="Kubuntu":K&&"Google"!=K&&(/Chrome/.test(Y)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(H))||/\bAndroid\b/.test(W)&&/^Chrome/.test(Y)&&/\bVersion\//i.test(t)?(Y="Android Browser",W=/\bAndroid\b/.test(W)?W:"Android"):"Silk"==Y?(/\bMobi/i.test(t)||(W="Android",V.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&V.unshift("accelerated")):"UC Browser"==Y&&/\bUCWEB\b/.test(t)?V.push("speed mode"):"PaleMoon"==Y&&(g=/\bFirefox\/([\d.]+)\b/.exec(t))?V.push("identifying as Firefox "+g[1]):"Firefox"==Y&&(g=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(W||(W="Firefox OS"),H||(H=g[1])):!Y||(g=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(Y))?(Y&&!H&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(g+"/")+8))&&(Y=null),(g=H||K||W)&&(H||K||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(W))&&(Y=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(W)?W:g)+" Browser")):"Electron"==Y&&(g=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&V.push("Chromium "+g),j||(j=getVersion(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",qualify(Y),"(?:Firefox|Minefield|NetFront)"])),(g=("iCab"==B&&parseFloat(j)>3?"WebKit":/\bOpera\b/.test(Y)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(B)&&"WebKit"||!B&&/\bMSIE\b/i.test(t)&&("Mac OS"==W?"Tasman":"Trident")||"WebKit"==B&&/\bPlayStation\b(?! Vita\b)/i.test(Y)&&"NetFront")&&(B=[g]),"IE"==Y&&(g=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(Y+=" Mobile",W="Windows Phone "+(/\+$/.test(g)?g:g+".x"),V.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(Y="IE Mobile",W="Windows Phone 8.x",V.unshift("desktop mode"),j||(j=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=Y&&"Trident"==B&&(g=/\brv:([\d.]+)/.exec(t))&&(Y&&V.push("identifying as "+Y+(j?" "+j:"")),Y="IE",j=g[1]),G){if(function isHostType(t,a){var c=null!=t?typeof t[a]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(c)||"object"==c&&!t[a])}(a,"global"))if(R&&(L=(g=R.lang.System).getProperty("os.arch"),W=W||g.getProperty("os.name")+" "+g.getProperty("os.version")),C){try{j=a.require("ringo/engine").version.join("."),Y="RingoJS"}catch(t){(g=a.system)&&g.global.system==a.system&&(Y="Narwhal",W||(W=g[0].os||null))}Y||(Y="Rhino")}else"object"==typeof a.process&&!a.process.browser&&(g=a.process)&&("object"==typeof g.versions&&("string"==typeof g.versions.electron?(V.push("Node "+g.versions.node),Y="Electron",j=g.versions.electron):"string"==typeof g.versions.nw&&(V.push("Chromium "+j,"Node "+g.versions.node),Y="NW.js",j=g.versions.nw)),Y||(Y="Node.js",L=g.arch,W=g.platform,j=(j=/[\d.]+/.exec(g.version))?j[0]:null));else getClassOf(g=a.runtime)==S?(Y="Adobe AIR",W=g.flash.system.Capabilities.os):getClassOf(g=a.phantom)==b?(Y="PhantomJS",j=(g=g.version||null)&&g.major+"."+g.minor+"."+g.patch):"number"==typeof w.documentMode&&(g=/\bTrident\/(\d+)/i.exec(t))?(j=[j,w.documentMode],(g=+g[1]+4)!=j[1]&&(V.push("IE "+j[1]+" mode"),B&&(B[1]=""),j[1]=g),j="IE"==Y?String(j[1].toFixed(1)):j[0]):"number"==typeof w.documentMode&&/^(?:Chrome|Firefox)\b/.test(Y)&&(V.push("masking as "+Y+" "+j),Y="IE",j="11.0",B=["Trident"],W="Windows");W=W&&format(W)}if(j&&(g=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(j)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(G&&h.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(U=/b/i.test(g)?"beta":"alpha",j=j.replace(RegExp(g+"\\+?$"),"")+("beta"==U?k:P)+(/\d+\+?/.exec(g)||"")),"Fennec"==Y||"Firefox"==Y&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(W))Y="Firefox Mobile";else if("Maxthon"==Y&&j)j=j.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(H))"Xbox 360"==H&&(W=null),"Xbox 360"==H&&/\bIEMobile\b/.test(t)&&V.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(Y)&&(!Y||H||/Browser|Mobi/.test(Y))||"Windows CE"!=W&&!/Mobi/i.test(t))if("IE"==Y&&G)try{null===a.external&&V.unshift("platform preview")}catch(t){V.unshift("embedded")}else(/\bBlackBerry\b/.test(H)||/\bBB10\b/.test(t))&&(g=(RegExp(H.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||j)?(W=((g=[g,/BB10/.test(t)])[1]?(H=null,K="BlackBerry"):"Device Software")+" "+g[0],j=null):this!=forOwn&&"Wii"!=H&&(G&&x||/Opera/.test(Y)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==Y&&/\bOS X (?:\d+\.){2,}/.test(W)||"IE"==Y&&(W&&!/^Win/.test(W)&&j>5.5||/\bWindows XP\b/.test(W)&&j>8||8==j&&!/\bTrident\b/.test(t)))&&!T.test(g=parse.call(forOwn,t.replace(T,"")+";"))&&g.name&&(g="ing as "+g.name+((g=g.version)?" "+g:""),T.test(Y)?(/\bIE\b/.test(g)&&"Mac OS"==W&&(W=null),g="identify"+g):(g="mask"+g,Y=D?format(D.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(g)&&(W=null),G||(j=null)),B=["Presto"],V.push(g));else Y+=" Mobile";(g=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(g=[parseFloat(g.replace(/\.(\d)$/,".0$1")),g],"Safari"==Y&&"+"==g[1].slice(-1)?(Y="WebKit Nightly",U="alpha",j=g[1].slice(0,-1)):j!=g[1]&&j!=(g[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(j=null),g[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==g[0]&&537.36==g[2]&&parseFloat(g[1])>=28&&"WebKit"==B&&(B=["Blink"]),G&&(I||g[1])?(B&&(B[1]="like Chrome"),g=g[1]||((g=g[0])<530?1:g<532?2:g<532.05?3:g<533?4:g<534.03?5:g<534.07?6:g<534.1?7:g<534.13?8:g<534.16?9:g<534.24?10:g<534.3?11:g<535.01?12:g<535.02?"13+":g<535.07?15:g<535.11?16:g<535.19?17:g<536.05?18:g<536.1?19:g<537.01?20:g<537.11?"21+":g<537.13?23:g<537.18?24:g<537.24?25:g<537.36?26:"Blink"!=B?"27":"28")):(B&&(B[1]="like Safari"),g=(g=g[0])<400?1:g<500?2:g<526?3:g<533?4:g<534?"4+":g<535?5:g<537?6:g<538?7:g<601?8:g<602?9:g<604?10:g<606?11:g<608?12:"12"),B&&(B[1]+=" "+(g+="number"==typeof g?".x":/[.+]/.test(g)?"":"+")),"Safari"==Y&&(!j||parseInt(j)>45)?j=g:"Chrome"==Y&&/\bHeadlessChrome/i.test(t)&&V.unshift("headless")),"Opera"==Y&&(g=/\bzbov|zvav$/.exec(W))?(Y+=" ",V.unshift("desktop mode"),"zvav"==g?(Y+="Mini",j=null):Y+="Mobile",W=W.replace(RegExp(" *"+g+"$"),"")):"Safari"==Y&&/\bChrome\b/.exec(B&&B[1])?(V.unshift("desktop mode"),Y="Chrome Mobile",j=null,/\bOS X\b/.test(W)?(K="Apple",W="iOS 4.3+"):W=null):/\bSRWare Iron\b/.test(Y)&&!j&&(j=getVersion("Chrome")),j&&0==j.indexOf(g=/[\d.]+$/.exec(W))&&t.indexOf("/"+g+"-")>-1&&(W=trim(W.replace(g,""))),W&&-1!=W.indexOf(Y)&&!RegExp(Y+" OS").test(W)&&(W=W.replace(RegExp(" *"+qualify(Y)+" *"),"")),B&&!/\b(?:Avant|Nook)\b/.test(Y)&&(/Browser|Lunascape|Maxthon/.test(Y)||"Safari"!=Y&&/^iOS/.test(W)&&/\bSafari\b/.test(B[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Y)&&B[1])&&(g=B[B.length-1])&&V.push(g),V.length&&(V=["("+V.join("; ")+")"]),K&&H&&H.indexOf(K)<0&&V.push("on "+K),H&&V.push((/^on /.test(V[V.length-1])?"":"on ")+H),W&&(g=/ ([\d.+]+)$/.exec(W),E=g&&"/"==W.charAt(W.length-g[0].length-1),W={architecture:32,family:g&&!E?W.replace(g[0],""):W,version:g?g[1]:null,toString:function(){var t=this.version;return this.family+(t&&!E?" "+t:"")+(64==this.architecture?" 64-bit":"")}}),(g=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(L))&&!/\bi686\b/i.test(L)?(W&&(W.architecture=64,W.family=W.family.replace(RegExp(" *"+g),"")),Y&&(/\bWOW64\b/i.test(t)||G&&/\w(?:86|32)$/.test(h.cpuClass||h.platform)&&!/\bWin64; x64\b/i.test(t))&&V.unshift("32-bit")):W&&/^OS X/.test(W.family)&&"Chrome"==Y&&parseFloat(j)>=39&&(W.architecture=64),t||(t=null);var q={};return q.description=t,q.layout=B&&B[0],q.manufacturer=K,q.name=Y,q.prerelease=U,q.product=H,q.ua=t,q.version=Y&&j,q.os=W||{architecture:null,family:null,version:null,toString:function(){return"null"}},q.parse=parse,q.toString=function toStringPlatform(){return this.description||""},q.version&&V.unshift(j),q.name&&V.unshift(Y),W&&Y&&(W!=String(W).split(" ")[0]||W!=Y.split(" ")[0]&&!H)&&V.push(H?"("+W+")":"on "+W),V.length&&(q.description=V.join(" ")),q}();h&&m?forOwn(S,(function(t,a){h[a]=t})):_.platform=S}).call(t)})),em=Math.floor,mergeSort=function(t,a){var c=t.length,_=em(c/2);return c<8?insertionSort(t,a):merge(t,mergeSort(arraySliceSimple(t,0,_),a),mergeSort(arraySliceSimple(t,_),a),a)},insertionSort=function(t,a){for(var c,_,h=t.length,m=1;m<h;){for(_=m,c=t[m];_&&a(t[_-1],c)>0;)t[_]=t[--_];_!==m++&&(t[_]=c)}return t},merge=function(t,a,c,_){for(var h=a.length,m=c.length,g=0,E=0;g<h||E<m;)t[g+E]=g<h&&E<m?_(a[g],c[E])<=0?a[g++]:c[E++]:g<h?a[g++]:c[E++];return t},tm=mergeSort,rm=K.match(/firefox\/(\d+)/i),om=!!rm&&+rm[1],nm=/MSIE|Trident/.test(K),im=K.match(/AppleWebKit\/(\d+)\./),am=!!im&&+im[1],sm=[],cm=A(sm.sort),um=A(sm.push),lm=fails((function(){sm.sort(void 0)})),dm=fails((function(){sm.sort(null)})),fm=arrayMethodIsStrict("sort"),pm=!fails((function(){if(Q)return Q<70;if(!(om&&om>3)){if(nm)return!0;if(am)return am<603;var t,a,c,_,h="";for(t=65;t<76;t++){switch(a=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:c=3;break;case 68:case 71:c=4;break;default:c=2}for(_=0;_<47;_++)sm.push({k:a+_,v:c})}for(sm.sort((function(t,a){return a.v-t.v})),_=0;_<sm.length;_++)a=sm[_].k.charAt(0),h.charAt(h.length-1)!==a&&(h+=a);return"DGBEFHACIJK"!==h}}));_export({target:"Array",proto:!0,forced:lm||!dm||!fm||!pm},{sort:function sort(t){void 0!==t&&aCallable(t);var a=toObject(this);if(pm)return void 0===t?cm(a):cm(a,t);var c,_,h=[],m=lengthOfArrayLike(a);for(_=0;_<m;_++)_ in a&&um(h,a[_]);for(tm(h,function(t){return function(a,c){return void 0===c?-1:void 0===a?1:void 0!==t?+t(a,c)||0:toString$1(a)>toString$1(c)?1:-1}}(t)),c=lengthOfArrayLike(h),_=0;_<c;)a[_]=h[_++];for(;_<m;)deletePropertyOrThrow(a,_++);return a}});var _m=entryVirtual("Array").sort,hm=Array.prototype,sort=function(t){var a=t.sort;return t===hm||H(hm,t)&&a===hm.sort?_m:a},mm=createCommonjsModule((function(t,a){self,t.exports=function(){var t={d:function d(a,c){for(var _ in c)t.o(c,_)&&!t.o(a,_)&&vi(a,_,{enumerable:!0,get:c[_]})},o:function o(t,a){return Object.prototype.hasOwnProperty.call(t,a)}},a={};t.d(a,{default:function _default(){return M}});var c=function e(t){for(var a in function(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(t){},this.onProgress=function(t){},this.onUploadProgress=function(t){},this.onComplete=function(t){},t)this[a]=t[a]};function n(t,a){var c=void 0!==Xl&&Zl(t)||t["@@iterator"];if(!c){if(hl(t)||(c=function(t,a){if(t){var c;if("string"==typeof t)return r(t,a);var _=slice$1(c=Object.prototype.toString.call(t)).call(c,8,-1);return"Object"===_&&t.constructor&&(_=t.constructor.name),"Map"===_||"Set"===_?El(t):"Arguments"===_||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?r(t,a):void 0}}(t))||a&&t&&"number"==typeof t.length){c&&(t=c);var _=0,h=function i(){};return{s:h,n:function n(){return _>=t.length?{done:!0}:{done:!1,value:t[_++]}},e:function e(t){throw t},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var m,g=!0,E=!1;return{s:function s(){c=c.call(t)},n:function n(){var t=c.next();return g=t.done,t},e:function e(t){E=!0,m=t},f:function f(){try{g||null==c.return||c.return()}finally{if(E)throw m}}}}function r(t,a){(null==a||a>t.length)&&(a=t.length);for(var c=0,_=new Array(a);c<a;c++)_[c]=t[c];return _}var _={privateObj:{},setItem:function setItem(t,a){_.privateObj[t]=a},getItem:function getItem(t){return _.privateObj[t]},removeItem:function removeItem(t){delete _.privateObj[t]},getKeys:function getKeys(){return Ui(_.privateObj)}},h={getFileKey:function getFileKey(t){var a=t.size.toString(),c=t.lastModified.toString();return"_NosUploader_"+t.name+slice$1(a).call(a,a.length-5)+slice$1(c).call(c,c.length-5)},getFileInfo:function getFileInfo(t){var a=_.getItem(t);if(!a)return null;try{return JSON.parse(a)}catch(t){return null}},initFile:function initFile(t,a,c){h.clearExpiredInfo();var m=this.getFileKey(a),g={ctx:void 0!==t.ctx?t.ctx:"",bucket:t.bucketName,obj:t.objectName,token:t.token,modifyAt:Zn(),end:!1};return t.payload&&(g.payload=t.payload),c&&_.setItem(m,ws(g)),m},setUploadContext:function setUploadContext(t,a,c){var h=this.getFileInfo(t);h&&(h.ctx=a,c&&_.setItem(t,ws(h)))},setComplete:function setComplete(t,a){var c=this.getFileInfo(t);c&&(c.modifyAt=Zn(),c.end=!0,a&&_.setItem(t,ws(c)))},getUploadContext:function getUploadContext(t){var a=this.getFileInfo(t);return a?a.ctx:""},removeFileInfo:function removeFileInfo(t){0===indexOf(t).call(t,"_NosUploader_")&&_.removeItem(t)},clearExpiredInfo:function clearExpiredInfo(){var t,a="function"==typeof _.getKeys?_.getKeys():Ui(_),c=Zn(),m=[],g=n(a);try{for(g.s();!(t=g.n()).done;){var E=t.value;if(0===indexOf(E).call(E,"_NosUploader_")){var T=h.getFileInfo(E);null===T||c-T.modifyAt>M.expireTime?_.removeItem(E):m.push({fileInfo:T,key:E})}}}catch(t){g.e(t)}finally{g.f()}if(m.length>M.maxFileCache){var I,N,S=n(slice$1(I=sort(m).call(m,(function(t,a){return a.fileInfo.modifyAt-t.fileInfo.modifyAt}))).call(I,M.maxFileCache));try{for(S.s();!(N=S.n()).done;){var O,A=N.value;0===indexOf(O=A.key).call(O,"_NosUploader_")&&_.removeItem(A.key)}}catch(t){S.e(t)}finally{S.f()}}}},m=h;function u(t){return(u="function"==typeof Xl&&"symbol"==typeof ed?function(t){return typeof t}:function(t){return t&&"function"==typeof Xl&&t.constructor===Xl&&t!==Xl.prototype?"symbol":typeof t})(t)}function f(t,a){return!a||"object"!==u(a)&&"function"!=typeof a?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):a}function l(t){var a="function"==typeof is?new is:void 0;return(l=function l(t){var c,_;if(null===t||(_=t,-1===indexOf(c=Function.toString.call(_)).call(c,"[native code]")))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==a){if(a.has(t))return a.get(t);a.set(t,n)}function n(){return s(t,arguments,y(this).constructor)}return n.prototype=lt(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),d(n,t)})(t)}function s(t,a,c){return(s=p()?ms:function(t,a,c){var _=[null];_.push.apply(_,a);var h=new(bind$1(Function).apply(t,_));return c&&d(h,c.prototype),h}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!ms)return!1;if(ms.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(ms(Boolean,[],(function(){}))),!0}catch(t){return!1}}function d(t,a){return(d=_t||function(t,a){return t.__proto__=a,t})(t,a)}function y(t){return(y=_t?ss:function(t){return t.__proto__||ss(t)})(t)}var g=function(t){!function(t,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");t.prototype=lt(a&&a.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),a&&d(t,a)}(r,t);var a,c,_=(a=r,c=p(),function(){var t,_=y(a);if(c){var h=y(this).constructor;t=ms(_,arguments,h)}else t=_.apply(this,arguments);return f(this,t)});function r(t,a){var c;return function(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this,r),(c=_.call(this,"NosUploadError:"+t)).errCode=a,c.errMsg=t,c}return r}(l(Error)),E=function e(t,a,c){if("uploading"===t.uploadState){var _=t.config,h=t.param,E=m.getUploadContext(t.fileKey);if(!E)return c(0);var T=new XMLHttpRequest,I=_.directUploadAddr+"/".concat(h.bucketName)+"/".concat(encodeURIComponent(h.objectName))+"?uploadContext"+"&context=".concat(E)+"&version=".concat(_.version);T.onreadystatechange=function(){var h;if("abort"!==t.uploadState&&4===T.readyState){var E,N,M,S;try{S=JSON.parse(T.responseText)}catch(t){S={errMsg:"JsonParseError in getOffset",errCode:500}}200===T.status?S.errCode?t.config.onError(new g(S.errMsg,S.errCode)):c(S.offset):T.status.toString().match(/^5/)?e(t,a-1,c):a>0?("function"==typeof(null===(h=_.logger)||void 0===h?void 0:h.error)&&_.logger.error(concat(E="getOffset(".concat(I,") error. retry after 3 seconds. ")).call(E,(new Date).toTimeString())),hi((function(){e(t,a-1,c)}),3500)):T.status?(m.removeFileInfo(t.fileKey),_.onError(new g(concat(N=concat(M="getOffset(".concat(I,") error: ")).call(M,T.status," ")).call(N,T.statusText)))):_.onError(new g("getOffset(".concat(I,") error. no Error Code")))}},T.open("get",I),T.setRequestHeader("x-nos-token",h.token),T.timeout=_.getOffsetTimeout,T.send()}},T=function e(t,a,c,_){if("uploading"===t.uploadState){var h=t.param,E=t.config,T=slice$1(File.prototype),I=void 0!==h.ctx?h.ctx:"",N=a+E.trunkSize>t.file.size,M=N?t.file.size:a+E.trunkSize,S=new XMLHttpRequest,O=E.directUploadAddr+"/".concat(h.bucketName)+"/".concat(encodeURIComponent(h.objectName));if(S.upload.onprogress=function(c){if("abort"!==t.uploadState){var _=0;c.lengthComputable?(_=(a+c.loaded)/t.file.size,E.onProgress(_),E.onUploadProgress({loaded:c.loaded,total:t.file.size,percentage:_,percentageText:(100*_).toFixed(2)+"%"})):E.onError(new g("browser does not support query upload progress"))}},S.onreadystatechange=function(){var h,T;if("abort"!==t.uploadState&&4===S.readyState){var I,M,A,b;try{b=JSON.parse(S.responseText)}catch(t){"function"==typeof(null===(h=E.logger)||void 0===h?void 0:h.error)&&E.logger.error("JsonParseError in uploadTrunk",t),b={errMsg:"JsonParseError in uploadTrunk"}}200===S.status?(t.setContext(b.context),N?(_(),t.setComplete()):e(t,b.offset,E.retryCount,_)):S.status.toString().match(/^5/)?c>0?e(t,a,c-1,_):(m.removeFileInfo(t.fileKey),E.onError(new g(b.errMsg,b.errCode))):c>0?("function"==typeof(null===(T=E.logger)||void 0===T?void 0:T.error)&&E.logger.error(concat(I="uploadTrunk(".concat(O,") error. retry after 3 seconds. ")).call(I,(new Date).toTimeString())),hi((function(){e(t,a,c-1,_)}),3500)):S.status?(m.removeFileInfo(t.fileKey),E.onError(new g(concat(M=concat(A="uploadTrunk(".concat(O,") error: ")).call(A,S.status," ")).call(M,S.statusText)))):E.onError(new g("uploadTrunk(".concat(O,") error. no Error Code. Please check your network")))}},S.open("post",O+"?offset=".concat(a)+"&complete=".concat(N)+"&context=".concat(I)+"&version=".concat(E.version)),S.setRequestHeader("x-nos-token",h.token),h.md5&&S.setRequestHeader("content-md5",h.md5),t.file.type&&S.setRequestHeader("content-type",t.file.type),S.timeout=E.trunkUploadTimeout,"undefined"!=typeof FileReader){var A=new FileReader;A.addEventListener("load",(function(t){var a;(null===(a=null==t?void 0:t.target)||void 0===a?void 0:a.result)instanceof ArrayBuffer&&t.target.result.byteLength>0?S.send(t.target.result):E.onError(new g("Read ArrayBuffer failed",194003))})),A.addEventListener("error",(function(t){var a=t.target.error;E.onError(new g("Read ArrayBuffer error. ".concat(a.toString()),194003))})),A.readAsArrayBuffer(T.call(t.file,a,M))}else S.send(T.call(t.file,a,M))}};function v(t,a){for(var c=0;c<a.length;c++){var _=a[c];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),vi(t,_.key,_)}}var I=function(){function e(t,a,c){!function(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e),this.uploadState="paused",this.config=c,this.file=t,this.param=a,this.fileKey=m.initFile(a,t,this.config.enableCache),this.resume()}var t;return(t=[{key:"resume",value:function value(){var t=this;if("uploading"!==this.uploadState){this.setUploadState("uploading");var a=this.config;E(this,a.retryCount,(function(c){T(t,c,a.retryCount,(function(){t.setUploadState("ended"),"function"==typeof a.onComplete&&a.onComplete(t.param)}))}))}}},{key:"pause",value:function value(){this.setUploadState("paused")}},{key:"abort",value:function value(){"ended"!==this.uploadState&&"abort"!==this.uploadState&&(this.setUploadState("abort"),this.config.onError(new g("Upload Aborted",10499)))}},{key:"setUploadState",value:function value(t){t!==this.uploadState&&(this.uploadState=t)}},{key:"setContext",value:function value(t){m.setUploadContext(this.fileKey,t,this.config.enableCache),this.param.ctx=t}},{key:"setComplete",value:function value(){m.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&v(e.prototype,t),e}(),N={maxFileCache:1/0,expireTime:864e5,getFileUploadInformation:function getFileUploadInformation(t){var a=m.getFileKey(t),c=m.getFileInfo(a);return null===c?null:Zn()-c.modifyAt>N.expireTime?(m.removeFileInfo(a),null):{uploadInfo:Ct({bucketName:c.bucket,objectName:c.obj,token:c.token,ctx:c.ctx},c.payload?{payload:c.payload}:{}),complete:c.end}},setMaxFileCache:function setMaxFileCache(t){N.maxFileCache=t},setExpireTime:function setExpireTime(t){N.expireTime=t},printCaches:function printCaches(){if("undefined"!=typeof localStorage)for(var t=0,a=Ui(localStorage);t<a.length;t++){var c=a[t],_=m.getFileInfo(c);_&&console.log(_,"modifiedAt",new Date(_.modifyAt).toTimeString())}},createConfig:function createConfig(t){return new c(t)},createTask:function createTask(t,a,c){return new I(t,a,c)}},M=N;return a.default}()})),gm=createCommonjsModule((function(t,a){t.exports=function(){function object2String(t){if(t){var a,c="";return forEach$1(a=Ui(t)).call(a,(function(a,_){c+=0===_?"?":"&",c+=a+"="+t[a]})),c}return""}var t=function(t){function V2NIMError(a,c,_,h){var m;return(m=t.call(this,_)||this).source=a,m.code=c,m.desc=_,m.detail=h||{},m}return Mt(V2NIMError,t),V2NIMError}(ys(Error));function request(a,c){void 0===c&&(c={dataType:"json",method:"GET",timeout:5e3});var _="text"===c.dataType?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",h="GET"===c.method?object2String(c.params):"";return new Jn((function(m,g){if(window.XMLHttpRequest){var E,T=new XMLHttpRequest;if(T.onreadystatechange=function(){if(4===T.readyState)if(200===T.status){try{E=JSON.parse(T.response||"{}")}catch(t){E=T.response}m({status:T.status,data:E})}else hi((function(){g(new t(1,T.status,"readyState: "+T.readyState+"; statusText: "+T.statusText))}),0)},T.open(c.method,""+a+h),T.timeout=c.timeout||5e3,T.setRequestHeader("Content-Type",_),c.headers)for(var I in c.headers)T.setRequestHeader(I,c.headers[I]);T.ontimeout=function(a){g(new t(1,408,a&&a.message?a.message:"request timeout"))},T.send(ws(c.data))}else g(new t(2,10400,"request no suppout"))}))}return request}()})),Em=console;function uploadFile(t){return __awaiter(this,void 0,void 0,cd.mark((function _callee(){var a,c,_,h,m,g;return cd.wrap((function _callee$(E){for(;;)switch(E.prev=E.next){case 0:if(t.fileInput||t.file){E.next=2;break}throw new Error("File not exist");case 2:if(!t.file){E.next=6;break}h=t.file,E.next=20;break;case 6:if("string"!=typeof t.fileInput){E.next=15;break}if(!((m=document.getElementById(t.fileInput))&&m.files&&m.files[0])){E.next=12;break}h=m.files[0],E.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:E.next=20;break;case 15:if(!(t.fileInput&&t.fileInput.files&&t.fileInput.files[0])){E.next=19;break}h=t.fileInput.files[0],E.next=20;break;case 19:throw new Error("Can not get file from fileInput "+t.fileInput);case 20:if(!(t.maxSize&&h.size>t.maxSize)){E.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+t.maxSize+", get "+h.size);case 22:return E.next=24,new Jn((function(a,c){var _,m=mm.getFileUploadInformation(h),g=mm.createConfig({enableCache:!0,retryCount:0,directUploadAddr:t.chunkUploadHost,onError:function onError(t){c(t)},onUploadProgress:t.onUploadProgress||function(){},onComplete:function onComplete(t){a(t)}});if(m)if(m.complete)t.onUploadProgress&&t.onUploadProgress({total:h.size,loaded:h.size,percentage:1,percentageText:"100%"}),a(m.uploadInfo);else{_=mm.createTask(h,m.uploadInfo,g);try{t.onUploadStart&&t.onUploadStart(_)}catch(t){Em.error("Adapter uploadFile: options.onUploadStart error",t&&t.message),_.abort(),c(t)}}else{_=mm.createTask(h,Ct(Ct({bucketName:t.nosToken.bucket,objectName:decodeURIComponent(t.nosToken.objectName),token:t.nosToken.token},t.md5?{md5:t.md5}:{}),t.payload?{payload:t.payload}:{}),g);try{t.onUploadStart&&t.onUploadStart(_)}catch(t){Em.error("Adapter uploadFile: options.onUploadStart error",t&&t.message),_.abort(),c(t)}}}));case 24:return(g=E.sent).name=h.name,g.size=h.size,g.type=h.type,g.ext=lastIndexOf(a=g.name).call(a,".")>-1?slice$1(c=g.name).call(c,lastIndexOf(_=g.name).call(_,".")+1).toLowerCase():"",E.abrupt("return",g);case 30:case"end":return E.stop()}}),_callee)})))}function getFileUploadInformation(t){var a;if(t.file)a=t.file;else if("string"==typeof t.fileInput){var c=document.getElementById(t.fileInput);if(!(c&&c.files&&c.files[0]))throw new Error("Can not get file from fileInput");a=c.files[0]}else{if(!(t.fileInput&&t.fileInput.files&&t.fileInput.files[0]))throw new Error("Can not get file from fileInput "+t.fileInput);a=t.fileInput.files[0]}return mm.getFileUploadInformation(a)}function getSystemInfo(){var t,a,c=Zh.version||"";if(isElectron())try{var _=navigator.userAgent.match(/Electron\/([\d.]+\d+)/);_&&_[1]&&"string"==typeof _[1]&&(c=_[1])}catch(t){}return{os:(null===(t=Zh.os)||void 0===t?void 0:t.family)||"",osVer:(null===(a=Zh.os)||void 0===a?void 0:a.version)||"",browser:Zh.name||"",browserVer:Zh.version||"",libEnv:"BROWSER",hostEnv:isElectron()?"Electron":isMobile()?"H5":isBrowser()?"BROWSER":"Unset",hostEnvEnum:isElectron()?Lf.Electron:isMobile()?Lf.H5:isBrowser()?Lf.BROWSER:Lf.Unset,hostEnvVer:c,userAgent:navigator&&navigator.userAgent,model:c,manufactor:Zh.name||""}}var vm=null,ym=null;return function setAdapters(t){wf(jf,t())}((function getAdapter(){return{setLogger:function setLogger(t){Em=t},platform:"BROWSER",localStorage:window.localStorage,request:gm,WebSocket:window.WebSocket,uploadFile:uploadFile,getFileUploadInformation:getFileUploadInformation,getSystemInfo:getSystemInfo,net:{getNetworkStatus:function getNetworkStatus(){return Jn.resolve({net_type:Vf.kStatNetTypeUnkonw,net_connect:"undefined"==typeof navigator||"boolean"!=typeof navigator.onLine||navigator.onLine})},onNetworkStatusChange:function onNetworkStatusChange(t){vm=function onlineListener(){t({isConnected:!0,networkType:Vf.kStatNetTypeUnkonw})},ym=function offlineListener(){t({isConnected:!1,networkType:Vf.kStatNetTypeUnkonw})},window.addEventListener("online",vm),window.addEventListener("offline",ym)},offNetworkStatusChange:function offNetworkStatusChange(){vm&&window.removeEventListener("online",vm),ym&&window.removeEventListener("offline",ym),vm=null,ym=null}}}})),Xh}));
